<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en" ng-app="buildlogApp"> <!--<![endif]-->
<head>
    
    <title>Project logs &bull; DIY Electric Vehicle from Recycled Parts &bull; Hackaday.io</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" href="//cdn.hackaday.io/css/style.css?version=0.48.6" />
    <script type="text/javascript" src="//use.typekit.net/ymb0lgk.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
</head>
<body class="logs">

    <!--
############################################################################################
############################################################################################
############################################################################################
#####################Kt;tL#######################################Kti,E######################
#######################;   .###################################G    E#######################
#######################K    f##################################    ;########################
########################Wj   E###############################K:  .W#########################
##########################.  :E##############################:  .L##########################
#########################D    f##############################.   .##########################
########################,     ;##############################     :E#######K################
################f######K      ,##############################      ,######Lt################
################  W###W       i##############################       t####j t################
################:  E#L.        f###########################L.        f#Ki .E################
################j  ;E.          j##########################.         .G;  i#################
#################L               i#######################K                ##################
#################W                E#####################K;               ;##################
###################:               .###################D               :f###################
#####################DLfGD           G####WEEEEKW####W           ;GffGK#####################
##########################i         iD##Kfi    :jKW##D          iE##########################
###########################W      ,G##f            jE#E;       j############################
############################L     D##D              ,##K       W############################
#############################D:  G#W                  K#E,   G##############################
###############################;i#L                    j## ,E###############################
###############################KK#.                     ##iE################################
#################################j                      ;K##################################
################################W                        ,##################################
################################E                         ##################################
###############################Ki                         D#################################
###############################E.                         L#################################
###############################f    iD##W;       D###D    :#################################
###############################i   i######K     K#####K;   #################################
###############################;  .E#######     #######D   #################################
###############################;  L########     ########   #################################
###############################i  G#######K     K#######   #################################
###############################j  L#####E,       fE#####   #################################
###############################D  .E##j            .t##E  ;#################################
###############################E:  ;##.              #Wt  j#################################
################################G   ;t      tWi      t    E#################################
#############################KL##           K#K;          #K:K##############################
#############################i ##:          ###t         j#f ;K#############################
############################:  G#K          #E#L        L##    D############################
###########################D   ;W#:         #;#L        W#K    .############################
#####################KKEKK      :##L        ; ..      :D##.      fKEEK######################
###################t.            ;##G:               ,##E,             tD###################
##################G               E##E               i##;               :###################
#################D                W##W    iL    E.    ###D                ##################
################W,               G###W    tG    K.    ####:               K#################
################;  LW;         ,E#####:  ;W#    #G   f#####;         ;KG  :K################
################  D###E       ;########WW####WW####WW#######W       :####: j################
################ ,#####:      ;##############################       G####E i################
################K#######.     ;##############################      L######WG################
########################f     i##############################     j#########################
#########################W   .D##############################.   i##########################
#########################E   G###############################D   ,##########################
########################G:   #################################j   G#########################
#######################f    K##################################j    W#######################
#####################Kt :iE#####################################KL:  K######################
############################################################################################
############################################################################################
############################################################################################
-->

<div class="header" id="header">
    <div class="container">
        <h1 class="logo">
            <a href="/" title="Hackaday.io Home" class="home" onclick="CT(this, 'Menu', 'Home'); return false;"></a>
            <a href="/" title="Hackaday.io Home" class="brand" onclick="CT(this, 'Menu', 'Home'); return false;">Hack a Day</a>
        </h1>

        <a href="javascript:void(0);" class="responsive-menu">Menu</a>

        <ul class="nav" role="navigation">
            <li><a href="/projects" class="">Projects</a></li>
            <li><a href="/lists" class="">Lists</a></li>
            <li><a href="/stack" class="">Stack</a></li>
            <li class="dropdown more-nav j-more-open">
                <a href="javascript:void(0)" class="dropdown-link icon-dropdown">More</a>
                <ul role="menu" class="dropdown-menu more-menu" id="j-more">
                    <li><a href="http://hackaday.com/blog/" target="_blank">Blog</a></li>
                    <li><a href="/events">Events</a></li>
                    <li><a href="/hackerspaces">Hackerspaces</a></li>
                    <li><a href="/hackers">Profiles</a></li>
                    <li><a href="/contests">Contests</a></li>
                    <li><a href="/prize" target="_blank">The Hackaday Prize</a></li>
                    <li><a href="/submissions/prize2015/list">2015 Prize Entries</a></li>
                </ul>
            </li>
            <li class="menu-last-child">
                <div class="search-holder show">
                    <form id="search-form" action="/search" onsubmit="return submitSearch();" method="GET">
                        <input type="text" placeholder="Search" name="term" class="input-search j-add-search" id="j-add-search" value="" autocomplete="off" pattern=".{3,}" required title="3 characters minimum" />
                        <input type="submit" class="search-button" />
                    </form>
                </div>
            </li>
        </ul>

        

            <ul class="nav pull-right" role="navigation">
                <li><a href="/signup" class="grey-white-button become-member">Sign up</a></li>
                <li><a href="/signin?returnUrl=%2Fproject%2F4649%2Flogs">Sign in</a></li>
            </ul>

        
    </div>
</div>

<div id="topMessage" class="alert"><span class="j-top-content"></span><a href="javascript:void(0);" class="alert-close j-top-message-close">Close</a></div>




    <div class="headline">
        <div class="container">
            <h2><a href="/project/4649-diy-electric-vehicle-from-recycled-parts">DIY Electric Vehicle from Recycled Parts</a></h2>
            <p class="description-title"> Project logs</p>
            <p class="description-summary">Converting a car to electric drive using recycled and salvaged EV and hybrid components.</p>
            <div class="description-metainfo">
                
                    <span>created by <a href="/hacker/22542-mauswerkz" title="Visit Profile">mauswerkz</a><span>&bull;</span>
                
                5 months ago<span>&bull;</span><a href="/project/4649#discussion-list" title="See Comments">6 Comments</a></span>
            </div>
        </div>
    </div>

    <div class="container post-content">
        <div class="section-buildsort">
            <span class="pull-left">
                <a href="/project/4649-diy-electric-vehicle-from-recycled-parts">&#171; Back to project details</a>
            </span>
            <span class="sort-holder pull-right">
                <label for="sort-by">Sort by:</label>
                <select class="sort" id="sort-by">
                    <option value="/project/4649/logs/sort/newest">Newest</option>
                    <option value="/project/4649/logs/sort/oldest" selected="selected">Oldest</option>
                </select>
            </span>
        </div>
        <div class="section section-buildlogs last">
            

                <ul class="buillogs-list">
                    
                        <li>
                            <h2><a href="/project/4649/log/14980-examining-the-lexus-inverter">Examining the Lexus inverter</a></h2>
                            <small class="authorship">5 months ago  &bull;
                                <a class="gray-link" href="/project/4649/log/14980#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-14980"><p>Tore in to the Lexus inverter. It has two main sections. There's the inverter section, which has the power electronics for driving the motors (and a really big capacitor encased in aluminum). There's also a "converter" section, which is what boosts the voltage from the original battery (288v) to the high voltage needed to drive the motors (650v). This converter can also step the voltage generated by the motors during braking down to the correct voltage to charge the battery.</p><p> For my project, I'll have to figure out how to control the power electronics using my own hardware. This will involve determining the pinouts of all the connectors, where the sensors connect and how to read them, and generally how it all goes together.</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4649/log/18427-why-the-lack-of-updates">Why the lack of updates?</a></h2>
                            <small class="authorship">3 months ago  &bull;
                                <a class="gray-link" href="/project/4649/log/18427#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-18427"><p>This project is certainly still progressing! The reason there haven't been updates lately is because the work I've been doing is mostly on the computer for the moment, finalizing the schematics and laying out the PCB for the new inverter control board. Not much to show from that process, but there will be more updates soon. I'm actually taking this whole next week off from work to get the PCB layout finished and sent off to be made. It's a long process that I just won't get done in time if I can only work on it on weekends, so I'll power through it over the next 7 days so I can get back to the good stuff.</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4649/log/18465-200v-test-run-of-inverter-and-transmission">200v test run of inverter and transmission</a></h2>
                            <small class="authorship">3 months ago  &bull;
                                <a class="gray-link" href="/project/4649/log/18465#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-18465"><iframe style="width: 500px; height: 281px;" src="//www.youtube.com/embed/vy9LjIfhQY8" allowfullscreen="" frameborder="0" height="281" width="500"></iframe><p>Okay, something more exciting to show. I got the charger out of a Chevy Volt working so I quickly hooked it up to my inverter as a power supply to try it out. I set it to its lowest setting (200v). The inverter is still running on the breadboard and Arduino with no current sensing but it does have motor position sensing. If you saw my video from back on the 2nd of this running on 12v, 200v will look a bit more impressive. Again, the final voltage will be 650v.</p><p><br>The LEDs that light up are connected to the oil pressure sensors in the transmission. The input shaft isn't locked yet so it spins with the motor and turns the internal pump. Once the input shaft is locked, I'll have to use the electric oil pump. Interesting fact, the transmission defaults to the high speed gear unless I drive the solenoids to get it do downshift to the low speed gear. This is so that if a solenoid or pump fails at high speed, the transmission won't downshift and overspeed the motor.</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4649/log/18621-inverter-control-board-pcb-layout">Inverter control board PCB layout</a></h2>
                            <small class="authorship">3 months ago  &bull;
                                <a class="gray-link" href="/project/4649/log/18621#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-18621"><p>Got the PCB layout for my project done yesterday. Before and after images attached. The blue pour is a heatsink for the two high current op amps (one for each motor) I'm using as part of my resolver excitation.</p><p>Before:<br></p><p><img src="https://cdn.hackaday.io/images/9417441432832528590.jpg"></p><p>After:</p><p><img src="https://cdn.hackaday.io/images/4101711432832569000.JPG"><span></span><br></p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4649/log/18725-pcb-sent-off-for-fab">PCB sent off for fab!</a></h2>
                            <small class="authorship">3 months ago  &bull;
                                <a class="gray-link" href="/project/4649/log/18725#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-18725"><p>Put the finishing touches on the layout and silk screen for my inverter control board. This board is the first I've designed using Altium. There were a few things I noticed while laying it out where the behavior of the net-naming didn't work as I expected (a power net that didn't propogate across sheets even though every other power net did, very confusing). Hopefully I didn't miss anything and there are no nasty surprises when it arrives. If all goes well, this should let me get to the real meat of the project: programming. Any other hardware I have to design for it after this should just be simple CAN interfaces and maybe a few light-duty drivers for relays or contactors.</p><p>The board is being made by Seeed and should hopefully arrive by the end of next week. Hackaday is giving away "stickvices" this week, which if I won one, would be perfect timing for board assembly. There are more than a handful of 0603 resistors to be placed, along with a few to be put on the other side. Something to hold the board off the bench while I hot-air solder (so the parts on the other side don't get disturbed) would be handy. I've been eyeing the panavises lately, especially at maker faire, but just can't justify spending the minimum of $100 on one, not to mention the suction cup wouldn't work on my bench.</p><p>Anyway, here's a picture of the final board layout with the layers in the correct order and silk screen visible:</p><p><img src="https://cdn.hackaday.io/images/6590781433036253022.JPG"></p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4649/log/19314-pcb-arrived-and-a-fancy-new-tool">PCB Arrived, and a fancy new tool</a></h2>
                            <small class="authorship">2 months ago  &bull;
                                <a class="gray-link" href="/project/4649/log/19314#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-19314"><p>Two things arrived today: the PCB, and the Stickvise I won in the HaD giveaway. Here they are together.</p><p><img src="https://cdn.hackaday.io/images/7774321433988227400.jpg"></p><p>Looks like it's going to be handy! Hopefully the plastic holders can withstand the heat of hot-air soldering going on in their vicinity. I don't have a 3D printer to replace them, but if I need to, I'll probably cut some from HDPE as an upgrade.</p><p>I also have all the components to go on the board. I'll start with the power supply (lower right) and make sure that's happy before putting the rest of my parts on. If all goes well, I get to spend the next several weeks getting the firmware to the point where I can spin the motors. For tuning, I'll use the motors against each other as a dyno built in to the transmission. This is really the only way to properly tune IPM parameters. Thankfully, the dyno is free!</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4649/log/19367-component-choices-and-learning-a-new-toolchain">Component choices and learning a new toolchain</a></h2>
                            <small class="authorship">2 months ago  &bull;
                                <a class="gray-link" href="/project/4649/log/19367#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-19367"><p><img src="https://cdn.hackaday.io/images/1875001434081234635.jpg"></p>I got started with microcontrollers, like many, with Arduino. This set me on the path to use Atmel parts in my personal projects. First I started embedding Arduino-compatible AVR devices in projects, using the Arduino IDE to code for them, and an AVR-ISP clone to program them. Once I started doing more complex projects, I looked at other Atmel devices beyond those supported by the Arduino IDE. I moved to Atmel Studio and played with the xmega series of devices. Still 8-bit, but with more "grown up" peripherals and a higher clock speed. It was an xmega device that ran my first 3-phase inverter.<p>With this new project I wanted to take another step up. I looked at Atmel's ARM offerings but couldn't find the right combination of peripherals, performance, and motor-control libraries so I decided to branch out. In my searches, I came across the Freescale V-series ARM devices. These are aimed towards motor control and power conversion, have the right collection of peripherals, and a motor control library is offered for use on them which will greatly simplify the coding portion of the project. These seem to be a good fit.</p><p>My inverter control board has three microcontrollers and two resolver-to-digital (R2D) converters. There is one microcontroller and R2D pair per motor and a main "supervisory" microcontroller.</p><p>My specific choices of device are:</p><p>2x Freescale MKV10Z32VLF7 32-bit ARM Cortex M0+ <a href="https://twitter.com/72MHz" target="_blank">@72MHz</a> (<a href="https://www.freescale.com/webapp/sps/site/prod_summary.jsp?code=KV1x">Freescale product page</a>)</p><p>1x Teensy 3.1 (Freescale MK20DX256VLH7) 32-bit ARM Cortex M4 @ 72MHz (<a href="https://www.pjrc.com/teensy/teensy31.html">Teensy product page</a>)</p><p>The MKV10's will do the PWM generation, read the R2D's and phase currents, and perform the vector control calculations for the motors. The current controller setpoints will be fed to these via SPI from the Teensy. The speed control loops, transmission control, CAN link, and supervisory functions will be performed in the Teensy. It'll have more on its plate, but the calculations it needs to do aren't as numerically intense, so it should be a good balance.</p><p>I'm getting used to the Freescale toolchain (Kinetis Design Studio). It's a different environment than I'm familiar with (Eclipse for KDS vs Visual Studio for AS), but there are some very handy tools included. I'm using a Freedom KL25Z dev board as my programmer until I can pick up a proper one.</p><p>Meanwhile, I've made some progress assembling my board. Ordered a few of the wrong parts, which has delayed me a bit, but I got the power supply components installed and working. I've populated the bottom side of the board (the stick vise sure came in handy for that!) and will do the top side this weekend. If only I could get some 22k ohm SMD resistor arrays locally! Hardly worth placing a digikey order just for those.</p><p>Anyway, keep an eye out for more updates over the next few days.<br></p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4649/log/19454-board-populated">Board Populated!</a></h2>
                            <small class="authorship">2 months ago  &bull;
                                <a class="gray-link" href="/project/4649/log/19454#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-19454"><p><img src="https://cdn.hackaday.io/images/4806221434242525565.jpg"></p><p>Finished
 populating the new board today. It's sitting on my bench right now with
 a blinking LED, so that's a good sign! Still got a lot of testing and 
verification to do, but it's looking good so far. I need to do some 
programming to really test out the board, so that's where I'm at now.</p><p>
 Pictured below is the new board next to the original Toyota/Lexus board</p><p>Picture above is the new board installed in the inverter. Everything plugs in 
just like it's supposed to!</p><p><img src="https://cdn.hackaday.io/images/8545921434242467287.jpg"></p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4649/log/20090-new-control-board-it-works">New Control Board: It Works!</a></h2>
                            <small class="authorship">2 months ago  &bull;
                                <a class="gray-link" href="/project/4649/log/20090#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-20090"><p>First spins on the new control board happened today. Getting the code tuned in. The motors are making some very fun sounds!</p><p><br>The slow ramp-rate of the motor here is due to the current limited of the charger I'm using as a power supply. I've got it set to 1A @200v for safety. I certainly have to be careful with regen here. I managed to get the bus up over 700v a few times while actively spinning it down to a stop. That'll be fine when there are batteries powering it, but not so good with the charger that's only rated to 430v.</p><p><br>Here's a quick teaser video of it spinning on up one of the motors. Have to hook up the electric oil pump to keep things lubricated and close the clutches, then I can spin MG2 up and have it play along (or against) MG1.</p><iframe style="width: 500px; height: 281px;" src="//www.youtube.com/embed/6u0p3_CcdTs" allowfullscreen="" frameborder="0" height="281" width="500"></iframe><p><br>After that, it's just a matter of software tweaking and tuning. Will have to generate a look-up table for each motor at various operating points. Handy that the transmission will work as a dyno by driving the motors against each other.</p><p><br>I've ordered a radiator and some hose so I can get cooling set up, then I'm good to go. That should be ready by next weekend. Good thing too, since it's a long one.</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4649/log/20373-locking-the-input-shaft-part-1">Locking the input shaft (Part 1)</a></h2>
                            <small class="authorship">2 months ago  &bull;
                                <a class="gray-link" href="/project/4649/log/20373#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-20373"><p>Had a friend help me fabricate the piece that I'll use to lock the input shaft of the transmission.</p><p><img src="https://cdn.hackaday.io/images/8964151435893991481.jpg">The splines are from the center piece of a clutch for an old Toyota Celica. It's a 21-tooth 28mm diameter spline. A google search of the spline dimensions brought up the clutch alignment tool for a 70's Celica. You could probably go backward from the clutch alignment tool to find other cars with the same spline. Apparently Toyota used the same size splines on several other vehicles including the Rav4. I find itquite amusing that the clutch from an old Toyota fits perfectly on the input shaft of a 2007 Lexus Hybrid.</p><p>The clutch hub was welded to a piece of 3" exhaust pipe which was then welded to a circular plate. I'll drill holes in the plate this weekend and bolt it to a sheet of 6mm aluminum which will also bolt to the bellhousing to lock the shaft from spinning.</p><p>All up, it cost me about $30 plus dinner for my friend for the welding and some scrap steel he had laying around.</p></div>
                            </div>
                        </li>
                    
                </ul>

                
                <div class="pagination">
                    
                    
                    <a href="?page=2" class="grey-gold-button next-button show">Next</a>
                    
                </div>
                

                

                </p>

            
        </div>
    </div>

    










<div class="footer" id="footer">
  <a href="#header" class="back-to-top" onClick="CT(this, 'Footer', 'GoingUp');">^ Going up? ^</a>
    <div class="container">
        <p><a href="http://hackaday.com/about/">About Us</a> <a href="mailto:projects-contact@hackaday.com">Contact Us</a> <a href="/project/37">Give Feedback</a>&copy; 2015 Hackaday <a href="/tos">Terms of Use</a> <a href="/privacy-policy">Privacy Policy</a></p>
        <a href="/" class="had-skull"  onClick="CT(this, 'Footer', 'Home' ); return false;">Hackaday.io</a>
    </div>
</div>

<script>

    var csrftoken = 'l8Xne5jv-5aRlKmSr5reoDmQoimS3u0ARDAo';

</script>

    <script type="text/javascript">

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47229708-1', 'auto');

    var dimensionValue = 'nonregistered';
    ga('set', 'dimension1', dimensionValue);
    ga('require', 'displayfeatures');

    ga('send', 'pageview');

    </script>

<img src="//analytics.supplyframe.com/trackingservlet/impression?action=pageImpression&amp;zone=HIO_logs&amp;extra=logged%3Dfalse%7ChaveAccountCookie%3D0%7C&amp;ab=undefined" class="sf-impression" />

    
    
    <script src="//cdn.hackaday.io/build/h%2FydgsYIeDTf7pqgYQEKK8Ngblw0IkZCDqfJ9S2tk7zsBoxIHt5iOd49Qp%2BF4vdxEuRj%2BGpGDLbX4aGOQGmbjaOxUZvklg4ReFk68R95OQshFrGKebvogKGQOiB5Hi1xym9KC54c9Ps0WpzuNydLk4B%2FbKi91KhV40Uxhl38XXb1IVAxAI8iW%2BoQUPCFkHVWZxD0B%2BMZ%2BuEXJTlWuBmopNMxTHRK5yleITPZODT6evbVRQc6AXs9w2Pfk7FS2nKy-0.48.6.js"></script>

</body>
</html>