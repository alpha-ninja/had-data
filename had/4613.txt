<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <title>ARDUINO MPPT SOLAR CHARGE CONTROLLER &bull; Hackaday.io</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

    


        <meta name="description" content="An Arduino based Solar MPPT charge controller.">
        <link rel="canonical" href="http://hackaday.io/project/4613-arduino-mppt-solar-charge-controller" />



    <link rel="stylesheet" href="//cdn.hackaday.io/css/style.css?version=0.48.6" />
        <script type="text/javascript">
        function getCommentIdFromUrl() {
            if(window.location.hash) {
                var hash = window.location.hash.substring(1);
                var commentId = parseInt(hash.replace('j-discussion-', ''));
                if (commentId) {
                    return commentId;
                }
            }
            return null;
        }

        var commentId = getCommentIdFromUrl();
        if (commentId) {
            var url = window.location.href;
            if (url.indexOf('?') > -1) {
                url = url.substring(0, url.indexOf('?'));
            }
            if (url.indexOf('#') > -1) {
                url = url.substring(0, url.indexOf('#'));
            }
            url += '/discussion-' + commentId;
            window.location.href = url;
        }
    </script>
    <script type="text/javascript" src="//use.typekit.net/ymb0lgk.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@hackadayio">
    <meta name="twitter:title" content="ARDUINO MPPT SOLAR CHARGE CONTROLLER">
    
        <meta name="twitter:description" content="In India most of the people are living in rural areas,400 million people that are currently have no access to electricity.Despite India being the world&#39;s 5th largest energy producer,the existing electric grids are not capable of supplying the electricity need to those poor people.
So the need for clean, affordable alternatives is obvious.Solar power have the advantage of being less maintenance and pollution free.
To provide basic need of electricity and improve the socio-economic positions of rural people, I started this project from basic lighting system and a simple PWM solar charge Controller in March-2014.The feedback was incredible on Instructables. After working over one year to improve the controller, I have landed up in this stage.This project is on  MPPT solar charge controller which can charge a commonly used 12V lead acid battery from a solar panel.This is more sophisticated,30 to 40 % more efficient and have several advantages over the other charge controllers.

">
    
    
        <meta name="twitter:image" content="https://cdn.hackaday.io/images/resize/600x600/5000001426012683808.jpg">
    

    <!-- Open Graph data -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="ARDUINO MPPT SOLAR CHARGE CONTROLLER">
    <meta property="og:url" content="http://hackaday.io/project/4613-arduino-mppt-solar-charge-controller">
    
        <meta property="og:description" content="In India most of the people are living in rural areas,400 million people that are currently have no access to electricity.Despite India being the world&#39;s 5th largest energy producer,the existing electric grids are not capable of supplying the electricity need to those poor people.
So the need for clean, affordable alternatives is obvious.Solar power have the advantage of being less maintenance and pollution free.
To provide basic need of electricity and improve the socio-economic positions of rural people, I started this project from basic lighting system and a simple PWM solar charge Controller in March-2014.The feedback was incredible on Instructables. After working over one year to improve the controller, I have landed up in this stage.This project is on  MPPT solar charge controller which can charge a commonly used 12V lead acid battery from a solar panel.This is more sophisticated,30 to 40 % more efficient and have several advantages over the other charge controllers.

">
    
    
        <meta property="og:image" content="https://cdn.hackaday.io/images/resize/600x600/5000001426012683808.jpg">
    

    <script>
        var HIO = {};
    </script>

</head>
<body class="project-detail ">

    <!--
############################################################################################
############################################################################################
############################################################################################
#####################Kt;tL#######################################Kti,E######################
#######################;   .###################################G    E#######################
#######################K    f##################################    ;########################
########################Wj   E###############################K:  .W#########################
##########################.  :E##############################:  .L##########################
#########################D    f##############################.   .##########################
########################,     ;##############################     :E#######K################
################f######K      ,##############################      ,######Lt################
################  W###W       i##############################       t####j t################
################:  E#L.        f###########################L.        f#Ki .E################
################j  ;E.          j##########################.         .G;  i#################
#################L               i#######################K                ##################
#################W                E#####################K;               ;##################
###################:               .###################D               :f###################
#####################DLfGD           G####WEEEEKW####W           ;GffGK#####################
##########################i         iD##Kfi    :jKW##D          iE##########################
###########################W      ,G##f            jE#E;       j############################
############################L     D##D              ,##K       W############################
#############################D:  G#W                  K#E,   G##############################
###############################;i#L                    j## ,E###############################
###############################KK#.                     ##iE################################
#################################j                      ;K##################################
################################W                        ,##################################
################################E                         ##################################
###############################Ki                         D#################################
###############################E.                         L#################################
###############################f    iD##W;       D###D    :#################################
###############################i   i######K     K#####K;   #################################
###############################;  .E#######     #######D   #################################
###############################;  L########     ########   #################################
###############################i  G#######K     K#######   #################################
###############################j  L#####E,       fE#####   #################################
###############################D  .E##j            .t##E  ;#################################
###############################E:  ;##.              #Wt  j#################################
################################G   ;t      tWi      t    E#################################
#############################KL##           K#K;          #K:K##############################
#############################i ##:          ###t         j#f ;K#############################
############################:  G#K          #E#L        L##    D############################
###########################D   ;W#:         #;#L        W#K    .############################
#####################KKEKK      :##L        ; ..      :D##.      fKEEK######################
###################t.            ;##G:               ,##E,             tD###################
##################G               E##E               i##;               :###################
#################D                W##W    iL    E.    ###D                ##################
################W,               G###W    tG    K.    ####:               K#################
################;  LW;         ,E#####:  ;W#    #G   f#####;         ;KG  :K################
################  D###E       ;########WW####WW####WW#######W       :####: j################
################ ,#####:      ;##############################       G####E i################
################K#######.     ;##############################      L######WG################
########################f     i##############################     j#########################
#########################W   .D##############################.   i##########################
#########################E   G###############################D   ,##########################
########################G:   #################################j   G#########################
#######################f    K##################################j    W#######################
#####################Kt :iE#####################################KL:  K######################
############################################################################################
############################################################################################
############################################################################################
-->

<div class="header" id="header">
    <div class="container">
        <h1 class="logo">
            <a href="/" title="Hackaday.io Home" class="home" onclick="CT(this, 'Menu', 'Home'); return false;"></a>
            <a href="/" title="Hackaday.io Home" class="brand" onclick="CT(this, 'Menu', 'Home'); return false;">Hack a Day</a>
        </h1>

        <a href="javascript:void(0);" class="responsive-menu">Menu</a>

        <ul class="nav" role="navigation">
            <li><a href="/projects" class="">Projects</a></li>
            <li><a href="/lists" class="">Lists</a></li>
            <li><a href="/stack" class="">Stack</a></li>
            <li class="dropdown more-nav j-more-open">
                <a href="javascript:void(0)" class="dropdown-link icon-dropdown">More</a>
                <ul role="menu" class="dropdown-menu more-menu" id="j-more">
                    <li><a href="http://hackaday.com/blog/" target="_blank">Blog</a></li>
                    <li><a href="/events">Events</a></li>
                    <li><a href="/hackerspaces">Hackerspaces</a></li>
                    <li><a href="/hackers">Profiles</a></li>
                    <li><a href="/contests">Contests</a></li>
                    <li><a href="/prize" target="_blank">The Hackaday Prize</a></li>
                    <li><a href="/submissions/prize2015/list">2015 Prize Entries</a></li>
                </ul>
            </li>
            <li class="menu-last-child">
                <div class="search-holder show">
                    <form id="search-form" action="/search" onsubmit="return submitSearch();" method="GET">
                        <input type="text" placeholder="Search" name="term" class="input-search j-add-search" id="j-add-search" value="" autocomplete="off" pattern=".{3,}" required title="3 characters minimum" />
                        <input type="submit" class="search-button" />
                    </form>
                </div>
            </li>
        </ul>

        

            <ul class="nav pull-right" role="navigation">
                <li><a href="/signup" class="grey-white-button become-member">Sign up</a></li>
                <li><a href="/signin?returnUrl=%2Fproject%2F4613-arduino-mppt-solar-charge-controller">Sign in</a></li>
            </ul>

        
    </div>
</div>

<div id="topMessage" class="alert"><span class="j-top-content"></span><a href="javascript:void(0);" class="alert-close j-top-message-close">Close</a></div>




    

    
        <div class="page-basic-info-static guest-message-signup">
            
                <h2>Does this project spark your interest?</h2>
                <p class="page-basic-info-text">Become a member to follow this project and don't miss any updates</p>

            

            <div class="signup-holder">
                <form method="POST" action="/signup">
                    <input type="hidden" name="_csrf" value="8f9QZ9KD-qQgg2YhrZ1DgA4tdiJ0p60xw0o4" />
                    <input type="text" class="input-field input-email" placeholder="Your email address"  name="email"  /><input type="password" class="input-field input-password" placeholder="Password"  name="password" /><button class="black-gold-button signup" type="submit">Become a member</button>
                    <input class="input-field" placeholder="Invitation Code" required name="invitation_code" value="5Ad0ix2-b96J" type="hidden" />
                </form>
            </div>

        </div>
    


    

    <div class="header-photo" >
        <div class="overlay"></div>
    </div>

    <div class="headline">
        <div class="container">
            

            <h2><a href="/project/4613-arduino-mppt-solar-charge-controller">ARDUINO MPPT SOLAR CHARGE CONTROLLER</a></h2>
            <p class="description">An Arduino based Solar MPPT charge controller.</p>

            

            
                <div class="author">
                    <a href="/hacker/55735">
                        <img src="https://cdn.hackaday.io/images/resize/100x100/6184171426011439165.jpg" />
                        
                            <div class="author-details">
                                <div class="author-name">Debasish Dutta</div>
                            </div>
                        
                    </a>
                </div>
            
        </div>
    </div>

    <div class="container">
        <div class="content-left">

            
                <ul class="submissions-icons">
                    
                        
                        
                    
                        
                            <li>
                                <a href="/submissions/prize2015/list" class="submission-icon submission-icon-5">
                                    The 2015 Hackaday Prize
                                </a>
                            </li>
                        
                        
                            <script>
                                HIO.forPrize = true;
                            </script>
                        
                    
                        
                        
                    
                </ul>
            

            
                <a href="/project/4613/gallery#faa955230d20dec7db0a423f05d56cb2" id="project-image" class="image-holder" style="background-image: url(https://cdn.hackaday.io/images/resize/600x600/5000001426012683808.jpg)" data-image="https://cdn.hackaday.io/images/resize/600x600/5000001426012683808.jpg">
                </a>
            

            <div class="thumbs-holder">
                
                        <a href="/project/4613/gallery#faa955230d20dec7db0a423f05d56cb2" class="image-holder thumb" style="background-image: url(https://cdn.hackaday.io/images/resize/600x600/5000001426012683808.jpg)" data-image="https://cdn.hackaday.io/images/resize/600x600/5000001426012683808.jpg">
                    </a>
                
                        <a href="/project/4613/gallery#78af41fb5fd21f4043f9779a12f7b23d" class="image-holder thumb" style="background-image: url(https://cdn.hackaday.io/images/resize/600x600/413371426012881099.jpg)" data-image="https://cdn.hackaday.io/images/resize/600x600/413371426012881099.jpg">
                    </a>
                
                        <a href="/project/4613/gallery#4cf54952dba7fa37aa7b1e082b175b0c" class="image-holder thumb thumb-last" style="background-image: url(https://cdn.hackaday.io/images/resize/600x600/8933301439483972132.jpg)" data-image="https://cdn.hackaday.io/images/resize/600x600/8933301439483972132.jpg">
                    </a>
                
                        <a href="/project/4613/gallery#e57a0e3b187d839bb4891c0cffe67139" class="image-holder thumb" style="background-image: url(https://cdn.hackaday.io/images/resize/600x600/6621471426148556431.jpg)" data-image="https://cdn.hackaday.io/images/resize/600x600/6621471426148556431.jpg">
                    </a>
                
                        <a href="/project/4613/gallery#8d31d3446101b03f5f8aa43d719de707" class="image-holder thumb" style="background-image: url(https://cdn.hackaday.io/images/resize/600x600/8422871426012741742.jpg)" data-image="https://cdn.hackaday.io/images/resize/600x600/8422871426012741742.jpg">
                    </a>
                
                        <a href="/project/4613/gallery#c68c34ddc3c30811ae9ec1f1df1a5537" class="image-holder thumb thumb-last" style="background-image: url(https://cdn.hackaday.io/images/resize/600x600/8356651426012758333.jpg)" data-image="https://cdn.hackaday.io/images/resize/600x600/8356651426012758333.jpg">
                    </a>
                
            </div>

            
                <div class="view-gallery-holder">
                    <a href="/project/4613/gallery">
                        <div class="view-gallery grey-gold-button very-small-button">View Gallery</div>
                    </a>
                </div>
            

            

            

            

            

                <div class="project-following-container ">
                    <a href="javascript:void(0)" data-href="/project/4613/event/unfollow" class="gold-gold-button unfollow text-changing-button" data-before="<span class='icon-checkmark-gray'>Following</span>" data-after="Unfollow?"><span class="icon-checkmark-gray">Following</span></a>
                    <a href="javascript:void(0)" data-href="/project/4613/event/follow" class="gold-gold-button follow">Follow project</a>
                </div>
                
                

                <div id="similars">
                    <div class="similars-header">
                        Similar projects worth following
                        <a href="javascript:void(0)" class="submissions-close"></a>
                    </div>
                </div>

                
                    <div class="project-skulling-container ">
                        <a href="javascript:void(0)" data-href="/project/4613/event/unskull" class="gold-gold-button unskulled text-changing-button" data-before="<span class='icon-skull'>You</span>" data-after="Unskull?"><span class="icon-skull">You</span></a>
                        <a href="javascript:void(0)" data-href="/project/4613/event/skull" class="gold-gold-button skulled"><span class="icon-skull">Give a</span></a>
                    </div>
                

            

            
            

            <div class="section section-project-stats">
                
                    <span class="icon-view-count" title="View Count">23.5k</span>
                
                <a>
                    <span class="icon-comment-with-hover oi-font-color-grey" title="Comments" id="comment_count">73</span>
                </a>
                
                    <a href="/hackers/all/project/4613/following">
                
                    <span class="icon-view oi-font-color-grey" title="Followers" id="follower_count">245</span>
                
                    </a>
                

                
                    
                        <a href="/hackers/all/project/4613/likers">
                    
                            <span class="icon-skull oi-font-color-grey" title="Skulls" id="like_count">106</span>
                    
                        </a>
                    
                
            </div>

            
                <div class="section section-team">
                    <h5>
                        
                            Team
                        
                    </h5>

                    <ul>
                        
                            
                                <li>
                                    <img src="https://cdn.hackaday.io/images/resize/100x100/6184171426011439165.jpg" class="team-photo"/>
                                    <a class="team-link" href="/hacker/55735-debasish-dutta">Debasish Dutta</a>

                                    

                                    
                                </li>
                            
                        
                            
                                <li>
                                    <img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" class="team-photo"/>
                                    <a class="team-link" href="/hacker/70480-keithhungerford">keith.hungerford</a>

                                    

                                    
                                </li>
                            
                        
                            
                                <li>
                                    <img src="https://cdn.hackaday.io/images/resize/100x100/9221591432728713902.JPG" class="team-photo"/>
                                    <a class="team-link" href="/hacker/70774-petar">Petar</a>

                                    

                                    
                                </li>
                            
                        
                            
                                <li>
                                    <img src="https://pbs.twimg.com/profile_images/1202642260/161662_1295221681_6112041_q.jpg" class="team-photo"/>
                                    <a class="team-link" href="/hacker/73763-chinmayananda-das">Chinmayananda Das</a>

                                    

                                    
                                </li>
                            
                        
                            
                                <li>
                                    <img src="//gravatar.com/avatar/3504e95747047bad2ee874828a566214?d=https://hackaday.io/img/default-avatar.png&amp;r=x&amp;s=100" class="team-photo"/>
                                    <a class="team-link" href="/hacker/74191-aplavins">aplavins</a>

                                    

                                    
                                </li>
                            
                        
                    </ul>

                    <div class="error-message hide" id="team-error"><p></p></div>

                    
                    <input type="hidden" name="HADPrizeSubmission" value="true"/>
                        
                            <a href="javascript:void(0)"
                               
                                    class="login-button"
                               
                            >Request to join this project</a>
                        
                    

                </div>
            

            

            
                <div class="section section-links">
                    <ul class="links-list">
                        
                            <li class="links-item">
                                <a href="http://www.instructables.com/id/ARDUINO-SOLAR-CHARGE-CONTROLLER-Version-30/" target="_blank" class="icon-other">Instructables</a>
                            </li>
                        
                            <li class="links-item">
                                <a href="https://youtu.be/PQDqZSj1Tto" target="_blank" class="icon-other">About the V-3 Charge Controller  Video</a>
                            </li>
                        
                            <li class="links-item">
                                <a href="https://youtu.be/sPfJ9f1FuUE" target="_blank" class="icon-other">How to send Sensors data to web via ESP8266</a>
                            </li>
                        
                            <li class="links-item">
                                <a href="https://github.com/deba168/MPPT_Master" target="_blank" class="icon-github">Source Code/Schematics</a>
                            </li>
                        
                            <li class="links-item">
                                <a href="http://www.instructables.com/files/orig/F4F/K8NZ/IARFDFNO/F4FK8NZIARFDFNO.rar" target="_blank" class="icon-other">Arduino-MPPT-v4 ongoing works</a>
                            </li>
                        
                            <li class="links-item">
                                <a href="http://www.instructables.com/id/ARDUINO-SOLAR-CHARGE-CONTROLLER-PWM/" target="_blank" class="icon-other">V-1 Charge Controller</a>
                            </li>
                        
                            <li class="links-item">
                                <a href="http://www.instructables.com/id/ARDUINO-SOLAR-CHARGE-CONTROLLER-Version-20/" target="_blank" class="icon-other">V-2 Charge Controller</a>
                            </li>
                        
                            <li class="links-item">
                                <a href="https://youtu.be/3DRHFD98NdE" target="_blank" class="icon-other">Quarter Final Video</a>
                            </li>
                        
                    </ul>
                </div>
            


            
                
                    <div class="section section-tags">
                        
                            <div class="special-tags">
                                <a href="/projects/tag/ongoing%20project" class="tag tag-ongoing">ongoing project</a>
                            </div>
                        
                            <div class="special-tags">
                                <a href="/projects/tag/hardware" class="tag tag-hardware">hardware</a>
                            </div>
                        
                        
                            <a href="/projects/tag/arduino" class="tag">arduino</a>
                        
                            <a href="/projects/tag/energy" class="tag">energy</a>
                        
                            <a href="/projects/tag/LCD" class="tag">LCD</a>
                        
                            <a href="/projects/tag/hackadayprize" class="tag">hackadayprize</a>
                        
                            <a href="/projects/tag/MPPT" class="tag">MPPT</a>
                        
                            <a href="/projects/tag/2015HackadayPrize" class="tag">2015HackadayPrize</a>
                        
                            <a href="/projects/tag/Solar%20PV" class="tag">Solar PV</a>
                        
                            <a href="/projects/tag/CHARGE%20CONTROLLER" class="tag">CHARGE CONTROLLER</a>
                        
                            <a href="/projects/tag/WIFI%20-%20ESP8266" class="tag">WIFI - ESP8266</a>
                        
                            <a href="/projects/tag/BUCK%20CONVERTER" class="tag">BUCK CONVERTER</a>
                        
                            <a href="/projects/tag/Remote%20Data%20logging" class="tag">Remote Data logging</a>
                        
                    </div>
                
            

            <div class="section section-share">
                <h5>
                    
                        Enjoy this project?
                    
                </h5>
                
                <a href="https://twitter.com/intent/tweet?url=http://hackaday.io/project/4613-arduino-mppt-solar-charge-controller&text=ARDUINO%20MPPT%20SOLAR%20CHARGE%20CONTROLLER by debasish-dutta&related=hackadayio&via=hackadayio" target="_blank" class="icon-twitter icon-twitter-notext gray-link">Share on twitter</a> &nbsp; <a href="https://www.facebook.com/sharer/sharer.php?u=http://hackaday.io/project/4613-arduino-mppt-solar-charge-controller" target="_blank" class="icon-facebook icon-facebook-notext gray-link">Share on Facebook</a> &nbsp; <a href="https://plus.google.com/share?url=http://hackaday.io/project/4613-arduino-mppt-solar-charge-controller&h1=en-US" target="_blank" class="icon-google icon-google-notext gray-link">Share on Google+</a>
            </div>

            
            
                <div class="section section-lists">
                    <h5>This project is in these lists</h5>
                    
                        <div class="section-lists list-items">
    <a href="/list/4580-atmelarduino-projects">
        <div title="Atmel®Arduino Projects" class="list-item-cover"
                
                    style="background-image: url('https://cdn.hackaday.io/images/resize/600x600/8801601429554486919.jpg')"
                
                >
        </div>

        <div class="project-item-title">
            <h4>Atmel®Arduino Projects</h4>
        </div>
    </a>
</div>

                    
                        <div class="section-lists list-items">
    <a href="/list/5418-atmel-parts">
        <div title="Atmel Parts" class="list-item-cover"
                
                    style="background-image: url('https://cdn.hackaday.io/images/resize/600x600/9259511429837239171.jpg')"
                
                >
        </div>

        <div class="project-item-title">
            <h4>Atmel Parts</h4>
        </div>
    </a>
</div>

                    
                        <div class="section-lists list-items">
    <a href="/list/5847-2015-thp-atmel-parts">
        <div title="2015 THP: Atmel Parts" class="list-item-cover"
                
                    style="background-image: url('https://cdn.hackaday.io/images/resize/600x600/5531601431802700506.jpg')"
                
                >
        </div>

        <div class="project-item-title">
            <h4>2015 THP: Atmel Parts</h4>
        </div>
    </a>
</div>

                    
                    <a href="/lists/">Browse all lists »</a>
                </div>
            

            
                <div class="section section-submissions-lists">
                    <h5>This project is submitted for</h5>
                    <ul>
                        
                            <li><a href="/submissions/tipline/list">Hackaday.com Tip Line</a></li>
                        
                            <li><a href="/submissions/prize2015/list">The 2015 Hackaday Prize</a></li>
                        
                            <li><a href="/submissions/bestproduct/list">Best Product</a></li>
                        
                    </ul>
                </div>
            

            <div class="section section-project-time">
                <p class="project-time">
                    This project was
                        
                            created on 03/10/2015
                            
                                 and last updated 2 days ago.
                            
                        
                </p>
            </div>

            

        </div>

        <div class="content-right">

            
                <div class="section section-description">
                    <h5>Description</h5>
                    <div class="description">In India most of the people are living in rural areas,400 million people that are currently have no access to electricity.Despite India being the world's 5th largest energy producer,the existing electric grids are not capable of supplying the electricity need to those poor people.<br />So the need for clean, affordable alternatives is obvious.Solar power have the advantage of being less maintenance and pollution free.<br />To provide basic need of electricity and improve the socio-economic positions of rural people, I started this project from basic lighting system and a simple PWM solar charge Controller in March-2014.The feedback was incredible on Instructables. After working over one year to improve the controller, I have landed up in this stage.This project is on  MPPT solar charge controller which can charge a commonly used 12V lead acid battery from a solar panel.This is more sophisticated,30 to 40 % more efficient and have several advantages over the other charge controllers.<br /><br /></div>
                </div>
            

            
                <div class="section section-details">
                    <h5>
                        
                            Details
                        
                    </h5>
                    

                    
                        <div class="post-content details-content">
                            <p><p><strong><br></strong></p><iframe style="width: 500px; height: 281px;" width="500" height="281" src="//www.youtube.com/embed/QsbOs_BoMpU" frameborder="0" allowfullscreen=""></iframe><p><strong><br></strong></p><p><img src="https://cdn.hackaday.io/images/8192321436867829911.jpg" width="431" height="324" style="width: 431px; height: 324px;"></p><p>MPPT stands for Maximum Power Point Tracking. MPPT charge controllers used for extracting maximum available power from PV module under certain conditions.The Maximum Power Point Tracker (MPPT) circuit is based around a synchronous buck converter circuit.It steps the higher solar panel voltage down to the charging voltage of the battery. The Arduino tries to maximize the watts input from the solar panel by controlling the duty cycle to keep the solar panel operating at its Maximum Power Point.<br></p><p>You can find more details on MPPT <a href="http://www.instructables.com/id/ARDUINO-SOLAR-CHARGE-CONTROLLER-Version-30/step2/Basics-on-MPPT-charge-controller/" target="_blank">here</a></p><p><strong>Algorithm :</strong><br></p><p><strong><br></strong></p><img src="http://cdn.instructables.com/FYU/NYG1/I66CT4N9/FYUNYG1I66CT4N9.LARGE.jpg"><p>The Maximum Power Tracker uses an iterative approach to finding this constantly changing MPP. This iterative method is called Perterb and Observe or hill climbing algorithm.To achieve MPPT, the controller adjusts the voltage by a small amount from the solar panel and measures power, if the power increases, further adjustments in the direction are tried until power no longer increases.<br></p><p>The voltage to the solar panel is increased initially, if the output power increase, the voltage is continually increased until the output power starts decreasing. Once the output power starts decreasing, the voltage to the solar panel decreased until maximum power is reached. This process is continued until the MPPT is attained. This result is an oscillation of the output power around the MPP.</p><iframe style="width: 500px; height: 281px;" width="500" height="281" src="//www.youtube.com/embed/3WFlmTPXyk4" frameborder="0" allowfullscreen=""></iframe><p><strong>Specification of version-3 charge controller :</strong><br></p><p>1.Based on MPPT algorithm</p><p>2. LED indication for the state of charge</p><p>3. 20x4 character LCD display for displaying voltages,current,power etc</p><p>4. Overvoltage / Lightning protection</p><p>5. Reverse power flow protection</p><p>6. Short Circuit and Over load protection</p><p>7. Wi Fi data logging</p><p>8.USB port for Charging Smart Phone /Gadgets</p><p><strong>Electrical specifications :</strong></p><p>1.Rated Voltage= 12V</p><p>2.Maximum current = 5A</p><p>3.Maximum load current =10A</p><p>4. In put Voltage = Solar panel with Open circuit voltage from 12 to 25V</p><p>5.Solar panel power = 50W</p>
                                
                            </p>
                        </div>
                    
                    <div class="detail-btns">
                    
                            
                    
                    </div>
                </div>

            

            
                
                    <div class="section section-components">
                        <h5>
                            
                                Components
                            
                        </h5>
                        
                            <ul class="section-component-list">
                                
                                    
    <li class="component-42728">
        <span class="component-number">1</span>
        <span class="component-x">×</span>
        <span class="component-content">
            Arduino 
            <span class="component-description">Nano</span>
       </span>
    </li>

    <li class="component-42729">
        <span class="component-number">1</span>
        <span class="component-x">×</span>
        <span class="component-content">
            Current Sensor
            <span class="component-description">ACS712 -5A </span>
       </span>
    </li>

    <li class="component-42730">
        <span class="component-number">1</span>
        <span class="component-x">×</span>
        <span class="component-content">
            Buck Converter 
            <span class="component-description">DC-DC buck converter 3A</span>
       </span>
    </li>

    <li class="component-42731">
        <span class="component-number">1</span>
        <span class="component-x">×</span>
        <span class="component-content">
            Wifi Module 
            <span class="component-description">ESP8266</span>
       </span>
    </li>

    <li class="component-42732">
        <span class="component-number">1</span>
        <span class="component-x">×</span>
        <span class="component-content">
             LCD display
            <span class="component-description">I2C 20x4</span>
       </span>
    </li>

    <li class="component-42733">
        <span class="component-number">4</span>
        <span class="component-x">×</span>
        <span class="component-content">
            MOSFETS
            <span class="component-description">IRFz44 N-channel MOSFETS</span>
       </span>
    </li>

    <li class="component-42734">
        <span class="component-number">1</span>
        <span class="component-x">×</span>
        <span class="component-content">
             MOSFET driver
            <span class="component-description">IR2104</span>
       </span>
    </li>

    <li class="component-42735">
        <span class="component-number">1</span>
        <span class="component-x">×</span>
        <span class="component-content">
            3.3V Linear regulator
            <span class="component-description">AMS1117</span>
       </span>
    </li>

    <li class="component-42736">
        <span class="component-number">1</span>
        <span class="component-x">×</span>
        <span class="component-content">
            Transistor
            <span class="component-description">2N2222</span>
       </span>
    </li>

    <li class="component-42737">
        <span class="component-number">1</span>
        <span class="component-x">×</span>
        <span class="component-content">
            Diode
            <span class="component-description">UF4007</span>
       </span>
    </li>

                                
                            </ul>
                        <p>
                            
                            
                                <a href="/project/4613/components" class="grey-gold-button medium-button  show">See all components</a>
                            
                        </p>
                    </div>
                
            

            
                <div class="section section-buildlogs">

                    <h5>Project logs</h5>
                    
                    <ul class="buillogs-list post-content details-content">
                    
                        <li>
                            <h2><a href="/project/4613/log/22919-quarter-final-video">Quarter Final Video</a></h2>
                            <small class="authorship">2 days ago  &bull;
                            <a class="gray-link" href="/project/4613/log/22919#discussion-list">
                                0 comments
                            </a>
                            </small>
                            <p><iframe style="width: 500px; height: 281px;" width="500" height="281" src="//www.youtube.com/embed/3DRHFD98NdE" frameborder="0" allowfullscreen=""></iframe>
                                
                            </p>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4613/log/22676-keith-presentation">Keith Presentation </a></h2>
                            <small class="authorship">5 days ago  &bull;
                            <a class="gray-link" href="/project/4613/log/22676#discussion-list">
                                0 comments
                            </a>
                            </small>
                            <p><iframe style="width: 500px; height: 281px;" width="500" height="281" src="//www.youtube.com/embed/phVTCxbeUoY" frameborder="0" allowfullscreen=""></iframe><p><a class="team-link" href="https://hackaday.io/hacker/70480-keithhungerford">keith.hungerford</a> ( team member ) from Australia, who is one of the major contributor to this project.He has experimented a lot on this project.After my request he made this nice video explaining the efficiency,losses at various load,how DCM will take care at low load condition, about the MPPT v4 controller and writing of a new Arduino TimerOne library to handle our requirement.<br></p><p>These are the loss analysis curves at different load condition.</p><p><strong>At 100 Watt : </strong></p><p><img src="https://cdn.hackaday.io/images/1123881439468169438.jpg"></p><p><strong>At  80 Watt :</strong></p><p><img src="https://cdn.hackaday.io/images/8745091439468527051.jpg"><span class="redactor-invisible-space"><strong>At 1 watt : </strong><br></span></p><p><span class="redactor-invisible-space"><img src="https://cdn.hackaday.io/images/8597341439468565631.jpg"></span><br></p><p>In the 100% ( 100W ) graph, the optimum PWM period is 14 microseconds, at which period the decrease in the core loss is balanced by the increase in the switching and capacitive drive loss. When Keith checked, he found that the capacitive drive losses are so nearly equal to the switching losses that the curves fully overlap and you cannot see the capacitive loss curve. It is more clear at 80%  ( 80W ) load  where both curves are visible. </p><p>As the load decreases, the resistive losses decrease and the relative influence of these period-dependent losses increases, but the pattern remains the same. In the MOSFETS,  the importance of the switching losses decreases with decreasing load, since there is less current flowing and therefore a reduced amount of charge to be absorbed, even though the voltage excursion is unchanged. The capacitive losses come to dominate. Because the switching losses are less, the optimum PWM period decreases with decreasing load. At 10% load it is down to 11 microseconds. </p><p>However the difference between the total loss at 11 microseconds and 14 microseconds is only 5% of the loss, so a single PWM period of around 14 microseconds is quite efficient SO LONG AS THE CONTROLLER IS IN CCM. </p><p>Somewhere below the 10 % load point, but above the 5% load point, the controller goes into DCM. That is, there is not enough current flowing out of the panel to make the current in the inductor always flow in the same direction. <br></p><p>His design assumption in this spreadsheet is that the controller algorithms explicitly support DCM. That is, they switch off Q3 at the time that the current would start flowing &quot;backwards&quot;. So now, in DCM, the controller has 3 phases within the PWM period. There is the phase when current flows from the panel via Q2 through the inductor, and increases. there is the phase when current flows from Earth via Q3 through the inductor, and decrease. Then there is the Null phase when no current flows through the inductor. </p><p>This Null phase is a good one as far as losses in the inductor and MOSFETs are concerned - there is no current and so no loss. However C1 is receiving all of the current from the panels, and C2 is delivering all of the current to the battery or load. This creates extra voltage ripple at the panels, and at the battery/load. </p><p>So long as the voltage ripple at the panels and battery/load is within reasonable limits, in DCM it is better to have a much longer PWM period. Hence the appearance of very long PWM periods at very low load levels. The length of the PWM period is mainly limited by the voltage ripple tolerable at the battery, and the reduction in efficiency of the panel caused by the ripple there. <br></p>
                                
                            </p>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4613/log/22579-finished-the-soldering">Finished the Soldering</a></h2>
                            <small class="authorship">6 days ago  &bull;
                            <a class="gray-link" href="/project/4613/log/22579#discussion-list">
                                2 comments
                            </a>
                            </small>
                            <p><p><img src="https://cdn.hackaday.io/images/9171291439349622666.jpg"></p><p><img src="https://cdn.hackaday.io/images/9047511439349658246.jpg"></p><p><img src="https://cdn.hackaday.io/images/2073141439349721770.jpg"></p><p>Purchased all the missing components and started to solder it on PCB.After few hours of work, everything is soldered.I have tested auxiliary power circuitry,everything works fine.The next task is to test the charging circuit.I will update it soon.</p>
                                
                            </p>
                        </li>
                    
                    </ul>
                    <p class="log-btns">
                        
                        
                            <a href="/project/4613/logs" class="grey-gold-button medium-button show">
                            
                                View all 10 project logs
                            
                            </a>
                        
                    </p>
                </div>
            

            
                
                    <div class="section section-instructions">
                        <h5>Build instructions</h5>
                        
                        
                            <ul class="post-content section-instructions-list">
                                
                                    <li>
                                        <span class="instruction-number">1</span>
                                        <div class="instruction-list-item"><p>This project is consists of 40 steps.So for simplicity I divided the entire project in to small sections.Click on the link which you want to see.<br><br>1. <a href="http://www.instructables.com/id/ARDUINO-SOLAR-CHARGE-CONTROLLER-Version-30/step2/Basics-on-MPPT-charge-controller/" rel="nofollow" target="_blank">Basics on MPPT charge controller</a></p><p>2. <a href="http://www.instructables.com/id/ARDUINO-SOLAR-CHARGE-CONTROLLER-Version-30/step3/BUCK-CONVERTER-WORKING/" rel="nofollow" target="_blank">Buck circuit working and design calculation</a></p><p>3. <a href="http://www.instructables.com/id/ARDUINO-SOLAR-CHARGE-CONTROLLER-Version-30/step11/Test-the-gate-driver-and-MOSFETs-Switching/" rel="nofollow" target="_blank">Testing the Buck Circuit</a></p><p>4. <a href="http://www.instructables.com/id/ARDUINO-SOLAR-CHARGE-CONTROLLER-Version-30/step13/VOLTAGE-MEASUREMENT/" rel="nofollow" target="_blank">Voltage and Current Measurements</a></p><p>5.<a href="http://www.instructables.com/id/ARDUINO-SOLAR-CHARGE-CONTROLLER-Version-30/step15/LCD-Display-and-LED-Indication/" rel="nofollow" target="_blank">LCD display and LED indication</a></p><p>6.<a href="http://www.instructables.com/id/ARDUINO-SOLAR-CHARGE-CONTROLLER-Version-30/step16/HARDWARE-AND-SOLDERING/" rel="nofollow" target="_blank">Making the Charging Board</a></p><p>7.<a href="http://www.instructables.com/id/ARDUINO-SOLAR-CHARGE-CONTROLLER-Version-30/step35/Prepare-the-Enclosure/" rel="nofollow" target="_blank">Making the Enclosure</a></p><p>8. <a href="http://www.instructables.com/id/ARDUINO-SOLAR-CHARGE-CONTROLLER-Version-30/step30/Make-the-USB-Charging-Circuit/" rel="nofollow" target="_blank">Making the USB Charging Circuit</a></p><p>9. <a href="http://www.instructables.com/id/ARDUINO-SOLAR-CHARGE-CONTROLLER-Version-30/step31/Make-the-Wifi-Module-Circuit/" rel="nofollow" target="_blank">Wi Fi Data Logging</a></p><p>10. <a href="http://www.instructables.com/id/ARDUINO-SOLAR-CHARGE-CONTROLLER-Version-30/step39/Software-and-Algorithm/" rel="nofollow" target="_blank">MPPT algorithm and flow chart</a></p></div>
                                    </li>
                                
                            </ul>
                        
                        <p>
                            
                            
                                <a href="/project/4613/instructions" class="grey-gold-button medium-button show">See all instructions</a>
                            
                        </p>
                    </div>
                
            
            
            <div class="section section-discussions last">
        <h5 id="j-discussions-title" class="j-discussions-title">Discussions</h5>

    <form id="j-discussion-add-top" action="/discussions/add" name="add-comment" method="POST" class="skip-global-form j-discussion-add hide">
        <div class="textarea-holder">
            <textarea placeholder="Add your comment" name="comment" class="editable input-comment"></textarea>
        </div>
        <input type="hidden" name="categoryId" value="4613" />
        <input type="hidden" name="category" value="project" />
        <input type="hidden" name="_csrf" value="8f9QZ9KD-qQgg2YhrZ1DgA4tdiJ0p60xw0o4" />
        <input type="hidden" name="replyTo" value="0" />
        <input type="submit" class="grey-gold-button medium-button" value="Post comment" />
    </form>

    <div id="discussion-list">
        
<p>
    <div class="signup-holder textarea-holder">
        <textarea placeholder="Sign in or become a member to leave your comment" name="comment" class="editable input-comment"></textarea>
    </div>
    <a href="#" class="login-button grey-gold-button medium-button half show">Sign in/up to comment</a>
</p>
<div class="modal-content-holder login-modal" id="login-modal">
    <div class="submissions-close modal-cancel"></div>
    <div class="signup-holder">
        <h2>Become a member</h2>
        <p>In order to follow projects & hackers or give skulls
        <br />you need to create an account.</p>
        <form action="/signup" method="POST">
            <fieldset class="form-left">
                <input type="text" class="input-field" placeholder="Enter your email address" required name="email"  />
                <input type="password" class="input-field" placeholder="Pick a secure password" required name="password"  />
            </fieldset>
            <fieldset class="form-right">
              <button class="gold-gold-button signup" type="submit">Sign up</button>
          </fieldset>
          <input type="hidden" name="_csrf" value="8f9QZ9KD-qQgg2YhrZ1DgA4tdiJ0p60xw0o4" />
          <input class="input-field" placeholder="Invitation Code" required name="invitation_code" value="5Ad0ix2-b96J" type="hidden" />
        </form>
        <a id="login-modal-signin" href="/signin">Already a member?</a>
    </div>
</div>





    
    

    <div id="j-discussion-32922" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/32966"><img src="https://cdn.hackaday.io/images/resize/100x100/2654271413389027834.jpg?r=x&amp;s=400" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/32966">case06</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-32922">5 days ago</a>

                <span id="comment-points-holder-32922" class="hide">
                    &bull; <span id="comment-points-32922">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-32922-content">
                    <p>wetherall i like much your prototype-board designs, this new pcb looks great. Do you plan to sell it ?<br></p>
                </div>
                <p id="comment-32922-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-32922">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-32923" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/55735"><img src="https://cdn.hackaday.io/images/resize/100x100/6184171426011439165.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/55735">Debasish Dutta</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-32923">5 days ago</a>

                <span id="comment-points-holder-32923" class="hide">
                    &bull; <span id="comment-points-32923">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-32923-content">
                    <p>Thanks.</p><p>Till now not planned as some issues are present. After solving everything,&#xA0;I will think for it.</p>
                </div>
                <p id="comment-32923-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-32923">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-32384" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/76353"><img src="//gravatar.com/avatar/b47b94871dc769c19ca29d1334e94fe4?d=https://hackaday.io/img/default-avatar.png&amp;r=x&amp;s=100" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/76353">Lars Sorensen</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-32384">14 days ago</a>

                <span id="comment-points-holder-32384" class="hide">
                    &bull; <span id="comment-points-32384">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-32384-content">
                    <p>So... How is it going with the project?</p><p>I found these really cool power supplys for USB, that might be cool for the project:</p><p><a href="http://www.ebay.com/itm/281588476204?_trksid=p2060353.m1438.l2649&amp;ssPageName=STRK%3AMEBIDX%3AIT">http://www.ebay.com/itm/281588476204?_trksid=p2060353.m1438.l2649&amp;ssPageName=STRK:MEBIDX:IT</a></p><p><a href="http://www.ebay.com/itm/291214704965?_trksid=p2060353.m1438.l2649&amp;ssPageName=STRK%3AMEBIDX%3AIT"></a></p><p><a href="http://www.ebay.com/itm/281588476204?_trksid=p2060353.m1438.l2649&amp;ssPageName=STRK%3AMEBIDX%3AIT"></a></p><p><a href="http://www.ebay.com/itm/291214704965?_trksid=p2060353.m1438.l2649&amp;ssPageName=STRK%3AMEBIDX%3AIT">http://www.ebay.com/itm/291214704965?_trksid=p2060353.m1438.l2649&amp;ssPageName=STRK:MEBIDX:IT</a></p>
                </div>
                <p id="comment-32384-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-32384">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-30867" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/55735"><img src="https://cdn.hackaday.io/images/resize/100x100/6184171426011439165.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/55735">Debasish Dutta</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-30867">a month ago</a>

                <span id="comment-points-holder-30867" class="hide">
                    &bull; <span id="comment-points-30867">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-30867-content">
                    <p>Thank you to all of you for your valuable&nbsp;support and feedbacks.</p><p>I &nbsp;won a DSlogic analyzer&nbsp; for using Atmel parts in my&nbsp;2015 Hackaday Prize entry.</p><p><a href="http://hackaday.com/2015/07/09/50-winners-using-atmel-parts/">http://hackaday.com/2015/07/09/50-winners-using-atmel-parts/</a><br></p>
                </div>
                <p id="comment-30867-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-30867">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-30876" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/10708"><img src="https://cdn.hackaday.io/images/resize/100x100/1658021406086306892.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/10708">K.C. Lee</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-30876">a month ago</a>

                <span id="comment-points-holder-30876" class="hide">
                    &bull; <span id="comment-points-30876">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-30876-content">
                    <p>Congrats! &nbsp;You've earned it!</p>
                </div>
                <p id="comment-30876-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-30876">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-30877" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/55735"><img src="https://cdn.hackaday.io/images/resize/100x100/6184171426011439165.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/55735">Debasish Dutta</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-30877">a month ago</a>

                <span id="comment-points-holder-30877" class="hide">
                    &bull; <span id="comment-points-30877">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-30877-content">
                    <p>Thanks and Congrats to you too :)</p>
                </div>
                <p id="comment-30877-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-30877">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-30878" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70774"><img src="https://cdn.hackaday.io/images/resize/100x100/9221591432728713902.JPG" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70774">Petar</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-30878">a month ago</a>

                <span id="comment-points-holder-30878" class="hide">
                    &bull; <span id="comment-points-30878">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-30878-content">
                    <p>Congratulations!</p>
                </div>
                <p id="comment-30878-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-30878">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-31032" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/55735"><img src="https://cdn.hackaday.io/images/resize/100x100/6184171426011439165.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/55735">Debasish Dutta</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-31032">a month ago</a>

                <span id="comment-points-holder-31032" class="hide">
                    &bull; <span id="comment-points-31032">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-31032-content">
                    <p>Thank You&#xA0;</p>
                </div>
                <p id="comment-31032-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-31032">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-30713" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/80068"><img src="//gravatar.com/avatar/c92526151f8140586c908a99e86787b1?d=https://hackaday.io/img/default-avatar.png&amp;r=x&amp;s=100" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/80068">antscran</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-30713">a month ago</a>

                <span id="comment-points-holder-30713" class="hide">
                    &bull; <span id="comment-points-30713">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-30713-content">
                    <p>Just joined the site and was reading some of the posts on here,&nbsp;I have built an&nbsp;MPPT tracker on the Texas Instruments C2000 platform back in January 2014. &nbsp;It used a synchronous buck converter&nbsp;and also in a interleaved design to reduce the peak current, although it was only used on a 10W panel it could be easily scaled.</p><p>I am working on a new design which can be used with any microcontroller and currently have code for MSP430, working on Tiva C and will also bring over to the Arduino when I have time. &nbsp;No battery charger circuit yet but will add this functionality as well.</p><p>The 4 part tutorial can be found here as well as some videos demonstrating the P&amp;O algorithm working:</p><p><a href="http://coder-tronics.com/c2000-solar-mppt-tutorial-pt1/">http://coder-tronics.com/c2000-solar-mppt-tutorial-pt1/</a></p><p><a href="http://coder-tronics.com/c2000-solar-mppt-tutorial-pt2/">http://coder-tronics.com/c2000-solar-mppt-tutorial-pt2/</a></p><p><a href="http://coder-tronics.com/c2000-solar-mppt-tutorial-pt3/">http://coder-tronics.com/c2000-solar-mppt-tutorial-pt3/</a></p><p><a href="http://coder-tronics.com/c2000-solar-mppt-tutorial-pt4/">http://coder-tronics.com/c2000-solar-mppt-tutorial-pt4/</a></p><p>Shamlessly advertising my site :-)</p>
                </div>
                <p id="comment-30713-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-30713">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-30776" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/55735"><img src="https://cdn.hackaday.io/images/resize/100x100/6184171426011439165.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/55735">Debasish Dutta</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-30776">a month ago</a>

                <span id="comment-points-holder-30776" class="hide">
                    &bull; <span id="comment-points-30776">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-30776-content">
                    <p>Hi friend ,</p><p>No problem.I have already seen your tutorial.Its really nice.</p><p>If you have any suggestions please comments on my project.</p>
                </div>
                <p id="comment-30776-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-30776">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-29792" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/74191"><img src="//gravatar.com/avatar/3504e95747047bad2ee874828a566214?d=https://hackaday.io/img/default-avatar.png&amp;r=x&amp;s=100" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/74191">aplavins</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-29792">2 months ago</a>

                <span id="comment-points-holder-29792" class="hide">
                    &bull; <span id="comment-points-29792">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-29792-content">
                    <p>There are a few things about the code that I found issue with, I'm trying to fix them without messing up the rest. Please let me know if these issues make sense.</p><p>The variable pwm is a number between 0-100 whichis then divided by 100 and multiplied with 1024. This means that every % step we jump about 10 intergers. We could use all 1024 steps and have better duty cycle&nbsp;accuracy and therefore better&nbsp;voltage regulation.</p><p>When the sol watts is low, the charger goes into full on, which is the opposite of what it should do. We would want to use MPPT in this instance to get as much out of the panel as possible.</p><p>The decision of which state to be in relies on sol watts, I think it should be dependent on voltage only. We can use sol watts in the tracking algorithm and for display and data collection purposes but not here.</p>
                </div>
                <p id="comment-29792-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-29792">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-29836" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-29836">2 months ago</a>

                <span id="comment-points-holder-29836" class="hide">
                    &bull; <span id="comment-points-29836">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-29836-content">
                    <p>Hi Adam, a few comments on your suggestions. I don't have answers, but thoughts on some lines of inquiry to get the best system.&nbsp;</p><p>I agree the use of 0 - 100 in units of 1 for PWM, then converting to an integer between 0 and 1024 is clumsy. It would be more logical just to set the number to its final binary value. However what is the best step size, ie 10 or 1 or whatever, is not so clear. I think there are several issues to think about here. Smaller step size will lead to slower convergence on the "best" value, and perhaps a more accurate setting. On the other hand, the quantisation of current and voltage measurements may have a role as well. Further, the environment may be unstable - that is, there may be variable illumination on the panels. Sometimes there will be steady, slowly changing illumination (eg on a clear day when the sun is at an angle which changes hour by hour). At other times there may be patchy clouds which come and go between the sun and the panels. Or the panels may be affected by shadowing from trees which are moving because of wind. Just how complicated we should be, can be, I don't know. There may be some good references out there (someone may have done their PhD on MPPT algorithms?)&nbsp;</p><p>So maybe there is a PWM quantisation "sweet spot" that gives us good performance across the whole range of conditions. Some analysis and modelling might help.<br></p><p>Another thing has become clear to me working on sizing the inductor and capacitors, is that there is a substantial ripple current in capacitor C1, some of which is seen at the panel as voltage and/or current excursion. Is there some way of getting value out of that ripple to direct the MPPT algorithm?</p><p>I agree it seems logical that the decision to start MPP tracking should depend on solar panel voltage. But it also should depend on battery state of charge and the load current - if the output requirement is much less than what the panel can produce, we don't need MPPT at that time, we need to control the output current so that the voltage at the battery is the appropriate value for Float or Boost charging. I have not checked back over the code but I think this is already in there. I THINK&nbsp; the right behaviour is to reduce the PWM so that the panel current falls, panel power falls, until the current into the Battery + Load just matches the demand, to give us the desired Float or Boost charging voltage. This is a sort of tracking, but it is not maximum power point tracking.</p><p>I think it would be good to have a clear description of all the states, and the conditions that lead to transitions to and from each one.</p><p>Keith<br></p>
                </div>
                <p id="comment-29836-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-29836">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-29840" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/74191"><img src="//gravatar.com/avatar/3504e95747047bad2ee874828a566214?d=https://hackaday.io/img/default-avatar.png&amp;r=x&amp;s=100" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/74191">aplavins</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-29840">2 months ago</a>

                <span id="comment-points-holder-29840" class="hide">
                    &bull; <span id="comment-points-29840">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-29840-content">
                    <p>Thanks for the reply Keith,</p><p>I uploaded a new version of the code to my github. I need someone with the standard hardware to test it. See if it does it's job and maybe some info on how long&nbsp;it takes to find MPP. link is here:&nbsp;<a href="https://github.com/aplavins/MPPT_Master/blob/master/MPPT_Code/MPPT_Code.ino">https://github.com/aplavins/MPPT_Master/blob/master/MPPT_Code/MPPT_Code.ino</a></p><p>The charger has 5 states:</p><p>no_battery: If the voltage is below 10V, the battery is either too dead to charge or not connected. Charger is off, displays "noBat".</p><p>sleep: If the panel voltage drops below 15V, it's probably night. Turn the charger off to prevent current leaking back into the panel. (I think we are all still using Q1 right?)</p><p>bulk: If the panel voltage is above 15V and battery voltage is above 10 but below 13.5, go into bulk&nbsp;charging. begin MPPT algorithm.&nbsp;duty cycle starts at 50% (512) and changes by 1 each time through the loop. First direction is positive (more loading of the panel). MOSFET driver is enabled. sol watts begins at 0, on the second loop, it will have a value and on the third loop that value will be stored in old_sol_watts. Then begins the tracking, if the new value of sol_watts is less than the previous one, change direction of travel. In case of my panels MPP is at around 44% so we began at 50% and went up so in my case we would switch direction here. At this point it loops until it finds (and just passes) the MPP and then switches direction again, forever.</p><p>float: if the battery voltage rises above 13.5, we stop MPPT and begin PWM on the ShutDown pin. At 13.5 the charger is on 99.9% and&nbsp;is enabled. At 13.6 charger is still at 99.9% but is disabled. voltage will hover at the threshold of 13.5-13.6.</p><p>error: If the battery voltage goes above 15V, something is wrong. The battery will be over-charged. Turn off charger. display "error"</p><p>The % of pwm is now derived from pulseWdith(0-1024) instead of the other way around.&nbsp;</p><p>The switch case happens in a seperate "if" statement and uses only voltage to decide which state to be in</p><p>Unless the battery is full, we are always using MPPT now. This applies to adding additional&nbsp;loads as well.</p><p>My CC has been working unsupervised for about 2 weeks now on a similar version of this code. Only difference is the way PWM is sent to the driver and the MPPT algorithm.</p><p>If you find any issues with the code, put them in "issues" on github and I'll try to correct them. Unfortunately it's tough to test when you don't have the same&nbsp;hardware. Anyone in Ontario, Canada that has it?</p>
                </div>
                <p id="comment-29840-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-29840">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-29897" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-29897">2 months ago</a>

                <span id="comment-points-holder-29897" class="hide">
                    &bull; <span id="comment-points-29897">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-29897-content">
                    <p>Hi Adam, this is all clear to me except&nbsp; for: "float: if the battery voltage rises above 13.5, we stop MPPT and begin <br>PWM on the ShutDown pin. At 13.5 the charger is on 99.9% and&nbsp;is enabled. At 13.6 charger is still at 99.9% but is disabled. voltage will hover at the threshold of 13.5-13.6."</p><p>Can you please explain a bit more. Is it correct that when you "begin PWM on the ShutDown pin" that you hold the IN pin at 1 (High) and that the duty cycle on the SD pin is reversed? - it it has a short period of 0 (when HO will go high) and a long period of 1 (when HO will go low). Maybe the "enabled" and "disabled" relates to the IN pin?&nbsp;</p><p>I guess that if the 0.1% PWM is not sufficient to hold the battey at 13.5 volts, then it will go down a bit and the charger will revert to MPPT briefly, so there will be an alternation between around 13.4 and 13.5 to 13.6. Is that correct?</p><p>Thanks, Keith<br></p>
                </div>
                <p id="comment-29897-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-29897">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-29912" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70774"><img src="https://cdn.hackaday.io/images/resize/100x100/9221591432728713902.JPG" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70774">Petar</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-29912">2 months ago</a>

                <span id="comment-points-holder-29912" class="hide">
                    &bull; <span id="comment-points-29912">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-29912-content">
                    <p>Hi guys! I found something interesting. It's for Microchip but is useful:</p><p><a href="http://ww1.microchip.com/downloads/en/AppNotes/00001521A.pdf">http://ww1.microchip.com/downloads/en/AppNotes/00001521A.pdf</a></p>
                </div>
                <p id="comment-29912-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-29912">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-29950" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/74191"><img src="//gravatar.com/avatar/3504e95747047bad2ee874828a566214?d=https://hackaday.io/img/default-avatar.png&amp;r=x&amp;s=100" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/74191">aplavins</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-29950">2 months ago</a>

                <span id="comment-points-holder-29950" class="hide">
                    &bull; <span id="comment-points-29950">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-29950-content">
                    <p>Hi Keith,</p><p>The pwm of 99.9% is always&nbsp;on the IN pin while in float. The SD pin is set&nbsp;high (on) when the&nbsp;voltage is at 13.5 and low (off) when at 13.6. If the voltage drops below 13.5, the charger will go back into bulk and&nbsp;MPPT will resume. It's like having a PWM charge controller switching from full on to open circuit, except that full on is&nbsp;99.9% for the charge pump.</p><p>This is in contrast to the previous method which was to reduce the pwm on the IN pin lower and lower to prevent the voltage going too high without changing the SD pin state. The problem was that at very low pwm values, the inductor would saturate and&nbsp;Q3 would be shorting the battery and fail.</p><p>Now we are just setting the whole system to open circuit when voltage reaches 13.6. In the future I want to add a diversion load feature with it's own control MOSFET similar to the LOAD MOSFET. When the charger goes into float, it would turn on the diversion load to continue to utilize the power coming from the panel(s) even when the battery has been charged. The load would be best matched to ~90% of&nbsp;the output of the panel(s). It could be used to pump water from a well or heat/cool a space. I think this would be a useful feature in V4.</p>
                </div>
                <p id="comment-29950-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-29950">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-29983" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-29983">a month ago</a>

                <span id="comment-points-holder-29983" class="hide">
                    &bull; <span id="comment-points-29983">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-29983-content">
                    <p>Hi Adam, thank you for the clarification. I believe that now a) I understand what your software is doing and b) I have corrected my misinterpretation of the IR2104 datasheet (for some reason I had the logic of the SD_bar pin upside down).&nbsp;</p><p>I think that even with the new version of software you have written, there is still an opportunity to&nbsp; have Q3 burnout. This will happen if the battery voltage sits and stays at 13.5 V for an extended time. At that voltage, the IN pin will be running at 1 on, 1023 off which means that Q3 will be 99.9% ON and the short OFF periods will not be sufficient to stop the reverse current flow. Therefore the reverse current flow will steadily increase, cycle after cycle, until something breaks.</p><p>You previously said "begin PWM on the ShutDown pin" and I think that is exactly what you need to do. If you hold the IN pin at a steady 1, and do PWM on the SD_bar pin, then when SD_bar is 1, HO is high making  Q1 and Q2 ON, and LO is low making Q3 OFF, In the other part of the PWM cycle, SD_bar is 1, so both HO and LO are low, so Q1, Q2 and Q3 are all OFF (Q1 a little bit delayed by&nbsp;the RC circuit controlling its gate). </p><p>With this configuration, the converter is operating Asynchronously and in Discontinuous Current Mode (DCM). This mode is appropriate for all current levels below the threshold where if Q3 is left ON the current flows backwards through the inductor. I have been studying this mode in relation to the V4 efficiency modelling, and will show the results in the not too distant future. <br></p><p>I will respond to your suggestion about a "diversion load" a bit later and probably in the V4 development log which is where I think it will be most easily found. by others.</p><p>I think it is really good to have found an explicit reason for the Q3 burnout problem, so this is really important progress.</p><p>Thanks again, Keith</p>
                </div>
                <p id="comment-29983-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-29983">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-30269" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-30269">a month ago</a>

                <span id="comment-points-holder-30269" class="hide">
                    &bull; <span id="comment-points-30269">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-30269-content">
                    <p>Hmm. Several things. I have made a local copy of your code and made a number of suggested adjustments to it. Most of them are just to do with editing comments. However there are a couple of "real" suggestions as well. I am not sure what is the best way of putting this into "the system". Currently it is in Word format with the changes highlighted with Track Changes.&nbsp;</p><p>In addition I have a few issues I have been unable to resolve.&nbsp;</p><p>a) polarity of PWM. My understanding is that if you set pulseWidth to (say) 102 (being about 10% of 1024) then you will get a signal out which spends 10% of its time as a 1 and 90% of its time as a 0. This seems to be the reverse of what you do in the code for case Float in the switch (charger_state) routine, where you set pulseWidth to 1022 which gives you close to 100% 1 (ie direct connection of solar panels to battery).&nbsp;</p><p>b) granularity of PWM. Even though the pulseWidth parameter taken by the Timer1.pwm function is a 10-bit value, it does not give a 1024 step granularity to the actual PWM, because it cannot (as I understand it). This is because a 20 microsecond period requires just 320 cycles at 16 MHz, which is the frequency of the Arduino clock. There is a function that translates the pulseWidth parameter (10 bit) into the counter value that causes the PWM transitions. I think it is in TimerOne.cpp in the function setPeriod; however I find it a bit opaque. But anyway I reckon that changing the pulseWidth parameter in units of 1 will result in no change in actual PWM ratio for 2 steps and then a change on the 3rd step (or in some cases the 4th step), because the 1024 values of pulseWidth have to map onto 320 values of the counter that determines the PWM transitions.&nbsp;</p><p>c) Minimum PWM to keep the IR2104 charge pump going: To keep the charge pump capacitor C7 giving around 10 V to the IR2104 VB pin, we need no less than a certain amount of time with HO at 1 and 0. I have not tried to work it out, but it must be at least a few 10s of nanoseconds. Now HO goes High about 700 ns after IN goes High, and goes Low about 200 ns after IN goes Low. So the pulse width on HO is about 500 ns shorter than on IN. There is a bit of variability in this, but I think we need a minimum pulse of about 800 nanoseconds on the IN pin, which would generate a pulse of 300 ns on the HO pin, with a further variable from the IRFZ44N which has a nominal rise time of 60 ns and a fall time of 45 ns, reducing our 300 ns by another 15. To get a minimum  pulse of 800 ns we need to set pulseWidth no higher than 983 and no lower than 41. These should mean PWM counter settings of 307 and 13 and thus actual pulse widths of&nbsp; 812.5 ns on IR2104&nbsp;pin IN. The next step down would be 750 ns. If this produces too high a charge rate in "Float" state, it will be looked after by the cycling between enable_charger and disable_charger. A further option, if we need to reduce the actual duty cycle further, is to increase the PWM period, as Debasish did in his original code.</p><p>d) DCM mode is a challenge. With the current hardware connections, it is not possible to do what I suggested in my previous post, that is to perform PWM on the SD pin. Reasons for this include the fact that currently the SD pin is connected to Arduino pin D8, which is not equipped to do PWM. However Arduino pin D10 is currently unused, and is equipped for PWM from Timer1, the same timer that runs the PWM on pin D9 connected to IN. Now this is where I get a bit unsure since there is a lot of complexity, some of it hidden and hard to find and understand. Timer1 has 2 counters, one of which is used to set the PWM period (ie the 20 microseconds that takes 320 clock cycles). The other one is used for performing PWM, currently only on pin D9 (IN). I think that if we want to do PWM on the SD pin (so as to implement Discontinuous Current Mode and reduce losses in the inductor, FETs and capacitors) then we just need to issue a new command similar to "Timer1.pwm(PWM_PIN, pulseWidth, 20), but for the SD pin.  With some suitable logic to use this at the right time, of course.<br>Requests please:</p><p>Suggestion of how to provide my comments/suggestions on the code</p><p>Comments on the above 4 issues a) to d).</p><p>Thanks, Keith</p>
                </div>
                <p id="comment-30269-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-30269">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-28746" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/55735"><img src="https://cdn.hackaday.io/images/resize/100x100/6184171426011439165.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/55735">Debasish Dutta</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-28746">2 months ago</a>

                <span id="comment-points-holder-28746" class="hide">
                    &bull; <span id="comment-points-28746">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-28746-content">
                    <p>Hi all,</p><p>Hackaday starts their second round of community voting for&nbsp;2015 Hackaday Prize&nbsp;, and it’s time to select the community choice for the project&nbsp;Most Likely to "Save The Planet".</p><p>I made this project to harvest green energy and &nbsp;help people to use clean energy.If we can use solar energy we can&nbsp;reduce the environmental pollution to a great extent.</p><p>I request you&nbsp;to vote for me,if you think it is useful.Your vote is valuable for me.</p><p>Thanks</p><p>You can vote &nbsp;by click on the link&nbsp;&nbsp;<a href="https://hackaday.io/prize/vote">https://hackaday.io/prize/vote</a></p><p><a href="http://hackaday.com/2015/06/22/new-round-of-astronaut-or-not-most-likely-to-save-the-planet/">http://hackaday.com/2015/06/22/new-round-of-astronaut-or-not-most-likely-to-save-the-planet/</a></p><p>here’s a video tutorial on how to vote:&nbsp;</p><p><iframe width="500" height="281" src="//www.youtube.com/embed/DeEf_VLKUl4" frameborder="0" allowfullscreen="" style="line-height: 1.4; background-color: initial;"></iframe><br></p>
                </div>
                <p id="comment-28746-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-28746">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-28837" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-28837">2 months ago</a>

                <span id="comment-points-holder-28837" class="hide">
                    &bull; <span id="comment-points-28837">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-28837-content">
                    <p>Well I voted, went through all my 50 votes, but this Arduino MPPT project did not come up, so I could not vote for it.&nbsp;</p><p>But I discovered a couple of other interesting projects along the way! Keith<br></p>
                </div>
                <p id="comment-28837-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-28837">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-28840" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/55735"><img src="https://cdn.hackaday.io/images/resize/100x100/6184171426011439165.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/55735">Debasish Dutta</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-28840">2 months ago</a>

                <span id="comment-points-holder-28840" class="hide">
                    &bull; <span id="comment-points-28840">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-28840-content">
                    <p>No problem :)</p><p>Anyway you discovered few interesting project is good news.Thanks</p>
                </div>
                <p id="comment-28840-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-28840">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-28327" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/71244"><img src="https://cdn.hackaday.io/images/resize/100x100/5267881432965756995.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/71244">Juan Perez Estrada</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-28327">2 months ago</a>

                <span id="comment-points-holder-28327" class="hide">
                    &bull; <span id="comment-points-28327">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-28327-content">
                    <p>Hi,&nbsp;</p><p>I begin to simulate this circuit in Multisim14. My power source is not a Solar Panel, it is a VDC Power Source of 15.2 V, I have also a square signal for IR2104 with a 80% duty cycle, so I expect a 12.16V as output.</p><p>The simulated output is 11.7V (with a 2ohm load)&nbsp;but what scares me is the first miliseconds. As you can see in this screen capture, output can reach 19 or 20V. I don't know if this is a big problem or is normal, and no item will be hurt about this little overvoltage.&nbsp;</p><p>The image show both square signal and output signal. Blue line is where output voltage is 19V and yellow one: 11.6V. &nbsp;The time at yellow line is 3.4 miliseconds.</p><p>Is a&nbsp;3.4 miliseconds overvoltage to worry about it ?</p><p>Link:&nbsp; <a href="http://thirdpartysoft.comlu.com/150617_MPPT.png" target="_blank">http://thirdpartysoft.comlu.com/150617_MPPT.png</a></p><p><img src="http://thirdpartysoft.comlu.com/150617_MPPT.png"><br></p><p>Does anybody know about it ?</p>
                </div>
                <p id="comment-28327-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-28327">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-28480" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/74191"><img src="//gravatar.com/avatar/3504e95747047bad2ee874828a566214?d=https://hackaday.io/img/default-avatar.png&amp;r=x&amp;s=100" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/74191">aplavins</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-28480">2 months ago</a>

                <span id="comment-points-holder-28480" class="hide">
                    &bull; <span id="comment-points-28480">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-28480-content">
                    <p>In the real world circuit, the battery would clamp the output voltage to it's own voltage. Only if the battery were disconnected in mid-charge would the voltage spike up that high.</p><p>More important is that at startup if you begin PWM at a value less than ~20% (say 0)&nbsp;and the code is slow to bring it up, you will have several milliseconds of a near dead short from B+ to B- through&nbsp;Q3. Which is the problem that the previous design was suffering. Simple fix is never allow the PWM to go below 30% or above 95%. I use constrain() to do this. When the battery is almost fully charged, the code will drop the PWM down as far as it can until it hits the constrain limit. At that point we have to stop modifying PWM on IN(pin) and start modifying PWM on SD(pin). During shutdown, both high and low side MOSFETs are off so no shorting and no over-charging.</p>
                </div>
                <p id="comment-28480-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-28480">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-28493" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/55735"><img src="https://cdn.hackaday.io/images/resize/100x100/6184171426011439165.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/55735">Debasish Dutta</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-28493">2 months ago</a>

                <span id="comment-points-holder-28493" class="hide">
                    &bull; <span id="comment-points-28493">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-28493-content">
                    <p>Thanks for clarifiaction.</p><p>I expect you will solve it by modifying the v-3 existing code .</p>
                </div>
                <p id="comment-28493-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-28493">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-28614" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/76301"><img src="https://avatars.githubusercontent.com/u/8700791?v=3" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/76301">juan3211</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-28614">2 months ago</a>

                <span id="comment-points-holder-28614" class="hide">
                    &bull; <span id="comment-points-28614">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-28614-content">
                    <p>Thanks for clarification apalvins, Great!!! I understand you perfectly. In any case, should it be avoided ? Or TVS will do his work ?&nbsp;</p><p>Another think, will&nbsp;Debasish and you work in the same github area ?</p>
                </div>
                <p id="comment-28614-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-28614">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-28615" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/55735"><img src="https://cdn.hackaday.io/images/resize/100x100/6184171426011439165.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/55735">Debasish Dutta</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-28615">2 months ago</a>

                <span id="comment-points-holder-28615" class="hide">
                    &bull; <span id="comment-points-28615">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-28615-content">
                    <p>You are right.We are rectifying&nbsp;few issues in the code.You can see the updated code in GitHub.</p>
                </div>
                <p id="comment-28615-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-28615">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-28278" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/74191"><img src="//gravatar.com/avatar/3504e95747047bad2ee874828a566214?d=https://hackaday.io/img/default-avatar.png&amp;r=x&amp;s=100" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/74191">aplavins</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-28278">2 months ago</a>

                <span id="comment-points-holder-28278" class="hide">
                    &bull; <span id="comment-points-28278">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-28278-content">
                    <p>Hi all,</p><p>Hope this finds you well, it's going to be a long one...</p><p>So I've built a copy of Deba's V3 charge controller with the newest circuitry. I wrote my own code for it because I'm not using current sensors. You can find it here&nbsp;<a href="https://github.com/aplavins/Arduino-MPPT">https://github.com/aplavins/Arduino-MPPT</a>.</p><p>A bit of background first, I've already built one of Jullian Ilett's arduino MPPT charge controllers and it was working great. His current version relies on a 9V battery to produce the required gate voltage to switch the high side MOSFETs. The battery dies eventually and the controller becomes inoperable. He has a nice solution with discrete components and opto-isolators but hasn't implemented or shared it yet. I stumbles across Deba's instructable that uses an IR2104 to do the high-side switching which is solution to the problem I was dealing with.</p><p>So I built one and I've been testing it on a 250W panel and a standard car battery. It works quite well after the new schematics were done (I had to learn the hard way). So far I've blown up 2 irfz44Ns in position Q3, 2 ir2104s (probably&nbsp;because of the shorting), and the charge pump capacitor. Repaired it each time without much hassle, no problem, it's all part of the prototyping process. The next thing to go will probably be the capacitors across the input of the ir2104. They are getting uncomfortably hot (even with a fan).</p><p>I added a few things:&nbsp;</p><p>-&nbsp;a large 12V fan that turns on during bulk state</p><p>- 5.1V zener diodes protecting all of the inputs to the arduino (I blew an arduino mega and almost my laptop while building the last charge controller)</p><p>- changed the voltage divider on the input side and other input side components to handle my solar panels (~35V open circuit in full sun)</p><p>Things I could do without:</p><p>-USB charger (I have about 10, don't need anymore but I understand that others might)</p><p>-WIFI chip (too complex, I just want to charge a battery)</p><p>-Current sensors (Would be nice to see the power, efficiency, etc. But don't need it to do MPPT)</p><p>-5V Buck converter (no usb charger so no buck converter. (we could make one from discrete components running off the same arduino))</p><p>-No LCD (If I really need to know what's going on, I'll plug in the serial&nbsp;cable. Other than that, I'll probably never need to know what it's doing, as long as it's doing it's job)</p><p>Improvements I think are needed:</p><p>- Fan (no question that this thing needs a fan)</p><p>- more accurate voltage measurement (I'm using 1% resistors and still my error is tenths&nbsp;of volts)</p><p>- better code (I'm working on this with Deba)</p><p>- more protection (If I can still blow up stuff, other peple are going too also)</p><p>- more reliable design (This will come with time and testing)</p><p>- greater current handling capabilities (putting MOSFETs in parallel)</p><p>- higher input voltages (less losses if panels are put in series)</p><p>I see this project going in 2 directions. People that need a tool that works for as cheap as possible (barebones design), and the serious hacker. The first group doesn't care about volts or watts or WIFI or data logging, they just want to plug in and do the job. The other group wants that with all of the goodies;&nbsp;displays, WIFI datalogging, LCD, etc.</p><p>phew....</p><p>I can help write code and test electronics, I'm very interested in this project for my own use and for sharing with others. I know the circuitry inside and out now, as well as the code. it's only a matter of making it suit the needs of everyone.</p><p>-Adam</p>
                </div>
                <p id="comment-28278-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-28278">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-28279" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/55735"><img src="https://cdn.hackaday.io/images/resize/100x100/6184171426011439165.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/55735">Debasish Dutta</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-28279">2 months ago</a>

                <span id="comment-points-holder-28279" class="hide">
                    &bull; <span id="comment-points-28279">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-28279-content">
                    <p>Hi Adam,</p><p>Thanks for sharing your experience and ideas.I am very happy to see you as a contributor to this project.</p>
                </div>
                <p id="comment-28279-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-28279">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-28599" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-28599">2 months ago</a>

                <span id="comment-points-holder-28599" class="hide">
                    &bull; <span id="comment-points-28599">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-28599-content">
                    <p>Hi Adam, great posting. I have a few questions I would like to put.</p><p>You say you can do MPPT without current measurement. From the code, I understand that every 15 seconds you disconnect from the solar panel(s), allow them to reach OC voltage, measure it, then set the PWM to draw current so that the on-load voltage will be 76% of the OC voltage.&nbsp; My question is, do you have an estimate of how much potential power you are losing from this simpler scheme?</p><p>Can you share the schematic diagram of your version of this controller? I am interested to see all the detail changes you have made to component values etc.</p><p>Most important to me, can you please share the design and construction details of the up-rated inductor you are using? <br></p><p>I think I am likely to have more comments and questions but will write them later. Keith</p>
                </div>
                <p id="comment-28599-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-28599">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-28650" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/74191"><img src="//gravatar.com/avatar/3504e95747047bad2ee874828a566214?d=https://hackaday.io/img/default-avatar.png&amp;r=x&amp;s=100" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/74191">aplavins</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-28650">2 months ago</a>

                <span id="comment-points-holder-28650" class="hide">
                    &bull; <span id="comment-points-28650">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-28650-content">
                    <p>I estimate the power loss to be 1.2% for the time that it takes to measure the OC voltage. Since measurement only takes about 200ms every 15s.&nbsp;There is a schematic on my github page.</p><p><a href="https://github.com/aplavins/Arduino-MPPT/blob/master/MPPT%20charge%20controller%20barebones.pdf">https://github.com/aplavins/Arduino-MPPT/blob/master/MPPT charge controller barebones.pdf</a></p><p>I used Deba's V-3&nbsp;page 5 and&nbsp;<a href="http://www.daycounter.com/Calculators/Switching-Converter-Calculator.phtml">http://www.daycounter.com/Calculators/Switching-Converter-Calculator.phtml</a>&nbsp;to calculate the required Inductance. Both sources gave me a value around 20uH. I knew that my peak current was about 26A so I chose 14awg enameled copper wire for winding. I went to the local electronics shop and found the biggest toroid&nbsp;ferrite core they had. The ferrite was green and this page&nbsp;<a href="http://www.badcaps.net/forum/showthread.php?t=19594">http://www.badcaps.net/forum/showthread.php?t=19594</a>&nbsp;toldme that green color ferrites are type 52. This page&nbsp;<a href="http://www.fair-rite.com/newfair/materials52.htm">http://www.fair-rite.com/newfair/materials52.htm</a>&nbsp;told me the permeability of that particular material.&nbsp;Then I used&nbsp;<a href="http://coil32.net/online-calculators/ferrite-torroid-calculator.html">http://coil32.net/online-calculators/ferrite-torroid-calculator.html</a>&nbsp;to find&nbsp;out the number of turns required for the inductance I wanted.&nbsp;</p><p>My result was 7.6 turns but I wanted to have more inductance than I needed so I just rounded up to 10.</p><p>Not very scientific but it seems to work.</p><p>To mount it to the PCB is pretty straightforward, just drill out the holes to fit the wire, remove the enamel coating and solder.</p><p><span></span></p>
                </div>
                <p id="comment-28650-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-28650">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-28692" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-28692">2 months ago</a>

                <span id="comment-points-holder-28692" class="hide">
                    &bull; <span id="comment-points-28692">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-28692-content">
                    <p>Thanks Adam, Some comments. Re power loss from calculating the MPP as 76% of Voc: In addition to the 1.2% you lose from turning off the panel for a short time every 15 seconds, you inevitably don't sit exactly on the Max Power Point of the panel. From the sample of grid connect panels on my spreadsheet, the quoted Vmpp ranges from about 79% to 84% of Voc. I tabulated the power difference between 76% of Voc times MPP current for these panels, and got numbers ranging from 90% up to 99% of MPP power. These numbers may be a little pessimistic since the MPP current will be marginally lower than the current at a slightly lower voltage. So your total power reduction is somewhere between 2% and 10%, probably dependent on a lot of variable factors, as well as panel characteristics.&nbsp;</p><p>In addition to losing a bit of power, by omitting the current measurement you also give up on a mechanism to prevent a too-large panel from generating more current than the internal components can take, and as a result creating a reliability problem. I regard this as the more serious issue. <br></p><p>Thanks for the look at the schematic. I am studying it, comments later maybe.</p><p>Regarding the inductor, I used this as my first exercise in the arithmetic on skin effect, expecting to find a significant problem. However I did not find any serious issue which is good news I think. This is what I found.&nbsp;</p><p>Although you did not give dimensions of the toroid, I guessed some numbers: 40 mm of OD, 25mm for ID, and 15 mm for height. I back-calculated the L100 value as 3500 microhenries per 100 turns, based on needing 7.6 turns for 20 microhenries. That means that with 10 turns you actually have 35 microhenries. According to my reading of your sofware code, you are using a switching frequency of 40 kHz, which means that to get a required inductance of 20 microhenries you allow the current ripple to be 45%. With the extra turns giving 35 microhenries, the ripple goes down to 26%, and the ripple current is 5.2 Amps p-p, which is 1.5A RMS.&nbsp;</p><p>Using the assumed toroid dimensions, I calculated your wire length as 455 mm (allowing for 30mm tails) which gives a DC resistance of 3.77 milliohms, giving a heating effect of 1.5 Watts or 0.6% of the total power - quite acceptable. <br></p><p>Next I calculated the skin depth for the AC component, which at 40 kHz in copper is 0.33 mm. (66.2 * f^-0.5)</p><p>This gives a wire diameter to skin depth ratio of 4.9, which in turn looking up the best reference I have on the subject, a paper by Bruce Carsten for Micrometals Inc, results in Rac / Rdc of 3.2. So that means your Rac = 3.77 * 3.2 = 12 milli Ohms. Multiplying that by the AC RMS current (this is a bit approximate because the AC current is triangular and has components at 3f, 5f etc.&nbsp; but they are pretty small) gives an AC power loss of 0.03 Watts - way down in the noise.&nbsp;</p><p>This may be a bit of a non-result, however I guess one thing I can conclude is that if you are experiencing excessing heating in your controller, it is not coming from the inductor.&nbsp;</p><p>I hope you find this interesting. Keith</p>
                </div>
                <p id="comment-28692-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-28692">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-28703" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/55735"><img src="https://cdn.hackaday.io/images/resize/100x100/6184171426011439165.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/55735">Debasish Dutta</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-28703">2 months ago</a>

                <span id="comment-points-holder-28703" class="hide">
                    &bull; <span id="comment-points-28703">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-28703-content">
                    <p>Hi Keith,</p><p>Thanks for the detailed analysis of adam's controller.Can you share a good&nbsp;reference on skin effect ?</p>
                </div>
                <p id="comment-28703-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-28703">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-28723" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-28723">2 months ago</a>

                <span id="comment-points-holder-28723" class="hide">
                    &bull; <span id="comment-points-28723">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-28723-content">
                    <p>The best reference I have found is by Bruce Carsten titled "CALCULATING THE HIGH FREQUENCY RESISTANCE OF SINGLE AND DOUBLE LAYER TOROIDAL WINDINGS"</p><p>The web address is <a href="http://www.micrometals.com/appnotes/appnotedownloads/chfsdltw.pdf">http://www.micrometals.com/appnotes/appnotedownloads/chfsdltw.pdf</a></p><p>There  are several other application notes on the Micrometals web site of interest, relating to practial winding of toroid cores, and the properties of the various materials used for core manufacture.&nbsp;</p><p>It turns out that the&nbsp;Yellow/White&nbsp;material No. 26 used in the original V3, and the Green material No. 52 used by Adam, are almost identical in behaviour.&nbsp;&nbsp;</p><p>I continue to study this subject.<br></p><p>Keith<br></p>
                </div>
                <p id="comment-28723-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-28723">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-28724" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-28724">2 months ago</a>

                <span id="comment-points-holder-28724" class="hide">
                    &bull; <span id="comment-points-28724">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-28724-content">
                    <p>The best reference I have found is by Bruce Carsten titled "CALCULATING THE HIGH FREQUENCY RESISTANCE OF SINGLE AND DOUBLE LAYER TOROIDAL WINDINGS"</p><p>The web address is <a href="http://www.micrometals.com/appnotes/appnotedownloads/chfsdltw.pdf">http://www.micrometals.com/appnotes/appnotedownloads/chfsdltw.pdf</a></p><p>There  are several other application notes on the Micrometals web site of interest, relating to practial winding of toroid cores, and the properties of the various materials used for core manufacture.&nbsp;</p><p>It turns out that the&nbsp;Yellow/White&nbsp;material No. 26 used in the original V3, and the Green material No. 52 used by Adam, are almost identical in behaviour.&nbsp;&nbsp;</p><p>I continue to study this subject.<br></p><p>Keith<br></p>
                </div>
                <p id="comment-28724-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-28724">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-28730" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/74191"><img src="//gravatar.com/avatar/3504e95747047bad2ee874828a566214?d=https://hackaday.io/img/default-avatar.png&amp;r=x&amp;s=100" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/74191">aplavins</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-28730">2 months ago</a>

                <span id="comment-points-holder-28730" class="hide">
                    &bull; <span id="comment-points-28730">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-28730-content">
                    <p>Wow great work Keith, it looks pretty sound to me. I don't have a scope so I can't measure the output ripple. I can say that the inductor never even gets warm. On a side note, my other charger that has a current sensor peaked at 251W out of a 245W panel using the same algorithm. Don't know of that's because of inaccurate measurements or if it was a real&nbsp;value. Hardware was different as well.</p>
                </div>
                <p id="comment-28730-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-28730">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-28838" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-28838">2 months ago</a>

                <span id="comment-points-holder-28838" class="hide">
                    &bull; <span id="comment-points-28838">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-28838-content">
                    <p>I am continuing to work on the inductor design, finally got to what I thought might be a good answer for the 40A controller, and did the sums to check flux density and core losses due to flux hysteresis. I found they were pretty bad in the inductor I had selected, so I need to go back over it and redesign.</p><p>Using the same method I thought I would check Adam's inductor, and found that my calculations show it to be heating up a lot as well.&nbsp;</p><p>What I got at 20 Amps and 40 kHz was 1.5 W of resistive loss and just under 3 W of magnetic hysteresis loss, adding to a total of nearly 4.5 W. If my method is correct, and if Adam's core is of the dimensions I have assumed, it should get to about 30 C above ambient. There are some significant "ifs" in there. The inductor should really feel quite hot, which is contrary to Adam's report.&nbsp;</p><p>Maybe worth a double check. Keith<br></p>
                </div>
                <p id="comment-28838-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-28838">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-27132" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/72716"><img src="//gravatar.com/avatar/5b3d4ac37e7c6d7619a1967b130a50d2?d=https://hackaday.io/img/default-avatar.png&amp;r=x&amp;s=100" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/72716">varun94171</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-27132">2 months ago</a>

                <span id="comment-points-holder-27132" class="hide">
                    &bull; <span id="comment-points-27132">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-27132-content">
                    <p>Hi Keith<br>I am working on a solar power system of 3Kw/48v.I am using a MPPT solar Charge controller of 48v/60A &amp; 12 solar panels of 250W each.The problem is that the specific gravity of the battery is not increasing ie the specific gravity is near to 1120 even when i remove the load from batteries.on a good sunny day i'll try to just charge my batteries to increase their specific gravity without putting any load but when i checked the batteries gravity in the evening it is same ie near to&nbsp;<a href="http://1120.So" target="_blank">http://1120.So</a> i want to ask that even on a good sunny day when ampere are very good near about 45 A then why the gravity will not increase just only the voltage increses to 58v of the 4 series&nbsp;<a href="http://batteries.so" target="_blank">http://batteries.so</a> help me to solve my problem....<br><br>Thanks in advance..........</p>
                </div>
                <p id="comment-27132-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-27132">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-28277" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/74191"><img src="//gravatar.com/avatar/3504e95747047bad2ee874828a566214?d=https://hackaday.io/img/default-avatar.png&amp;r=x&amp;s=100" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/74191">aplavins</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-28277">2 months ago</a>

                <span id="comment-points-holder-28277" class="hide">
                    &bull; <span id="comment-points-28277">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-28277-content">
                    <p>Is it just one battery or all of them?</p>
                </div>
                <p id="comment-28277-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-28277">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26692" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26692">3 months ago</a>

                <span id="comment-points-holder-26692" class="hide">
                    &bull; <span id="comment-points-26692">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26692-content">
                    <p>I have been studying the circuit and the component specs some more, as well as looking at the software code.&nbsp;</p><p>I remain puzzled as to why you experienced burn-out of Q3. I think that if there is a battery connected with 12 V, but no solar panels connected, then all of the MOSFETs will be OFF, simply because all of them will have their gates at zero (ground) voltage. This must be wrong (because you had the problem) but I can't work it out from the circuit. This is especially so with the VCC of the half bridge driver IR2104 fed from the solar panel voltage, which is zero in this case, so all its outputs must be zero also. I am sorry this is not very helpful.</p><p>I am now convinced that VCC of the driver IR2104 should be fed from the battery voltage (12 volts nominal) and not from the solar panels. There are several reasons for this: 1. it means the driver will always be working, and so&nbsp; you have positive control over the switching MOSFETs at all times. 2. the voltage from the solar panels has been specified as up to 25 volts, which is a bit more than needed to connect a standard 36 cell solar panel. The voltage doubler circuit that generates the Vb voltage for the driver will turn that into 50 volts, which in turn will put 25 volts onto the Source-Gate interface of both Q1 and Q2. The maximum rating of this interface is 20 volts, so either of these FETs may become unreliable with a high solar panel voltage of more than 20 volts. Using the battery for Vcc of the driver means that Q1 and Q2 both only have Source-Gate voltages equal to the battery, which is comfortably within the 10 - 20 Volt range of these MOSFETs. </p><p>When investigating the problem with burn-out of Q3, perhaps you could connect the battery via a suitable resistor (say 5 ohms, 20 Watts) which will let you experience something close to your original conditions, without risking losing another Q3. <br></p><p>I am still not convinced that there is a need for Q1 and its driver circuit. Removing it would slightly improve the efficiency of this converter, and simplify the construction. I think that in all the cases when Q1 is OFF, then Q2 is OFF as well. So Q1 is not actually doing anything useful.</p><p>I am also a bit concerned about the driver circuit for Q1, which is a bit complicated as follows.</p><p>Normally the PWM cycle runs at 20 microseconds, with adjustments made in 1% steps (this is my understanding from examining the software code, and may be wrong). The maximum PWM value for this mode is 99%. If the algorithm finds the next value would be 100%, instead it increases the cycle to 1000 microseconds and changes the PWM duty cycle to 1022/1023, which is very close to 99.9%.</p><p>At a 20 microsecond period and 99% duty cycle, we have "OFF" pulses of 200 nanoseconds (20 microseconds / 100).&nbsp;</p><p>At a 1000 microsecond period and 1022/1023 duty cycle, we have "OFF" pulses of 977 nanoseconds.&nbsp;</p><p>The driver IR2104 has some delays built in, partly as a means to guarantee that Q2 and Q3 are never both ON at the same time. Those delays have some tolerances built in. According to my reading of the specs, for an OFF pulse length on the IN pin of X microseconds, the LO pin gets a minimum of  X - 0.67 microseconds ON, and HO gets a maximum of X + 0.84 microseconds OFF. The "typical" figures are a bit less extreme but I think it is better to work with the guaranteed max and min values. This means that the minimum OFF pulse length on IN that will produce actual conduction in Q3 is 670 ns. This means that a PWM duty cycle of 96% is OK (pulse length 800 ns) but 97% and over may produce no conduction in Q3. No conduction in Q3 means that capacitor C7 does not get recharged and eventually the voltage at Vb will be insufficient to keep&nbsp;Q2 ON.&nbsp;</p><p>The PWM duty cycle of 99.9% at a period of 1000 microseconds is always OK, because we always have a guaranteed 300 ns of ON for Q3 (977 - 670 = 307 ns).<br></p><p>The situation for Q1 is even more problematic. As I understand the circuit, the pulses from HO are fed not only to the gate of Q2 but also through a diode D1 to the gate of Q1. Q1 has a Gate capacitance of about 1400 pF, which with the resistor R5 of 470 k produces a time constant of about 700 microseconds. Thus if the pulses from HO come every 20 microseconds, the gate of Q1 stays at about the peak HO voltage, since 20 microseconds is much less than 700 microseconds. However if we reduce the frequency of HO pulses to 1000 microseconds ("99.9%" duty cycle) there is some chance that the gate voltage of Q1 may fall below 10 Volts and its ON resistance will be increased, possibly with bad consequences. OR if we try to use 97%, 98% or 99% PWM, there may not be any pulses at all and within a few milliseconds Q1 will be fully OFF.&nbsp;</p><p>My favoured approach for Q1 is to remove it. However if you think it is needed, then putting a small capacitor (say 4700 pF) between its Gate and Drain would extend the time constant sufficiently to cover the 1000 microsecond cycle (subject to more accurate arithmetic).&nbsp;</p><p>To deal with the cases of 97% to 99% PWM, my favoured approach would be to use a longer cycle period, either the same 1000 microseconds as for 99.9%, or something in between - say 100 microseconds.&nbsp;</p><p>I think the main issue with the longer cycle time is that the inductor L1 may saturate when fed current for such a long time. However that in itself may not be a problem. It will certainly have enough energy stored to cover the short pulse when Q3 is ON, which is its main function.&nbsp;</p><p>I hope this is useful.<br></p>
                </div>
                <p id="comment-26692-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26692">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26694" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/55735"><img src="https://cdn.hackaday.io/images/resize/100x100/6184171426011439165.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/55735">Debasish Dutta</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26694">3 months ago</a>

                <span id="comment-points-holder-26694" class="hide">
                    &bull; <span id="comment-points-26694">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26694-content">
                    <p>Thank You So much for analysing in details.</p><p>My next task is to change the power supply of MOSFET driver IR2104 from solar to battery and removal of MOSFET Q1.</p>
                </div>
                <p id="comment-26694-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26694">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26878" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/55735"><img src="https://cdn.hackaday.io/images/resize/100x100/6184171426011439165.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/55735">Debasish Dutta</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26878">2 months ago</a>

                <span id="comment-points-holder-26878" class="hide">
                    &bull; <span id="comment-points-26878">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26878-content">
                    <p>Can I test without Q1,D1 and R5 ?I think there is no need of R5.</p>
                </div>
                <p id="comment-26878-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26878">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26883" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26883">2 months ago</a>

                <span id="comment-points-holder-26883" class="hide">
                    &bull; <span id="comment-points-26883">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26883-content">
                    <p>You are right there is no need for R5.<br></p><p>First., you have taken Q1, D1 and R5 out of the circuit. So the IP+ terminal of the ACS712 goes to the capacitor C1+ and to the Drain of Q2.&nbsp;</p><p>Next,&nbsp; VCC of the driver IR2104 now goes to the battery terminal JP2 #1, as well as to D2, C5 and C6,.</p><p>Also maybe the battery terminals feed the package buck converter that produces the 5V rail for the Arduino, LCD, and the linear regulator for 3.3V that feeds the WiFi module?.  &nbsp;</p><p>When powering up, I would have the osilloscope probe or a voltmeter on the Drain of Q3, which should immediately rise to the full battery voltage when you connect the battery. If it only rises a little bit, it means Q3 is ON, and you need to quickly disconnect the battery again and work out what is going on to cause Q3 to turn on.&nbsp;</p><p>Best wishes,</p><p>Keith<br></p>
                </div>
                <p id="comment-26883-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26883">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26495" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/55735"><img src="https://cdn.hackaday.io/images/resize/100x100/6184171426011439165.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/55735">Debasish Dutta</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26495">3 months ago</a>

                <span id="comment-points-holder-26495" class="hide">
                    &bull; <span id="comment-points-26495">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26495-content">
                    <p>Hi&nbsp;all ,</p><p>I am really sorry for not replying your&nbsp;comments from long time.</p><p>As my exam was on May ,I was busy in my exam preparation.But now exam is over,I will try to involve more in to this project.</p><p>I need some help.I am facing few problems in my controller.I want to solve one by one.</p><p>Problem -1 :</p><p>When I&nbsp;connect the battery to the controller,the connection between the battery and the switching ( buck converter ) become very hot and then MOSFET Q3 burn out.</p><p>I think it is due to shorting of MOSFET-Q3.Current flows from Battery -MOSFET Q3- GND which is unexpected.</p><p>Suggested solution by a friend :</p><p><a href="http://www.instructables.com/image/FBTYJBFI7KBCRM9">http://www.instructables.com/image/FBTYJBFI7KBCRM9</a></p><p>As per the above&nbsp;schematic link ,The blue arrows show the expected current&nbsp;flow&nbsp;in the buck circuit. The red arrow shows how current could flow in a&nbsp;faulty condition.</p><p>He suggested to put a diode at the output to prevent it.Though after using the diode the problem was&nbsp; rectified but&nbsp;it reduce the converter efficiency.I do not want this.</p><p>Please help me to rectify the problem.I request to go through the software as well as&nbsp;hardware for rectifying.</p><p>Thanks to all for your&nbsp;support.</p>
                </div>
                <p id="comment-26495-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26495">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26524" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26524">3 months ago</a>

                <span id="comment-points-holder-26524" class="hide">
                    &bull; <span id="comment-points-26524">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26524-content">
                    <p> Hi Debasish, Evidently the problem is that Q3 is ON when conditions are not suitable.&nbsp;</p><p>I got a report from my son who looked at&nbsp; your software code, and I understand that the initial state is for PWM period of 20 microseconds and a PWM duty cycle of 0. I believe that means Q2 is OFF and Q3 is ON continuously until a PWM adjustment is made.&nbsp;</p><p>The buck converter concept only works if the input voltage is at or greater than the battery voltage. So I think you need to turn off the PWM (or not turn it on) until the voltage coming from the panels is at least as big as the battery voltage. <br></p><p>The most obvious thing to me is that the software should initialise with the SD input of the driver enabled, so as to turn off both Q2 and Q3. You need to do a check on the respective voltages of battery and panels, and not start the PWM until VPanels &gt; VBattery. A slightly more complex approach would be a 3 state solution:</p><p>VPanels &lt; VBattery - everything OFF</p><p> VBattery &lt;= VPanels &lt;= VBattery + VOffset - Q2 ON, Q3 OFF. VOffset is maybe 1 volt. This equates to PWM=100%.&nbsp;</p><p>VPanels &gt;= VBattery + VOffset - Active PWM to generate extra current through Q3.&nbsp;</p><p>To make this work you need to be sure that the driver is working even with no PWM signal, at least sufficiently to turn off both Q2 and Q3. This is the same problem I raised in my Question 2 in my original posting.<br></p><p>I think you should not need a diode (or a Q1 either, for that matter).&nbsp;</p><p>Regards,, Keith<br></p>
                </div>
                <p id="comment-26524-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26524">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26528" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26528">3 months ago</a>

                <span id="comment-points-holder-26528" class="hide">
                    &bull; <span id="comment-points-26528">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26528-content">
                    <p>Hi, I think I don't understand a few things about the interactions between the half-bridge driver IR2104  and the circuit is it embedded in.&nbsp; One possibility is that you need to feed the battery voltage to the VCC connection of the IR2104. With the existing circuit, if the panel voltage is zero then the IR2104 has no VCC input. This may make its behaviour unpredictable (I don't see that situation covered in the spec sheet, which asks for VCC between 10 and 20 Volts for "proper operation".&nbsp;</p><p>Still thinking about this. You probably have a clearer understanding, and can check actual circuit behaviour.</p>
                </div>
                <p id="comment-26528-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26528">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26533" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26533">3 months ago</a>

                <span id="comment-points-holder-26533" class="hide">
                    &bull; <span id="comment-points-26533">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26533-content">
                    <p>Hi again. I found what I think is a relevant piece of literature on the IRF website at <a href="http://www.irf.com/technical-info/appnotes/an-978.pdf" target="_blank">http://www.irf.com/technical-info/appnotes/an-978.pdf</a>. This document has a section titled 10 HOW TO DRIVE A BUCK CONVERTER which  explains some more things.</p>
                </div>
                <p id="comment-26533-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26533">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26552" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/55735"><img src="https://cdn.hackaday.io/images/resize/100x100/6184171426011439165.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/55735">Debasish Dutta</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26552">3 months ago</a>

                <span id="comment-points-holder-26552" class="hide">
                    &bull; <span id="comment-points-26552">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26552-content">
                    <p>Thank You for your help.</p><p>Let me do some test and modification in software.Then I will inform you.</p>
                </div>
                <p id="comment-26552-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26552">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26408" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/71244"><img src="https://cdn.hackaday.io/images/resize/100x100/5267881432965756995.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/71244">Juan Perez Estrada</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26408">3 months ago</a>

                <span id="comment-points-holder-26408" class="hide">
                    &bull; <span id="comment-points-26408">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26408-content">
                    <p>Hi,</p><p>Is there anyone who has checked this MPPT solar charge controller vs a normal PWM with real data ? &nbsp;I have a litlle solar power system (60W) and I want to do it if I can get more power from my solar panel. I'm used to Arduino, but before buying all components, I want to know about any real data or comparation.</p><p>Best regards,</p>
                </div>
                <p id="comment-26408-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26408">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26402" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/12113"><img src="https://cdn.hackaday.io/images/resize/100x100/7074321430968465409.png" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/12113">Hacker404</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26402">3 months ago</a>

                <span id="comment-points-holder-26402" class="hide">
                    &bull; <span id="comment-points-26402">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26402-content">
                    <p>Battery specifications can be very broad and don't account for any features that may exist with a specific installation so going by the spec sheets is not always the best thing. The best way (most accurate) to measure the charge state of Pb HCl cells is to measure the specific gravity of the fluid with a hygrometer.&nbsp;</p>
                </div>
                <p id="comment-26402-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26402">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26233" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/34352"><img src="https://cdn.hackaday.io/images/resize/100x100/7654271414338178633.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/34352">Charles Prichard</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26233">3 months ago</a>

                <span id="comment-points-holder-26233" class="hide">
                    &bull; <span id="comment-points-26233">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26233-content">
                    <p>MPPT&nbsp;payoff may be realized with a large array.&nbsp;</p><p>Off-grid application presents changing&nbsp;battery states as a temporary load such as pumping water may&nbsp;retard&nbsp;the battery, setting it back to a state that requires recovery to accept charging. Recovery depends on extent that the battery supplies power. The controller must stimulate the battery, bring the charge rate back to a safe maximum level. Fifteen minutes recovery seems typical. To diminish the disruptive&nbsp;effect of a temporary load, the array can be increased. Large enough, and the battery will not be reset each&nbsp;time a large temporary load is switched ON.&nbsp;&nbsp;</p><p>Using&nbsp;weighting system&nbsp;to reflect approximate hourly input, it makes sense to turn panels to distribute input, reducing peak power, and maximizing the solar window to 130-140 degrees. Strategy is to maintain bulk PWM charge mode, allowing the pulse width to decrease as a function of having reached maximum charge threshold, and not simply to manage midday protection. I will try this with a 1200-watt array, shifting half the panels 30 degrees east, the other half, 30 degrees west. Midday, there will be a peak, but the array will tend to produce more power to the batteries than it would if the panels were aligned at south.</p><p>Do the weighted analysis, and consider how at midday the controller is often protecting the batteries from intense charging. It makes sense to distribute&nbsp;input to the PWM controller.</p>
                </div>
                <p id="comment-26233-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26233">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26342" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26342">3 months ago</a>

                <span id="comment-points-holder-26342" class="hide">
                    &bull; <span id="comment-points-26342">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26342-content">
                    <p>Hi Charles, Can you provide a reference describing the battery behaviour you are talking about? I would like to learn more about this.</p><p>I think the main payoffs for using MPPT charge controllers are a) getting the full power available from the solar panel(s); and b) enabling the use of panels designed for grid connect in an off-grid system. Grid connect panels are the main market these days, so economies of scale means the per-watt price is lower than panels designed for an off-grid system. </p><p>Your thesis that facing your panels East and West, rather than directly towards the equator, will even out the power flux through the day is correct, and this separation of the panels into two groups may well improve the usability of the power generated by avoiding&nbsp; making too much power for the battery to absorb in the middle of the day, and generating more power in the early and late parts of the day. This smoothing out does have a cost however. According to my modelling, panels positioned 30 degrees East and West as you propose will generate about 94% of the energy generated through the day by equator-facing panels (ie a loss of 6%). The payoff is a considerably flatter power curve through the day. The flattest possible power curve is obtained with a 60 degrees angle between the midday sun and the panels. At this angle the energy loss is 23 % (production of 77% compared to equator facing panels) but power production is virtually constant from sunrise to sunset. The curve does go up and down a bit but is between 0.4 and 0.5 of the potential peak power through the whole day. The two sets of panels can be run on a single MPPT controller with little if any loss of power, so long as they have the same number of cells in series in each set.<br></p>
                </div>
                <p id="comment-26342-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26342">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26361" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/34352"><img src="https://cdn.hackaday.io/images/resize/100x100/7654271414338178633.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/34352">Charles Prichard</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26361">3 months ago</a>

                <span id="comment-points-holder-26361" class="hide">
                    &bull; <span id="comment-points-26361">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26361-content">
                    <p>Midday. Batteries are charging, robust bubbling sound&nbsp;very obvious. Run a heavy load for a few minutes. Batteries become silent. Load switches off, and depending on input from the array, it will take awhile before one can detect robust bubbling. Batteries must return to the state where they&nbsp;can fully accept the charge. Recovery is not instantaneous.</p><p>This effect is seen when the load far exceeds input, as in running a pump with 700-watts midday input. Batteries must supply a large portion of the current&nbsp;to the load. The lead-acid&nbsp;battery changes its chemical&nbsp;state.</p>
                </div>
                <p id="comment-26361-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26361">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26362" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/34352"><img src="https://cdn.hackaday.io/images/resize/100x100/7654271414338178633.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/34352">Charles Prichard</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26362">3 months ago</a>

                <span id="comment-points-holder-26362" class="hide">
                    &bull; <span id="comment-points-26362">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26362-content">
                    <p>Yes! The modeling you are doing is interesting. I just guessed that trying 30 degrees offset would open the window, with benefits. Going to pulse-mode should preferably be a function of having reached a threshold through flat, even charging.</p>
                </div>
                <p id="comment-26362-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26362">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26397" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26397">3 months ago</a>

                <span id="comment-points-holder-26397" class="hide">
                    &bull; <span id="comment-points-26397">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26397-content">
                    <p>Hi Charles, My interpretation of what you are observing is as follows:&nbsp;</p><p>Midday and batteries bubbling. This bubbling is hydrolysis of the electrolyte, which is what happens when the battery is fully charged so the only place for the current to go is into breaking down water into Hydrogen and Oxygen.&nbsp;</p><p>Applying the load consumes all the current from the panels and also takes some from the batteries (as you said).&nbsp;</p><p>When the load switches off, the current from the panels goes into the batteries and starts to recharge them. It takes a while (as you observe), but after some time the batteries become fully charged and the hydrolysis of electrolyte starts again. </p><p>Assuming your batteries are of the Flooded type, there is no serious problem with running the batteries like this, but the hydrolysis does consume water, so it means that you need to top up the electrolyte more often than if you did not have so much hydrolysis. Solar charge controllers (including this MPPT project) usually have a "Float" state for the battery, where the charging voltage is limited to around 13.8 volts. This voltage is intended to be just enough to keep the battery fully charged, while avoiding hydrolysis.&nbsp;</p><p>Useful things you could do are a) check the voltage with a multimeter on your battery when it is bubbling vigorously; and b) check at what time in the day the bubbling starts (indicating how long it is taking for your panels to replace the charge that was used in the previous night). These bits of information will tell you if your current controller is working properly, and how much excess capacity you have in your panels.&nbsp;</p>
                </div>
                <p id="comment-26397-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26397">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26440" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/34352"><img src="https://cdn.hackaday.io/images/resize/100x100/7654271414338178633.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/34352">Charles Prichard</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26440">3 months ago</a>

                <span id="comment-points-holder-26440" class="hide">
                    &bull; <span id="comment-points-26440">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26440-content">
                    <p>Batteries are common deep cycle sold in local store for electric trolling motors (fishing.) The bubbling begins in morning with charging and lasts until input drops. Voltage is maintained by the MorningStar 60 AMP PWM controller. A bulk charge mode is used until 14.6 circa charge is detected. Pulsing then begins as it is useful to protect, as well as perform some equalization. Equalization can be programmed to happen automatically once a month, and I then have measured 15.15 volts, and more robust bubbling in my eight batteries configured for 24 volts (4 banks.)</p><p>Point here is that the bubbling is NOT indicative of a charged state. It occurs throughout the charge phase as plates/surfaces in the battery interact with the acid.</p><p>There is no loss of water consequent of a normal cycle. The batteries are sealed, though water could be checked infrequently.</p><p>I guessed, and used a conservative setting, mid-range as offered by the controller for various types of batteries, I have noticed imbalance between high and low side (24v bank)  batteries, and seek a way to equalize and maintain equilibrium (both batteries at 14.65 volts or whatever.)</p>
                </div>
                <p id="comment-26440-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26440">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26480" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26480">3 months ago</a>

                <span id="comment-points-holder-26480" class="hide">
                    &bull; <span id="comment-points-26480">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26480-content">
                    <p>Hi Charles, re bubbling, I can only suggest you have a look at some internet resources such as&nbsp;</p><p>Wikepedia&nbsp; <a href="http://en.wikipedia.org/wiki/Lead%E2%80%93acid_battery">http://en.wikipedia.org/wiki/Lead%E2%80%93acid_battery</a>&nbsp;</p><p>or Battery University&nbsp; <a href="http://batteryuniversity.com/learn/article/charging_the_lead_acid_battery">http://batteryuniversity.com/learn/article/charging_the_lead_acid_battery</a></p>
                </div>
                <p id="comment-26480-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26480">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26603" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/34352"><img src="https://cdn.hackaday.io/images/resize/100x100/7654271414338178633.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/34352">Charles Prichard</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26603">3 months ago</a>

                <span id="comment-points-holder-26603" class="hide">
                    &bull; <span id="comment-points-26603">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26603-content">
                    <p>Batteries bubble while charging. Result is a differential between two Pb plates.&nbsp;</p>
                </div>
                <p id="comment-26603-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26603">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26149" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/8069"><img src="https://cdn.hackaday.io/images/resize/100x100/6124601399474000153.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/8069">mooneyj</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26149">3 months ago</a>

                <span id="comment-points-holder-26149" class="hide">
                    &bull; <span id="comment-points-26149">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26149-content">
                    <p>Thanks for the project, so useful! Could you speculate on the steps required to adapt this design for 50V solar panels? I have a bunch of 'broken' 200W panels which just needed the diodes between the cells replacing. I'd love to build a 50V version of this.</p>
                </div>
                <p id="comment-26149-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26149">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26185" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26185">3 months ago</a>

                <span id="comment-points-holder-26185" class="hide">
                    &bull; <span id="comment-points-26185">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26185-content">
                    <p>Hi Mooneyj, I think the first thing you need to do is assess&nbsp; your requirements at a system level. Such as how many panels you want to connect, and whether a 12 V battery is the best choice. Typically panels designed for battery systems (off grid) have 36 solar cells giving a MPP voltage of about 18V, while panels designed for grid connect have 60 solar cells giving a MPP voltage of about 30 V. With an MPPT controller either type of panel can be used, and multiple panels can be run in series or parallel. Depending on how many panels you want to use, the power flow could get quite large and so the voltages and currents may be much greater. The extent of modifications will depend on your power requirement, number of panels and their connection, and battery type.&nbsp;</p>
                </div>
                <p id="comment-26185-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26185">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26204" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/8069"><img src="https://cdn.hackaday.io/images/resize/100x100/6124601399474000153.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/8069">mooneyj</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26204">3 months ago</a>

                <span id="comment-points-holder-26204" class="hide">
                    &bull; <span id="comment-points-26204">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26204-content">
                    <p>Hi Keith, thanks for your input. I have 7 panels, so 1.4kW total max output. I'm thinking parallel&nbsp;setup is best; 50V 28A.  I imagine a set of buck converters in parallel, controlled by a single arduino should work. Ideally i'd like to start with just 1-2 panels, with the ability to expand the system later on. Is this feasible? Also LiPo battery would be ideal, any advice on integrating a lipo charge controller?</p>
                </div>
                <p id="comment-26204-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26204">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26220" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26220">3 months ago</a>

                <span id="comment-points-holder-26220" class="hide">
                    &bull; <span id="comment-points-26220">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26220-content">
                    <p>Hi Mooneyj, There are lots of issues buried in here. I don't know, but I suspect that 7&nbsp; converters, one per panel, controlled by a single Arduino, is possible but is not the cheapest solution. It may give you a gradual development path that suits your needs. However when you dig into the design details, you may find that an increased current rating so each converter can handle 2 or 3 or 4 panels, is not much more difficult, which would cut down on some of the other complexities.&nbsp;&nbsp;</p><p>I remain dubious about your panels producing an MPP of 50 Volts and 4 amps. At least we need to know the open circuit voltage provided by the manufacturer, or measured in bright sunlight. The MOSFETs in the reference design have a breakdown voltage of 55 volts, which is likely to be inadequate if your panels produce 50 volts at MPP. Another thing you can do is count the number of cells in one of your panels. Typical solar cells at MPP produce 0.5 volts per cell, implying your panels have 100 cells - a design I have not come across.</p><p>There are a number of relatively straightforward changes that go with the higher input voltage and higher panel power capability, including: voltage rating of key components; current ratings of key components; new scale factors in the voltage and current measuring devices; new capacitor and inductor values in the current pathway. These are all straightforward arithmetic exercises.&nbsp;</p><p>As part of the analysis of these changes, I think it would be worthwhile to do some sensitivity analysis on converter efficiency versus cost of parts. There might be some good pay-offs in this space. <br></p><p>The idea of a single Arduino controlling multiple converters raises several issues. There are practical ones like the number of interfaces required (the reference converter uses 3 analogue inputs and 7 digital outputs). No doubt expansion is possible if you want to go down that road. Running one panel per converter does mean you can get performance data for each panel, which may have some interest especially if there are site issues such as shading and&nbsp;panel orientation that you want to explore. However running several panels in parallel on a higher capacity converter is probably cheaper to build and will usually give similar performance. My expectation is that there is no issue with processing power of the Arduino to run multiple MPPT algorithms and PWM outputs simultaneously.</p><p>I have no experience with Lithium batteries (other than as a user of cordless drills) so I can't help you there. If you use lead acid batteries, there is a lot of experience around on good charging algorithms. Despite this, the cycle lifetime of lead acid batteries is always disappointing - no more than 800 charge-discharge cycles at a 30% depth of discharge, which is less than 3 years if you are cycling them to this depth every day. LiFePO batteries are supposed to be much better (like, 5000 cycles). NiFe batteries will also&nbsp;provide many many cycles (like, more than 10,000) which equates to a more or less indefinite life.  </p><p>Please let me know what you think. Keith<br></p>
                </div>
                <p id="comment-26220-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26220">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26146" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26146">3 months ago</a>

                <span id="comment-points-holder-26146" class="hide">
                    &bull; <span id="comment-points-26146">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26146-content">
                    <p>Hi. Great project, and a good tutorial and documentation chain explaining how the design was done. This project has impelled me to join Hackaday and spend quite a few hours studying this project.   I have a few questions.</p><p>Q1. This&nbsp;goes to the point made a month or so ago by brucedurant, about how the solar panel sees the controller. The project instructables (as far as I can find) give no information about the sizing of capacitor C1. This is the critical component that addresses the brucedurant question. Look at the solar panel characteristic graph,&nbsp; which for a given illumination level shows a specific current/voltage curve, and consequent power/voltage curve. With Q2 OFF and Q3 ON, the current from the panel is just going into C1, and the panel voltage is tracking to the right (increasing).&nbsp; With Q2 ON and Q3 OFF, the current from the panel, and also from C1,  is going through Q2 into the inductor L and C2 and thence to charge the battery. The panel voltage is tracking to the left (decreasing). So over a full 20 microsecond cycle, there is a ripple in voltage, current and power generated by the panel. The size of that ripple is a function of C1. There are a number of factors at play here, but the extent to which the ripple takes the average operating point away from the true single Maximum Power Point is one factor in the "efficiency" of the controller.&nbsp; The bottom line for this question is that it would be nice to see the calculations that led to the selection of C1 = 100 uF.&nbsp;</p><p>Q2. I have been having trouble understanding the need for Q1, or the blocking diode mentioned as being used in a previous design. According to the application notes for the MOSFET driver (IR2104) the Arduino can shut off both MOSFETs using SD, which will prevent any reverse current flow when it is dark.&nbsp;</p><p>Q3. The converter uses a buck converter to generate the 5V power rail for most of the logic components, including the Arduino board. The component list just shows it as "buck converter" with a rating of 3A, but no part number. It is not shown on the overall schema diagram. I would like to know its details.&nbsp;</p><p>Q4. The sizing of L1 and C2, and the clocking frequency of 50 kHz, have been driven by what seems to me are quite reasonable but arbitrary assumptions. The target of this controller is to extract the maximum possible amount of power from our solar panel, taking into account the cost of the controller. It would be nice if the selection of components was directly related to that tension (output vs cost). In the typical buck converter design, the objective is to meet specific output power quality parameters (like ripple and voltage accuracy). In this case of the solar charge controller, it is different. I am not aware of lead acid batteries being fussy about ripple current in charging (maybe they are, this might need some research). <br></p><p>I am sorry if these questions/issues seem a bit picky. I found this project very interesting (I can expand on why another time) and I think the author deserves a lot of credit for it.&nbsp;</p>
                </div>
                <p id="comment-26146-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26146">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-25116" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/7528"><img src="https://cdn.hackaday.io/images/resize/100x100/1014441399138610920.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/7528">mr.jb.swe</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-25116">3 months ago</a>

                <span id="comment-points-holder-25116" class="hide">
                    &bull; <span id="comment-points-25116">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-25116-content">
                    <p>Wham Bam - powerpoint regulator</p><p><a href="http://www.fieldlines.com/index.php?topic=146685.0">http://www.fieldlines.com/index.php?topic=146685.0</a></p>
                </div>
                <p id="comment-25116-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-25116">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-23702" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/65325"><img src="//gravatar.com/avatar/b42cad72c77be64f4ea5604cc144a7aa?d=https://hackaday.io/img/default-avatar.png&amp;r=x&amp;s=100" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/65325">brucedurant</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-23702">4 months ago</a>

                <span id="comment-points-holder-23702" class="hide">
                    &bull; <span id="comment-points-23702">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-23702-content">
                    <p>The thing I'm trying to get my head round is how does this take maximum power from the panel. Essentially to get maximum power out we need to present the panel with an impedance that matches its MPP. The circuit presents two separate states to the PV firstly with the Q2 On you are sending energy to the L1/C2 combination/load/battery. This represents one impedance across the cells and you can measure the current &amp; voltage flowing. Now when Q2 is OFF if the panel voltage is above that of C1 then C1 will charge or if it is lower then C1 will try to discharge through the cells. Either way that is a different impedance from the ON condition. The real problem I have with this is that the cells are not capable of averaging these two conditions out they are solid state devices that will instantaneously see either the ON or the OFF impedance not the average. I would have thought that you need some sort of carefully designed low pass 'T' network including another 2 inductors either side of C1 between the current sensor and the Q2.</p>
                </div>
                <p id="comment-23702-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-23702">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-26416" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/70480"><img src="https://cdn.hackaday.io/images/resize/100x100/1880131432601957852.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/70480">keith.hungerford</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-26416">3 months ago</a>

                <span id="comment-points-holder-26416" class="hide">
                    &bull; <span id="comment-points-26416">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-26416-content">
                    <p>Hi brucedurant, You may not have seen my previous post where I raised the question of the sizing of capacitor C1. I have now done the sums and the situation is fairly clear, and I think it answers your question. The sequence is as follows:</p><p>I want to assume the controller is in a quasi-stable position with a mean panel voltage of 18 volts and PWM timing of 14 microseconds where Q2 is ON, and 6 microseconds where Q2 is OFF. The mean panel current is 5.55 Amps (so power is 18 * 5.55 = 99.9 Watts). The mean current through L1 is 5.55 * 20/14 = 7.93 Amps at a voltage of 12 Volts, giving a power into the battery/load of 95.14 Watts. The difference between the panel power and the battery/load power is a few percent which is for losses in the controller. I have no basis for this specific figure, but it seems reasonable and is consistent with other DC-DC converters of this type. It also makes some of the values whole numbers which makes the arithmetic a bit easier to follow - see below.</p><p>When Q2 is OFF, the panel is generating current which flows into C1. At the instant Q2 switches OFF the panel voltage will be 17.85 volts. Over the following 6 microseconds the panel voltage rises a total of 0.3 volts, ending at 18.15 volts. If you put 5.55 amps into a 110 microfarad capacitor (C1, C5 and C6 in parallel) for 6 microseconds you get V=It/C = 5.55 * 6 / 110 &nbsp; = 0.3 volts.&nbsp;</p><p>Now Q2 switches ON, and for the next 14 microseconds the current through L1 (which is 7.93 Amps) comes from a combination of 5.55 Amps from the panel and 2.38 Amps from C1,C5, C6. Again, we have V = It/C = 2.38 *14/110 = 0.3 volts. So the panel voltage ends up back at 17.85 Volts, ready for the next cycle to start.&nbsp;</p><p>The panel sees a ripple voltage with a peak to peak value of 0.3 volts around its maximum power point of 18 Volts. There will be a corresponding variation in the panel current, but it is quite small, probably of the order of 40 milliamps either side of the mean of 5.55 Amps. Use of the average figure has no material affect on the above calculation. </p><p>Does this clarify how this works for you?<br></p>
                </div>
                <p id="comment-26416-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-26416">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-20303" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/56357"><img src="//gravatar.com/avatar/c485b916ed95d491b5010f1fd051493d?d=https://hackaday.io/img/default-avatar.png&amp;r=x&amp;s=100" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/56357">gorky</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-20303">5 months ago</a>

                <span id="comment-points-holder-20303" class="hide">
                    &bull; <span id="comment-points-20303">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-20303-content">
                    <p>Just what I was researching around. Great project. Thanks</p>
                </div>
                <p id="comment-20303-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-20303">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-20306" data-level="2" class="discussions-item" style="margin-left: 25px;">
        <div class="discussions-item-image">

            <a href="/hacker/55735"><img src="https://cdn.hackaday.io/images/resize/100x100/6184171426011439165.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/55735">Debasish Dutta</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-20306">5 months ago</a>

                <span id="comment-points-holder-20306" class="hide">
                    &bull; <span id="comment-points-20306">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-20306-content">
                    <p>My pleasure :)</p>
                </div>
                <p id="comment-20306-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-20306">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    

    
    

    <div id="j-discussion-20290" data-level="1" class="discussions-item" style="margin-left: 0px;">
        <div class="discussions-item-image">

            <a href="/hacker/3459"><img src="https://cdn.hackaday.io/images/resize/100x100/9294361423226559372.jpg" alt=""></a>


            
        </div>
        <div class="discussions-item-body">
            <small class="authorship">

                <a href="/hacker/3459">davedarko</a>

                wrote <a class="gray-link" href="/project/4613-arduino-mppt-solar-charge-controller/discussion-20290">5 months ago</a>

                <span id="comment-points-holder-20290" class="hide">
                    &bull; <span id="comment-points-20290">
                              point
                    </span>
                </span>

            </small>
            <div>
                <div id="comment-20290-content">
                    <p>awesome documentation, &nbsp;thank you for sharing!</p>
                </div>
                <p id="comment-20290-editor" class="hide"></p>
            </div>
            <p>
                <span class="delete-options" id="actions-20290">
                    
                    
                </span>
                <span class="delete-confirm hide"><span class="delete-q">Are you sure?</span> <a href="#" class="delete-yes"><small>[yes]</small></a> / <a href="#" class="delete-no"><small>[no]</small></a></span>
            </p>
        </div>
    </div>

    



<div class="pagination">

    
    <input type="hidden" name="pagination" value="{&#34;page&#34;:1,&#34;total&#34;:22,&#34;limit&#34;:20,&#34;pages&#34;:2,&#34;more&#34;:true,&#34;prev&#34;:null,&#34;next&#34;:2}"/>

    
    
    <a href="?page=2#discussion-list" class="grey-gold-button next-button show">Next</a>
    
</div>


<script type="text/javascript">

    var pageIndex = 0;


</script>
    </div>

    

</div>



        </div>

    </div>

    
        <div class="container">
            <div class="section-recommendations">
                <h2>Similar projects</h2>
                
                    

<div class="project-item   ">

    
        <ul class="submissions-icons">
            
                
                    <li>
                        <a href="/submissions/prize2014/list" class="submission-icon submission-icon-1">
                            Official Hackaday Prize Entry
                        </a>
                    </li>
                
            
        </ul>
    

    <a href="/project/1981-solar-energy-generator" class="item-link">
        <div title="Solar Energy Generator by Nathaniel VerLee" class="project-item-cover"
                
             style="background-image:url(https://cdn.hackaday.io/images/resize/600x600/519691415125252079.JPG)"
                
                >

        </div>

        
                <div class="project-item-stats">
                    
                    
                        <span class="icon-view-count" title="View Count">13.8k</span>
                    
                    <span class="icon-comment-with-hover" title="Comments">9</span>
                    <span class="icon-view" title="Followers">306</span>
                    
                        <span class="icon-skull" title="Skulls">99</span>
                    
                </div>
         

        <div class="project-item-title hasBadge">
            A solar energy system up to 500W in power for use with lithium batteries. 
        </div>
    </a>
    <div class="project-item-headline">
        <span class="project-owner hide">Project Owner</span>
        <span class="project-owner hide">Contributor</span>
        <h3><a href="/project/1981-solar-energy-generator" title="Solar Energy Generator">Solar Energy Generator</a></h3>
        <p>by <a href="/hacker/16886">Nathaniel VerLee</a></p>
    </div>
</div>
                
                    

<div class="project-item m-last-child  ">

    
        <ul class="submissions-icons">
            
                
            
                
                    <li>
                        <a href="/submissions/prize2015/list" class="submission-icon submission-icon-5">
                            The 2015 Hackaday Prize
                        </a>
                    </li>
                
            
        </ul>
    

    <a href="/project/2145-smps-replacement-for-7805" class="item-link">
        <div title="SMPS replacement for 7805 by K.C. Lee" class="project-item-cover"
                
             style="background-image:url(https://cdn.hackaday.io/images/resize/600x600/1670571406403965694.png)"
                
                >

        </div>

        
                <div class="project-item-stats">
                    
                    
                        <span class="icon-view-count" title="View Count">7.7k</span>
                    
                    <span class="icon-comment-with-hover" title="Comments">16</span>
                    <span class="icon-view" title="Followers">89</span>
                    
                        <span class="icon-skull" title="Skulls">41</span>
                    
                </div>
         

        <div class="project-item-title hasBadge">
            This is a collection of switch mode power supply modules designs that are efficient drop-in replacement for the old 78XX series.
        </div>
    </a>
    <div class="project-item-headline">
        <span class="project-owner hide">Project Owner</span>
        <span class="project-owner hide">Contributor</span>
        <h3><a href="/project/2145-smps-replacement-for-7805" title="SMPS replacement for 7805">SMPS replacement for 7805</a></h3>
        <p>by <a href="/hacker/10708">K.C. Lee</a></p>
    </div>
</div>
                
                    

<div class="project-item  b-last-child ">

    
        <ul class="submissions-icons">
            
                
                    <li>
                        <a href="/submissions/prize2014/list" class="submission-icon submission-icon-1">
                            Official Hackaday Prize Entry
                        </a>
                    </li>
                
            
        </ul>
    

    <a href="/project/1936-1charger" class="item-link">
        <div title="1Charger by mr.jb.swe" class="project-item-cover"
                
             style="background-image:url(https://cdn.hackaday.io/images/resize/600x600/3548241410792480272.jpg)"
                
                >

        </div>

        
                <div class="project-item-stats">
                    
                    
                        <span class="icon-view-count" title="View Count">14.1k</span>
                    
                    <span class="icon-comment-with-hover" title="Comments">8</span>
                    <span class="icon-view" title="Followers">112</span>
                    
                        <span class="icon-skull" title="Skulls">41</span>
                    
                </div>
         

        <div class="project-item-title hasBadge">
            OneCharger to rule them all; solar-panel, TEG, dynamo...
        </div>
    </a>
    <div class="project-item-headline">
        <span class="project-owner hide">Project Owner</span>
        <span class="project-owner hide">Contributor</span>
        <h3><a href="/project/1936-1charger" title="1Charger">1Charger</a></h3>
        <p>by <a href="/hacker/7528">mr.jb.swe</a></p>
    </div>
</div>
                
            </div>

        </div>
    

    










<div class="footer" id="footer">
  <a href="#header" class="back-to-top" onClick="CT(this, 'Footer', 'GoingUp');">^ Going up? ^</a>
    <div class="container">
        <p><a href="http://hackaday.com/about/">About Us</a> <a href="mailto:projects-contact@hackaday.com">Contact Us</a> <a href="/project/37">Give Feedback</a>&copy; 2015 Hackaday <a href="/tos">Terms of Use</a> <a href="/privacy-policy">Privacy Policy</a></p>
        <a href="/" class="had-skull"  onClick="CT(this, 'Footer', 'Home' ); return false;">Hackaday.io</a>
    </div>
</div>

<script>

    var csrftoken = '8f9QZ9KD-qQgg2YhrZ1DgA4tdiJ0p60xw0o4';

</script>

    <script type="text/javascript">

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47229708-1', 'auto');

    var dimensionValue = 'nonregistered';
    ga('set', 'dimension1', dimensionValue);
    ga('require', 'displayfeatures');

    ga('send', 'pageview');

    </script>

<img src="//analytics.supplyframe.com/trackingservlet/impression?action=pageImpression&amp;zone=HIO_project&amp;extra=logged%3Dfalse%7ChaveAccountCookie%3D0%7C&amp;ab=undefined" class="sf-impression" />
    <div class="j-modal-confirmation modal-background"></div>
<div class="j-modal-confirmation modal-content-holder">
    <p class="align-center" id="modal-message"></p>
    <p class="align-center"><a class="medium-button gold-gold-button delete-project-button" id="modal-yes" href="">Yes, delete it</a> <a class="medium-button grey-gold-button cancel-button" id="modal-cancel">Cancel</a> </p>
</div>

    
    
    
    
    
    
    
    
    
    

    <script src="//cdn.hackaday.io/build/h%2FydgsYIeDTf7pqgYQEKK8Ngblw0IkZCDqfJ9S2tk7zsBoxIHt5iOd49Qp%2BF4vdxEuRj%2BGpGDLbX4aGOQGmbjaOxUZvklg4ReFk68R95OQshFrGKebvogKGQOiB5Hi1xym9KC54c9Ps0WpzuNydLk4B%2FbKi91KhV40Uxhl38XXb1IVAxAI8iW%2BoQUPCFkHVWZxD0B%2BMZ%2BuEXJTlWuBmopNMxTHRK5yleITPZODT6evYhvPcTNHjcVmLti9HxMVov4N%2FG0Vb08G3dKHr8dVQWzXej5t18RehizqZ8wIVJ7qCSmA5v7VaFjCQENYTT0gaQoyhjrODHsQk5JUVvz7t44Dtk%2B11xxmipO4Y%2B9cBwn1IdfK1bYjGht%2Bf1yWZu2SwuQOo6kGY9xwArhHVwpedkUh5kLaSLkPbgFU2aMPMYlr%2FkGi5SGh0159v8zUCbh%2Fx4qqGgiq8xue1QDxwAtojDbMufEMnPeES%2BXUvICUCqPFVF9PsrubQsdtbQAJZsDggl-0.48.6.js"></script>

    <style>
        .mediumInsert-buttons {
            display: none !important;
        }
    </style>

    <div id="submission-popup-back"></div>
    <div id="submission-popup"></div>

    <div id="modal-report-back" class="modal-background"></div>
    <div id="modal-report" class="modal-content-holder container">
        <a href="javascript:void(0);" class="modal-close"></a>
        <form action="/report/project" class="j-modal-form">
            <h2>Report project as inappropriate</h2>

            <p class="intro-text">
                You are about to report the project "<b>ARDUINO MPPT SOLAR CHARGE CONTROLLER</b>", please tell us the reason.
            </p>

            <textarea name="comment" class="j-report-comment" placeholder="Why do you report the project as inappropriate"></textarea>

            <input type="hidden" name="_csrf" value="8f9QZ9KD-qQgg2YhrZ1DgA4tdiJ0p60xw0o4" />
            <input type="hidden" name="projectId" value="4613" />
            <div class="modal-footer">
                <input type="submit" value="Report" class="gold-gold-button"/>
            </div>
            <div class='j-modal-form-message'></div>
        </form>
        <div class='j-modal-message hide'></div>
    </div>



    <div id="modal-contributor-apply-back" class="modal-background"></div>
    <div id="modal-contributor-apply" class="modal-content-holder container">
        <a href="javascript:void(0);" class="modal-close"></a>
        <form id="contributor-apply-form">
            <h2>Send message</h2>

            <textarea name="message" class="j-report-comment">
Hello,

I really like your project and I think I have skills to help you.
            </textarea>
            <p class="application-success">Your application has been submitted.</p>
            <input type="hidden" name="_csrf" value="8f9QZ9KD-qQgg2YhrZ1DgA4tdiJ0p60xw0o4" />
            <input type="hidden" name="projectId" value="4613" />

            <div class="modal-footer">
                <input type="submit" value="Send" class="gold-gold-button"/>
            </div>
        </form>

    </div>


    <div id="modal-contributor-remove-back" class="modal-background"></div>
    <div id="modal-contributor-remove" class="modal-content-holder container">
        <a href="javascript:void(0);" class="modal-close"></a>
        <form id="contributor-remove-form">
            <h2>Remove Contributor</h2>
            <p>
                Are you sure you want to remove yourself as a contributor for this project?
            </p>
            <p>Project owner will be notified upon removal.</p>
            <input type="hidden" name="_csrf" value="8f9QZ9KD-qQgg2YhrZ1DgA4tdiJ0p60xw0o4" />
            <input type="hidden" name="projectId" value="4613" />
            <input type="hidden" name="remove_contributor_id" id="remove_contributor_id"/>

            <div class="modal-footer">
                <input type="submit" value="Remove" class="gold-gold-button"/>
                <input value="Nevermind" class="gold-gold-button"/>
            </div>
        </form>
    </div>


    <script>
        HIO.projectId = 4613;
    </script>

  </body>
</html>
