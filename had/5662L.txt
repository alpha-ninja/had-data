<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en" ng-app="buildlogApp"> <!--<![endif]-->
<head>
    
    <title>Project logs &bull; HouseRemote &bull; Hackaday.io</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" href="//cdn.hackaday.io/css/style.css?version=0.48.6" />
    <script type="text/javascript" src="//use.typekit.net/ymb0lgk.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
</head>
<body class="logs">

    <!--
############################################################################################
############################################################################################
############################################################################################
#####################Kt;tL#######################################Kti,E######################
#######################;   .###################################G    E#######################
#######################K    f##################################    ;########################
########################Wj   E###############################K:  .W#########################
##########################.  :E##############################:  .L##########################
#########################D    f##############################.   .##########################
########################,     ;##############################     :E#######K################
################f######K      ,##############################      ,######Lt################
################  W###W       i##############################       t####j t################
################:  E#L.        f###########################L.        f#Ki .E################
################j  ;E.          j##########################.         .G;  i#################
#################L               i#######################K                ##################
#################W                E#####################K;               ;##################
###################:               .###################D               :f###################
#####################DLfGD           G####WEEEEKW####W           ;GffGK#####################
##########################i         iD##Kfi    :jKW##D          iE##########################
###########################W      ,G##f            jE#E;       j############################
############################L     D##D              ,##K       W############################
#############################D:  G#W                  K#E,   G##############################
###############################;i#L                    j## ,E###############################
###############################KK#.                     ##iE################################
#################################j                      ;K##################################
################################W                        ,##################################
################################E                         ##################################
###############################Ki                         D#################################
###############################E.                         L#################################
###############################f    iD##W;       D###D    :#################################
###############################i   i######K     K#####K;   #################################
###############################;  .E#######     #######D   #################################
###############################;  L########     ########   #################################
###############################i  G#######K     K#######   #################################
###############################j  L#####E,       fE#####   #################################
###############################D  .E##j            .t##E  ;#################################
###############################E:  ;##.              #Wt  j#################################
################################G   ;t      tWi      t    E#################################
#############################KL##           K#K;          #K:K##############################
#############################i ##:          ###t         j#f ;K#############################
############################:  G#K          #E#L        L##    D############################
###########################D   ;W#:         #;#L        W#K    .############################
#####################KKEKK      :##L        ; ..      :D##.      fKEEK######################
###################t.            ;##G:               ,##E,             tD###################
##################G               E##E               i##;               :###################
#################D                W##W    iL    E.    ###D                ##################
################W,               G###W    tG    K.    ####:               K#################
################;  LW;         ,E#####:  ;W#    #G   f#####;         ;KG  :K################
################  D###E       ;########WW####WW####WW#######W       :####: j################
################ ,#####:      ;##############################       G####E i################
################K#######.     ;##############################      L######WG################
########################f     i##############################     j#########################
#########################W   .D##############################.   i##########################
#########################E   G###############################D   ,##########################
########################G:   #################################j   G#########################
#######################f    K##################################j    W#######################
#####################Kt :iE#####################################KL:  K######################
############################################################################################
############################################################################################
############################################################################################
-->

<div class="header" id="header">
    <div class="container">
        <h1 class="logo">
            <a href="/" title="Hackaday.io Home" class="home" onclick="CT(this, 'Menu', 'Home'); return false;"></a>
            <a href="/" title="Hackaday.io Home" class="brand" onclick="CT(this, 'Menu', 'Home'); return false;">Hack a Day</a>
        </h1>

        <a href="javascript:void(0);" class="responsive-menu">Menu</a>

        <ul class="nav" role="navigation">
            <li><a href="/projects" class="">Projects</a></li>
            <li><a href="/lists" class="">Lists</a></li>
            <li><a href="/stack" class="">Stack</a></li>
            <li class="dropdown more-nav j-more-open">
                <a href="javascript:void(0)" class="dropdown-link icon-dropdown">More</a>
                <ul role="menu" class="dropdown-menu more-menu" id="j-more">
                    <li><a href="http://hackaday.com/blog/" target="_blank">Blog</a></li>
                    <li><a href="/events">Events</a></li>
                    <li><a href="/hackerspaces">Hackerspaces</a></li>
                    <li><a href="/hackers">Profiles</a></li>
                    <li><a href="/contests">Contests</a></li>
                    <li><a href="/prize" target="_blank">The Hackaday Prize</a></li>
                    <li><a href="/submissions/prize2015/list">2015 Prize Entries</a></li>
                </ul>
            </li>
            <li class="menu-last-child">
                <div class="search-holder show">
                    <form id="search-form" action="/search" onsubmit="return submitSearch();" method="GET">
                        <input type="text" placeholder="Search" name="term" class="input-search j-add-search" id="j-add-search" value="" autocomplete="off" pattern=".{3,}" required title="3 characters minimum" />
                        <input type="submit" class="search-button" />
                    </form>
                </div>
            </li>
        </ul>

        

            <ul class="nav pull-right" role="navigation">
                <li><a href="/signup" class="grey-white-button become-member">Sign up</a></li>
                <li><a href="/signin?returnUrl=%2Fproject%2F5662%2Flogs">Sign in</a></li>
            </ul>

        
    </div>
</div>

<div id="topMessage" class="alert"><span class="j-top-content"></span><a href="javascript:void(0);" class="alert-close j-top-message-close">Close</a></div>




    <div class="headline">
        <div class="container">
            <h2><a href="/project/5662-houseremote">HouseRemote</a></h2>
            <p class="description-title"> Project logs</p>
            <p class="description-summary">Remotely monitor and control appliances from anywhere!</p>
            <div class="description-metainfo">
                
                    <span>created by <a href="/hacker/14268-nickl" title="Visit Profile">Nickl</a><span>&bull;</span>
                
                3 months ago<span>&bull;</span><a href="/project/5662#discussion-list" title="See Comments">0 Comments</a></span>
            </div>
        </div>
    </div>

    <div class="container post-content">
        <div class="section-buildsort">
            <span class="pull-left">
                <a href="/project/5662-houseremote">&#171; Back to project details</a>
            </span>
            <span class="sort-holder pull-right">
                <label for="sort-by">Sort by:</label>
                <select class="sort" id="sort-by">
                    <option value="/project/5662/logs/sort/newest">Newest</option>
                    <option value="/project/5662/logs/sort/oldest" selected="selected">Oldest</option>
                </select>
            </span>
        </div>
        <div class="section section-buildlogs last">
            

                <ul class="buillogs-list">
                    
                        <li>
                            <h2><a href="/project/5662/log/17519-working-on-making-things-stable">Working on making things stable</a></h2>
                            <small class="authorship">3 months ago  &bull;
                                <a class="gray-link" href="/project/5662/log/17519#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-17519"><p>My current task is getting the darn thing stable, in some enviroments it works perfectly; in others, not so much.</p><p>Environment 1:<br>OS CentOS 6.6 (running as a VirtualBox guest)<br>Apache version: 2.2.15<br>PHP version: 5.3.3<br>Result: fairly stable, very rarely do I not get a sensor reading<br><br>Environment 2:<br><br>OS: CentOS7.1 (tried both a dedicated physical machine and a VirtualBox guest)<br>Apache version: 2.4.6<br>PHP version: 5.4.16<br>Result: When I take a reading of my photoresistor, one or both of my two LED's turns off/on. Sometimes I do not get a sensor reading. <br><br>Environment 3:<br><br>OS:Raspbian<br>Apache version:2.2.22<br>PHP version:5.4.39<br>Result: When I take a reading of my photoresistor, one or both of my two LED's turns off/on. Sometimes I do not get a sensor reading.<br></p><p>I've tested things under Minicom and all works well, which tells me the issue is on the PHP side of things.</p><p>Arduino code:</p><pre class="hljs java"><span class="hljs-comment">//temp sensor vars</span>
<span class="hljs-keyword">boolean</span> neg=<span class="hljs-number">0</span>;
<span class="hljs-keyword">byte</span> temp=<span class="hljs-number">0</span>;
<span class="hljs-keyword">float</span> tempb=<span class="hljs-number">0</span>;
<span class="hljs-comment">// end</span>

<span class="hljs-keyword">byte</span> hybyte=<span class="hljs-number">0</span>;
<span class="hljs-keyword">int</span> result=<span class="hljs-number">0</span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-comment">// put your setup code here, to run once:</span>
DDRD|=B11000000; <span class="hljs-comment">//setting pins 20 and 21 as outputs</span>
ADMUX=B01000111;<span class="hljs-comment">//set adc reference and select channel</span>
ADCSRA=B10000110;<span class="hljs-comment">//enable adc and set prescaler to divide by 64</span>
<span class="hljs-comment">//temp sensor pins</span>
PORTC |=B11000000;
DDRC |=B11000000;<span class="hljs-comment">// pc7 as ada and pc6 as sck</span>
<span class="hljs-comment">//end</span>
Serial.begin(<span class="hljs-number">9600</span>);
DS1631startconvert();
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span> </span>{
  <span class="hljs-comment">// put your main code here, to run repeatedly:</span>
<span class="hljs-comment">//cal = OSCCAL;</span>
<span class="hljs-keyword">if</span> (Serial.available()){
     <span class="hljs-keyword">int</span> ser = Serial.read();
    
     <span class="hljs-keyword">if</span> (ser == <span class="hljs-number">52</span>){<span class="hljs-comment">//keyboard key 4 to read the temp sensor</span>
      DS1631readtemp();
      delay(<span class="hljs-number">50</span>);
      tempb=(tempb*(<span class="hljs-number">9.0</span>/<span class="hljs-number">5.0</span>))+<span class="hljs-number">32</span>;
      Serial.println(tempb,<span class="hljs-number">4</span>);<span class="hljs-comment">//4 decimal places </span>
      neg=<span class="hljs-number">0</span>;
      temp=<span class="hljs-number">0</span>;
     tempb=<span class="hljs-number">0</span>;
       }
     <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span> <span class="hljs-params">(ser == <span class="hljs-number">53</span>)</span></span>{<span class="hljs-comment">//keyboard key 5 to turn on led1</span>
      PORTD |=B01000000;
      delay(<span class="hljs-number">50</span>);
    Serial.println(<span class="hljs-string">"Object1 enabled"</span>); 
       }
     <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span><span class="hljs-params">(ser == <span class="hljs-number">54</span>)</span></span>{<span class="hljs-comment">//keyboard key 6 to turn off led1</span>
      PORTD &amp;=~B01000000;
            delay(<span class="hljs-number">50</span>);
      Serial.println(<span class="hljs-string">"Object1 disabled"</span>); 
       }
     <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span><span class="hljs-params">(ser == <span class="hljs-number">55</span>)</span></span>{<span class="hljs-comment">//keyboard key 7 to turn led2 on</span>
      PORTD |=B10000000;
            delay(<span class="hljs-number">50</span>);
       Serial.println(<span class="hljs-string">"Object2 enabled"</span>); 
       }
      <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span><span class="hljs-params">(ser == <span class="hljs-number">56</span>)</span></span>{<span class="hljs-comment">//keyboard key 8 to tourn led2 off</span>
      PORTD &amp;=~B10000000;
            delay(<span class="hljs-number">50</span>);
     Serial.println(<span class="hljs-string">"Object2 disabled"</span>); 
       }
       <span class="hljs-function"><span class="hljs-keyword">else</span> <span class="hljs-title">if</span><span class="hljs-params">(ser == <span class="hljs-number">57</span>)</span></span>{<span class="hljs-comment">//keyboard key 9 to read the photoresistor</span>
            delay(<span class="hljs-number">50</span>);
            adcread();
     Serial.println(result); 
       }
}

}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">adcread</span><span class="hljs-params">()</span></span>{
ADCSRA |= (<span class="hljs-number">1</span> &lt;&lt; ADSC);         <span class="hljs-comment">// start ADC measurement</span>
    <span class="hljs-keyword">while</span> (ADCSRA &amp; (<span class="hljs-number">1</span>&lt;&lt;ADSC)); <span class="hljs-comment">// wait till conversion complete </span>
result=ADCW;

}
<span class="hljs-comment">//temp sensor reading</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">start</span><span class="hljs-params">()</span></span>{
DDRC|=<span class="hljs-number">_</span>BV(DDC7);
PORTC|=<span class="hljs-number">_</span>BV(DDC7);
PORTC|=<span class="hljs-number">_</span>BV(DDC6);
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC6);
}

<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">stop1</span><span class="hljs-params">()</span></span>{
DDRC|=<span class="hljs-number">_</span>BV(DDC7);
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC6);
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
PORTC|=<span class="hljs-number">_</span>BV(DDC6);
PORTC|=<span class="hljs-number">_</span>BV(DDC7);
  }
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">clk</span><span class="hljs-params">()</span></span>{
PORTC|=<span class="hljs-number">_</span>BV(DDC6);
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC6);
<span class="hljs-comment">//delay(1);</span>
  }
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">DS1631startconvert</span><span class="hljs-params">()</span></span>{
start();
<span class="hljs-comment">//send address</span>
<span class="hljs-comment">//digitalWrite(sda,HIGH);</span>
PORTC|=<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,LOW);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,LOW);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,HIGH);</span>
PORTC|=<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,LOW);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,LOW);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,HIGH);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,LOW);//write</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//ignore ack</span>
clk();
<span class="hljs-comment">//start t convert command</span>
<span class="hljs-comment">//digitalWrite(sda,LOW);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,HIGH);</span>
PORTC|=<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,LOW);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,HIGH);</span>
PORTC|=<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,LOW);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,LOW);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,LOW);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,HIGH);</span>
PORTC|=<span class="hljs-number">_</span>BV(DDC7);
clk();
clk();<span class="hljs-comment">//ignoring ack</span>
stop1();
}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">DS1631readtemp</span><span class="hljs-params">()</span></span>{
start();
<span class="hljs-comment">//send device address</span>
<span class="hljs-comment">//send address</span>
<span class="hljs-comment">//digitalWrite(sda,HIGH);</span>
PORTC|=<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,LOW);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,LOW);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,HIGH);</span>
PORTC|=<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,LOW);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,LOW);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,HIGH);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,LOW);//write</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//ignore ack</span>
clk();
<span class="hljs-comment">//send read temp command AAh</span>
<span class="hljs-comment">//digitalWrite(sda,HIGH);</span>
PORTC|=<span class="hljs-number">_</span>BV(DDC7);
 clk();
 <span class="hljs-comment">//digitalWrite(sda,LOW);</span>
 PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
 clk();
 <span class="hljs-comment">//digitalWrite(sda,HIGH);</span>
 PORTC|=<span class="hljs-number">_</span>BV(DDC7);
 clk();
 <span class="hljs-comment">//digitalWrite(sda,LOW);</span>
 PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
 clk();
 <span class="hljs-comment">//digitalWrite(sda,HIGH);</span>
 PORTC|=<span class="hljs-number">_</span>BV(DDC7);
 clk();
 <span class="hljs-comment">//digitalWrite(sda,LOW);</span>
 PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
 clk();
 <span class="hljs-comment">//digitalWrite(sda,HIGH);</span>
 PORTC|=<span class="hljs-number">_</span>BV(DDC7);
 clk();
 <span class="hljs-comment">//digitalWrite(sda,LOW);</span>
 PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
 clk();
 clk(); <span class="hljs-comment">//ignoring ack again</span>
 stop1();
 start();
 <span class="hljs-comment">//send device address</span>
<span class="hljs-comment">//digitalWrite(sda,HIGH);</span>
PORTC|=<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,LOW);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,LOW);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,HIGH);</span>
PORTC|=<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,LOW);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,LOW);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,HIGH);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//digitalWrite(sda,HIGH);//read</span>
PORTC|=<span class="hljs-number">_</span>BV(DDC7);
clk(); 
<span class="hljs-comment">//pinMode(sda,INPUT);//change pin from output to input for readin</span>
DDRC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
<span class="hljs-keyword">byte</span> raw=<span class="hljs-number">0</span>;
clk();
<span class="hljs-comment">//read the temp</span>
 <span class="hljs-comment">//raw=digitalRead(sda);</span>
 raw=PINC &amp; <span class="hljs-number">_</span>BV(PC7);
 <span class="hljs-keyword">if</span>(raw==<span class="hljs-number">128</span>){
  temp=temp+<span class="hljs-number">128</span>;
 neg=<span class="hljs-number">1</span>; 
 }
 clk();
 <span class="hljs-comment">//raw=digitalRead(sda);</span>
 raw=PINC &amp; <span class="hljs-number">_</span>BV(PC7);
 <span class="hljs-keyword">if</span>(raw==<span class="hljs-number">128</span>){
   temp=temp+<span class="hljs-number">64</span>;
 }
 clk();
 <span class="hljs-comment">//raw=digitalRead(sda);</span>
 raw=PINC &amp; <span class="hljs-number">_</span>BV(PC7);
 <span class="hljs-keyword">if</span>(raw==<span class="hljs-number">128</span>){
  temp=temp+<span class="hljs-number">32</span>; 
 }
 clk();
 <span class="hljs-comment">//raw=digitalRead(sda);</span>
 raw=PINC &amp; <span class="hljs-number">_</span>BV(PC7);
 <span class="hljs-keyword">if</span>(raw==<span class="hljs-number">128</span>){
   temp=temp+<span class="hljs-number">16</span>;
 }
 clk();
 <span class="hljs-comment">//raw=digitalRead(sda);</span>
 raw=PINC &amp; <span class="hljs-number">_</span>BV(PC7);
 <span class="hljs-keyword">if</span>(raw==<span class="hljs-number">128</span>){
  temp=temp+<span class="hljs-number">8</span>; 
 }
 clk();
 <span class="hljs-comment">//raw=digitalRead(sda);</span>
 raw=PINC &amp; <span class="hljs-number">_</span>BV(PC7);
 <span class="hljs-keyword">if</span>(raw==<span class="hljs-number">128</span>){
   temp=temp+<span class="hljs-number">4</span>;
 }
 clk();
 <span class="hljs-comment">//raw=digitalRead(sda);</span>
 raw=PINC &amp; <span class="hljs-number">_</span>BV(PC7);
 <span class="hljs-keyword">if</span>(raw==<span class="hljs-number">128</span>){
  temp=temp+<span class="hljs-number">2</span>; 
 }
 clk();
 <span class="hljs-comment">//raw=digitalRead(sda);</span>
 raw=PINC &amp; <span class="hljs-number">_</span>BV(PC7);
 <span class="hljs-keyword">if</span>(raw==<span class="hljs-number">128</span>){
   temp=temp+<span class="hljs-number">1</span>;
 }
 clk();
 
<span class="hljs-comment">//doing more significant read</span>
<span class="hljs-comment">/*
0000
.5 1
.25 2
.125 3
.0625 4


*/</span>
<span class="hljs-comment">//pinMode(sda,OUTPUT);</span>
DDRC|=<span class="hljs-number">_</span>BV(DDC7);
<span class="hljs-comment">//digitalWrite(sda,LOW);</span>
PORTC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
clk();
<span class="hljs-comment">//pinMode(sda,INPUT);</span>
DDRC&amp;=~<span class="hljs-number">_</span>BV(DDC7);
<span class="hljs-comment">//raw=digitalRead(sda);</span>
raw=PINC &amp; <span class="hljs-number">_</span>BV(PC7);
<span class="hljs-keyword">if</span>(raw==<span class="hljs-number">128</span>){
   tempb=tempb+<span class="hljs-number">.5</span>;
 }
clk();
<span class="hljs-comment">//raw=digitalRead(sda);</span>
raw=PINC &amp; <span class="hljs-number">_</span>BV(PC7);
<span class="hljs-keyword">if</span>(raw==<span class="hljs-number">128</span>){
   tempb=tempb+<span class="hljs-number">.25</span>;
 }
clk();
<span class="hljs-comment">//raw=digitalRead(sda);</span>
raw=PINC &amp; <span class="hljs-number">_</span>BV(PC7);
<span class="hljs-keyword">if</span>(raw==<span class="hljs-number">128</span>){
   tempb=tempb+<span class="hljs-number">.125</span>;
 }
clk();
<span class="hljs-comment">//raw=digitalRead(sda);</span>
raw=PINC &amp; <span class="hljs-number">_</span>BV(PC7);
<span class="hljs-keyword">if</span>(raw==<span class="hljs-number">128</span>){
   tempb=tempb+<span class="hljs-number">.0625</span>;
 }
clk();
clk();
clk();
clk();
clk();
clk();
stop1();

<span class="hljs-keyword">if</span> (neg==<span class="hljs-number">1</span>){
temp=temp-<span class="hljs-number">1</span>;
temp=~(temp);
tempb=(tempb+temp)*-<span class="hljs-number">1</span>;
}
<span class="hljs-keyword">else</span>{
tempb=tempb+temp; 
}

}</pre><br><p> php code:</p><pre class="hljs xml"><span class="hljs-doctype">&lt;!DOCTYPE html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">link</span> <span class="hljs-attribute">rel</span>=<span class="hljs-value">"stylesheet"</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/css"</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"main.css"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">title</span>&gt;</span>Cpannel<span class="hljs-tag">&lt;/<span class="hljs-title">title</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"title"</span>&gt;</span>Control Panel<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"panel"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">form</span>  <span class="hljs-attribute">method</span>=<span class="hljs-value">'post'</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">'submit'</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">'button1'</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">'Read Photo'</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"buttona"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"button"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">'submit'</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">'button2'</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">'Turn off'</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"buttonb"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"button"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">'submit'</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"button3"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">'Read Temp'</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"buttonc"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"button"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">'submit'</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"button4"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">'Clear'</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"buttond"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"button"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span> 
<span class="hljs-tag">&lt;<span class="hljs-title">form</span>  <span class="hljs-attribute">method</span>=<span class="hljs-value">'post'</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">'submit'</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">'button5'</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">'Ob1 on'</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"buttone"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"button"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">'submit'</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">'button6'</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">'Ob1 off'</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"buttonf"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"button"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">'submit'</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"button7"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">'Ob2 on'</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"buttong"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"button"</span>/&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">'submit'</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"button8"</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">'Ob2 off'</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"buttonh"</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"button"</span>/&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">form</span>&gt;</span> 
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"status"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">br</span> /&gt;</span>Status:<span class="hljs-tag">&lt;<span class="hljs-title">br</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="php"><span class="hljs-preprocessor">&lt;?php</span>
<span class="hljs-keyword">include</span> <span class="hljs-string">"php_serial.class.php"</span>; 
<span class="hljs-variable">$serial</span> = <span class="hljs-keyword">new</span> phpSerial;
<span class="hljs-variable">$serial</span>-&gt;deviceSet(<span class="hljs-string">"/dev/ttyUSB0"</span>);
<span class="hljs-variable">$serial</span>-&gt;confBaudRate(<span class="hljs-number">9600</span>);

date_default_timezone_set(<span class="hljs-string">"UTC"</span>);
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'button1'</span>]))
{
<span class="hljs-variable">$serial</span>-&gt;deviceOpen();
<span class="hljs-variable">$serial</span>-&gt;sendMessage(<span class="hljs-string">"9"</span>);
<span class="hljs-variable">$read</span> = <span class="hljs-variable">$serial</span>-&gt;readPort();
<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;div class='status'&gt;"</span> . <span class="hljs-variable">$read</span> . <span class="hljs-string">"&lt;/div&gt;"</span>;
<span class="hljs-variable">$serial</span>-&gt;deviceClose();
<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;div class='status'&gt;"</span> . date(<span class="hljs-string">"h:i:sa"</span>) . <span class="hljs-string">"&lt;/div&gt;"</span>;
}
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'button2'</span>]))
{
<span class="hljs-keyword">echo</span> <span class="hljs-string">"button2 has been pressed"</span>;
}
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'button3'</span>]))
{
<span class="hljs-variable">$serial</span>-&gt;deviceOpen();
<span class="hljs-variable">$serial</span>-&gt;sendMessage(<span class="hljs-string">"4"</span>);
<span class="hljs-variable">$read</span> = <span class="hljs-variable">$serial</span>-&gt;readPort();
<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;div class='status'&gt;"</span> . <span class="hljs-variable">$read</span> . <span class="hljs-string">"&lt;/div&gt;"</span>;
<span class="hljs-variable">$serial</span>-&gt;deviceClose();
<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;div class='status'&gt;"</span> . date(<span class="hljs-string">"h:i:sa"</span>) . <span class="hljs-string">"&lt;/div&gt;"</span>;
}
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'button4'</span>]))
{
<span class="hljs-keyword">echo</span> <span class="hljs-string">""</span>;
}


<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'button5'</span>]))
{
<span class="hljs-variable">$serial</span>-&gt;deviceOpen();
<span class="hljs-variable">$serial</span>-&gt;sendMessage(<span class="hljs-string">"5"</span>);
<span class="hljs-variable">$read</span> = <span class="hljs-variable">$serial</span>-&gt;readPort();
<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;div class='status'&gt;"</span> . <span class="hljs-variable">$read</span> . <span class="hljs-string">"&lt;/div&gt;"</span>;
<span class="hljs-variable">$serial</span>-&gt;deviceClose();
<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;div class='status'&gt;"</span> . date(<span class="hljs-string">"h:i:sa"</span>) . <span class="hljs-string">"&lt;/div&gt;"</span>;
}
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'button6'</span>]))
{
<span class="hljs-variable">$serial</span>-&gt;deviceOpen();
<span class="hljs-variable">$serial</span>-&gt;sendMessage(<span class="hljs-string">"6"</span>);
<span class="hljs-variable">$read</span> = <span class="hljs-variable">$serial</span>-&gt;readPort();
<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;div class='status'&gt;"</span> . <span class="hljs-variable">$read</span> . <span class="hljs-string">"&lt;/div&gt;"</span>;
<span class="hljs-variable">$serial</span>-&gt;deviceClose();
<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;div class='status'&gt;"</span> . date(<span class="hljs-string">"h:i:sa"</span>) . <span class="hljs-string">"&lt;/div&gt;"</span>;
}
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'button7'</span>]))
{

<span class="hljs-variable">$serial</span>-&gt;deviceOpen();
<span class="hljs-variable">$serial</span>-&gt;sendMessage(<span class="hljs-string">"7"</span>);
<span class="hljs-variable">$read</span> = <span class="hljs-variable">$serial</span>-&gt;readPort();
<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;div class='status'&gt;"</span> . <span class="hljs-variable">$read</span> . <span class="hljs-string">"&lt;/div&gt;"</span>;
<span class="hljs-variable">$serial</span>-&gt;deviceClose();
<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;div class='status'&gt;"</span> . date(<span class="hljs-string">"h:i:sa"</span>) . <span class="hljs-string">"&lt;/div&gt;"</span>;
}
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'button8'</span>]))
{
<span class="hljs-variable">$serial</span>-&gt;deviceOpen();
<span class="hljs-variable">$serial</span>-&gt;sendMessage(<span class="hljs-string">"8"</span>);
<span class="hljs-variable">$read</span> = <span class="hljs-variable">$serial</span>-&gt;readPort();
<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;div class='status'&gt;"</span> . <span class="hljs-variable">$read</span> . <span class="hljs-string">"&lt;/div&gt;"</span>;
<span class="hljs-variable">$serial</span>-&gt;deviceClose();
<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;div class='status'&gt;"</span> . date(<span class="hljs-string">"h:i:sa"</span>) . <span class="hljs-string">"&lt;/div&gt;"</span>;
}
<span class="hljs-preprocessor">?&gt;</span></span>
<span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span></pre><br></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/5662/log/17853-got-it-working-better">Got it working better</a></h2>
                            <small class="authorship">3 months ago  &bull;
                                <a class="gray-link" href="/project/5662/log/17853#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-17853"><p>Well I did find a work-around to the issue by adding the following lines after the results of the photoresistor and temperature are sent to clear the incoming serial buffer (a delay was also needed):</p><pre class="hljs perl">delay(<span class="hljs-number">250</span>);
<span class="hljs-keyword">while</span>(Serial.available())
  Serial.<span class="hljs-keyword">read</span>();</pre><br><p> When  I tried things on my Raspberry Pi, the above fix worked but I was still having issues with not getting a response message/data at times.  The work-around was putting the the serial interaction in a while loop until I finally get the return data:</p><pre class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">'button1'</span>]))
{
<span class="hljs-keyword">while</span>( <span class="hljs-keyword">empty</span>(<span class="hljs-variable">$read</span>)){
<span class="hljs-variable">$serial</span>-&gt;deviceOpen();
<span class="hljs-variable">$serial</span>-&gt;sendMessage(<span class="hljs-string">"9"</span>);
<span class="hljs-comment">//usleep(200000);</span>
<span class="hljs-variable">$read</span> = <span class="hljs-variable">$serial</span>-&gt;readPort();
<span class="hljs-variable">$serial</span>-&gt;deviceClose();
}
}
</pre><br><p> A side-effect of this work-around is a slightly longer wait to get something such as a temperature value.  </p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/5662/log/19985-im-still-here">I&#39;m still here!</a></h2>
                            <small class="authorship">2 months ago  &bull;
                                <a class="gray-link" href="/project/5662/log/19985#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-19985"><p>I've been temporarily distracted with the arrival of two esp8266 modules. I may incorporate them into the project.</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/5662/log/20408-working-on-the-web-side-of-things">Working on the Web side of things</a></h2>
                            <small class="authorship">a month ago  &bull;
                                <a class="gray-link" href="/project/5662/log/20408#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-20408"><p>I'm currently working on improving the web interface (a screenshot of it can be seen in the second project photo.) Originally everything was in a few files.  I've not split up all the different functions, into separate files. </p><p>I've also changed the appearance a bit, it's still just a draft so there is bound to be at least a few more iterations to go.   As for new features, I'm considering taking logs of sensor data. </p><p>Happy 4th of July in advance!</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/5662/log/20589-github-page">GitHub Page</a></h2>
                            <small class="authorship">a month ago  &bull;
                                <a class="gray-link" href="/project/5662/log/20589#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-20589"><p>I know, I know it's about time that I set one up (continuing to dump my code on the Hackaday page would just make things messy and inpractical.)  I"m still learning how to use GitHub.</p><p>Anyways, here is the link to it:</p><p><a href="https://github.com/nickjkl/houseremote">GitHub page</a><br></p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/5662/log/21705-added-a-remote-sensor">Added a remote sensor</a></h2>
                            <small class="authorship">20 days ago  &bull;
                                <a class="gray-link" href="/project/5662/log/21705#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-21705"><p>I&apos;ve added a remote sensor using an ESP8266 and a MSP430G2553.  The sensor is currently configured to detect the presence of water and send and alert to the web server if it does.  The new code(and modifications to web page files) has been posted on my GitHub repo <a href="https://github.com/nickjkl/houseremote">here</a>.</p><p>A little backstory: I&apos;ve suffered in the past from water leaks from the washing machine, the last leak damaged my flooring in the hallway.  </p><p>I of course plan to do more things than just detect water with remote sensors in the future.  The downside of using the ESP8266 is that it&apos;s a power hog, which reduces the practicality of making the remote sensor battery-powered and thus limits where I can place it.</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/5662/log/22771-been-busy">Been Busy</a></h2>
                            <small class="authorship">4 days ago  &bull;
                                <a class="gray-link" href="/project/5662/log/22771#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-22771"><p>First of all let me say thanks for those that are following and/or have given skulls, your support is appricated!  I&apos;ve been busy with other things this week such as making having my first PCB made.  I plan to get back on track next week.</p></div>
                            </div>
                        </li>
                    
                </ul>

                

                

                </p>

            
        </div>
    </div>

    










<div class="footer" id="footer">
  <a href="#header" class="back-to-top" onClick="CT(this, 'Footer', 'GoingUp');">^ Going up? ^</a>
    <div class="container">
        <p><a href="http://hackaday.com/about/">About Us</a> <a href="mailto:projects-contact@hackaday.com">Contact Us</a> <a href="/project/37">Give Feedback</a>&copy; 2015 Hackaday <a href="/tos">Terms of Use</a> <a href="/privacy-policy">Privacy Policy</a></p>
        <a href="/" class="had-skull"  onClick="CT(this, 'Footer', 'Home' ); return false;">Hackaday.io</a>
    </div>
</div>

<script>

    var csrftoken = '37M4qp3V-6GZsAsrqEtBTCD-0NfaBmPlQWJU';

</script>

    <script type="text/javascript">

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47229708-1', 'auto');

    var dimensionValue = 'nonregistered';
    ga('set', 'dimension1', dimensionValue);
    ga('require', 'displayfeatures');

    ga('send', 'pageview');

    </script>

<img src="//analytics.supplyframe.com/trackingservlet/impression?action=pageImpression&amp;zone=HIO_logs&amp;extra=logged%3Dfalse%7ChaveAccountCookie%3D0%7C&amp;ab=undefined" class="sf-impression" />

    
    
    <script src="//cdn.hackaday.io/build/h%2FydgsYIeDTf7pqgYQEKK8Ngblw0IkZCDqfJ9S2tk7zsBoxIHt5iOd49Qp%2BF4vdxEuRj%2BGpGDLbX4aGOQGmbjaOxUZvklg4ReFk68R95OQshFrGKebvogKGQOiB5Hi1xym9KC54c9Ps0WpzuNydLk4B%2FbKi91KhV40Uxhl38XXb1IVAxAI8iW%2BoQUPCFkHVWZxD0B%2BMZ%2BuEXJTlWuBmopNMxTHRK5yleITPZODT6evbVRQc6AXs9w2Pfk7FS2nKy-0.48.6.js"></script>

</body>
</html>