<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <title>Share the Warmth &bull; Hackaday.io</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

    


        <meta name="description" content="Warm-air distribution system (PIC/JALv2)">
        <link rel="canonical" href="http://hackaday.io/project/5474-share-the-warmth" />



    <link rel="stylesheet" href="//cdn.hackaday.io/css/style.css?version=0.48.6" />
        <script type="text/javascript">
        function getCommentIdFromUrl() {
            if(window.location.hash) {
                var hash = window.location.hash.substring(1);
                var commentId = parseInt(hash.replace('j-discussion-', ''));
                if (commentId) {
                    return commentId;
                }
            }
            return null;
        }

        var commentId = getCommentIdFromUrl();
        if (commentId) {
            var url = window.location.href;
            if (url.indexOf('?') > -1) {
                url = url.substring(0, url.indexOf('?'));
            }
            if (url.indexOf('#') > -1) {
                url = url.substring(0, url.indexOf('#'));
            }
            url += '/discussion-' + commentId;
            window.location.href = url;
        }
    </script>
    <script type="text/javascript" src="//use.typekit.net/ymb0lgk.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>

    <!-- Twitter Card data -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@hackadayio">
    <meta name="twitter:title" content="Share the Warmth">
    
        <meta name="twitter:description" content="Background:
We have a wood stove and it is fabulous.  It&#39;s made from cast iron and soapstone, so it heats up very slowly, but once it&#39;s going it burns 24/7 and provides not just a source of heat, but also a centre-piece and focal point within the living area.  It is clean burning and will happily stay alive through those long winter nights on just one load of wood, with the soapstone still radiating heat in the morning.

The Problem:
Although we have an open-plan living-dining-kitchen area, the bedrooms and bathroom/toilet are on the north side of the house and, because there&#39;s no natural airflow from the lounge area, they get exceedingly chilly at night (we&#39;re at 700-metres).   We really need an additional heat source for those back rooms.

The Solution:
The wood stove works well, so all we really need to do is channel some of that heat into those rooms.  It doesn&#39;t have to be tropical in there, just warm enough so that it&#39;s not torture getting out of bed in the morning. ">
    
    
        <meta name="twitter:image" content="https://cdn.hackaday.io/images/resize/600x600/6811231430104465138.jpg">
    

    <!-- Open Graph data -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Share the Warmth">
    <meta property="og:url" content="http://hackaday.io/project/5474-share-the-warmth">
    
        <meta property="og:description" content="Background:
We have a wood stove and it is fabulous.  It&#39;s made from cast iron and soapstone, so it heats up very slowly, but once it&#39;s going it burns 24/7 and provides not just a source of heat, but also a centre-piece and focal point within the living area.  It is clean burning and will happily stay alive through those long winter nights on just one load of wood, with the soapstone still radiating heat in the morning.

The Problem:
Although we have an open-plan living-dining-kitchen area, the bedrooms and bathroom/toilet are on the north side of the house and, because there&#39;s no natural airflow from the lounge area, they get exceedingly chilly at night (we&#39;re at 700-metres).   We really need an additional heat source for those back rooms.

The Solution:
The wood stove works well, so all we really need to do is channel some of that heat into those rooms.  It doesn&#39;t have to be tropical in there, just warm enough so that it&#39;s not torture getting out of bed in the morning. ">
    
    
        <meta property="og:image" content="https://cdn.hackaday.io/images/resize/600x600/6811231430104465138.jpg">
    

    <script>
        var HIO = {};
    </script>

</head>
<body class="project-detail ">

    <!--
############################################################################################
############################################################################################
############################################################################################
#####################Kt;tL#######################################Kti,E######################
#######################;   .###################################G    E#######################
#######################K    f##################################    ;########################
########################Wj   E###############################K:  .W#########################
##########################.  :E##############################:  .L##########################
#########################D    f##############################.   .##########################
########################,     ;##############################     :E#######K################
################f######K      ,##############################      ,######Lt################
################  W###W       i##############################       t####j t################
################:  E#L.        f###########################L.        f#Ki .E################
################j  ;E.          j##########################.         .G;  i#################
#################L               i#######################K                ##################
#################W                E#####################K;               ;##################
###################:               .###################D               :f###################
#####################DLfGD           G####WEEEEKW####W           ;GffGK#####################
##########################i         iD##Kfi    :jKW##D          iE##########################
###########################W      ,G##f            jE#E;       j############################
############################L     D##D              ,##K       W############################
#############################D:  G#W                  K#E,   G##############################
###############################;i#L                    j## ,E###############################
###############################KK#.                     ##iE################################
#################################j                      ;K##################################
################################W                        ,##################################
################################E                         ##################################
###############################Ki                         D#################################
###############################E.                         L#################################
###############################f    iD##W;       D###D    :#################################
###############################i   i######K     K#####K;   #################################
###############################;  .E#######     #######D   #################################
###############################;  L########     ########   #################################
###############################i  G#######K     K#######   #################################
###############################j  L#####E,       fE#####   #################################
###############################D  .E##j            .t##E  ;#################################
###############################E:  ;##.              #Wt  j#################################
################################G   ;t      tWi      t    E#################################
#############################KL##           K#K;          #K:K##############################
#############################i ##:          ###t         j#f ;K#############################
############################:  G#K          #E#L        L##    D############################
###########################D   ;W#:         #;#L        W#K    .############################
#####################KKEKK      :##L        ; ..      :D##.      fKEEK######################
###################t.            ;##G:               ,##E,             tD###################
##################G               E##E               i##;               :###################
#################D                W##W    iL    E.    ###D                ##################
################W,               G###W    tG    K.    ####:               K#################
################;  LW;         ,E#####:  ;W#    #G   f#####;         ;KG  :K################
################  D###E       ;########WW####WW####WW#######W       :####: j################
################ ,#####:      ;##############################       G####E i################
################K#######.     ;##############################      L######WG################
########################f     i##############################     j#########################
#########################W   .D##############################.   i##########################
#########################E   G###############################D   ,##########################
########################G:   #################################j   G#########################
#######################f    K##################################j    W#######################
#####################Kt :iE#####################################KL:  K######################
############################################################################################
############################################################################################
############################################################################################
-->

<div class="header" id="header">
    <div class="container">
        <h1 class="logo">
            <a href="/" title="Hackaday.io Home" class="home" onclick="CT(this, 'Menu', 'Home'); return false;"></a>
            <a href="/" title="Hackaday.io Home" class="brand" onclick="CT(this, 'Menu', 'Home'); return false;">Hack a Day</a>
        </h1>

        <a href="javascript:void(0);" class="responsive-menu">Menu</a>

        <ul class="nav" role="navigation">
            <li><a href="/projects" class="">Projects</a></li>
            <li><a href="/lists" class="">Lists</a></li>
            <li><a href="/stack" class="">Stack</a></li>
            <li class="dropdown more-nav j-more-open">
                <a href="javascript:void(0)" class="dropdown-link icon-dropdown">More</a>
                <ul role="menu" class="dropdown-menu more-menu" id="j-more">
                    <li><a href="http://hackaday.com/blog/" target="_blank">Blog</a></li>
                    <li><a href="/events">Events</a></li>
                    <li><a href="/hackerspaces">Hackerspaces</a></li>
                    <li><a href="/hackers">Profiles</a></li>
                    <li><a href="/contests">Contests</a></li>
                    <li><a href="/prize" target="_blank">The Hackaday Prize</a></li>
                    <li><a href="/submissions/prize2015/list">2015 Prize Entries</a></li>
                </ul>
            </li>
            <li class="menu-last-child">
                <div class="search-holder show">
                    <form id="search-form" action="/search" onsubmit="return submitSearch();" method="GET">
                        <input type="text" placeholder="Search" name="term" class="input-search j-add-search" id="j-add-search" value="" autocomplete="off" pattern=".{3,}" required title="3 characters minimum" />
                        <input type="submit" class="search-button" />
                    </form>
                </div>
            </li>
        </ul>

        

            <ul class="nav pull-right" role="navigation">
                <li><a href="/signup" class="grey-white-button become-member">Sign up</a></li>
                <li><a href="/signin?returnUrl=%2Fproject%2F5474-share-the-warmth">Sign in</a></li>
            </ul>

        
    </div>
</div>

<div id="topMessage" class="alert"><span class="j-top-content"></span><a href="javascript:void(0);" class="alert-close j-top-message-close">Close</a></div>




    

    
        <div class="page-basic-info-static guest-message-signup">
            
                <h2>Does this project spark your interest?</h2>
                <p class="page-basic-info-text">Become a member to follow this project and don't miss any updates</p>

            

            <div class="signup-holder">
                <form method="POST" action="/signup">
                    <input type="hidden" name="_csrf" value="BhuAHMfV-cK8gW7756s7fmJ5DlYbC2auWLSE" />
                    <input type="text" class="input-field input-email" placeholder="Your email address"  name="email"  /><input type="password" class="input-field input-password" placeholder="Password"  name="password" /><button class="black-gold-button signup" type="submit">Become a member</button>
                    <input class="input-field" placeholder="Invitation Code" required name="invitation_code" value="5Ad0ix2-b96J" type="hidden" />
                </form>
            </div>

        </div>
    


    

    <div class="header-photo" >
        <div class="overlay"></div>
    </div>

    <div class="headline">
        <div class="container">
            

            <h2><a href="/project/5474-share-the-warmth">Share the Warmth</a></h2>
            <p class="description">Warm-air distribution system (PIC/JALv2)</p>

            

            
                <div class="author">
                    <a href="/hacker/22738">
                        <img src="https://cdn.hackaday.io/images/resize/100x100/7871191430308174729.jpg" />
                        
                            <div class="author-details">
                                <div class="author-name">sbi.gaijin</div>
                            </div>
                        
                    </a>
                </div>
            
        </div>
    </div>

    <div class="container">
        <div class="content-left">

            
                <ul class="submissions-icons">
                    
                        
                            <li>
                                <a href="/submissions/prize2015/list" class="submission-icon submission-icon-5">
                                    The 2015 Hackaday Prize
                                </a>
                            </li>
                        
                        
                            <script>
                                HIO.forPrize = true;
                            </script>
                        
                    
                </ul>
            

            
                <a href="/project/5474/gallery#4bee9ca43619b324658eadf101f5b363" id="project-image" class="image-holder" style="background-image: url(https://cdn.hackaday.io/images/resize/600x600/6811231430104465138.jpg)" data-image="https://cdn.hackaday.io/images/resize/600x600/6811231430104465138.jpg">
                </a>
            

            <div class="thumbs-holder">
                
                        <a href="/project/5474/gallery#4bee9ca43619b324658eadf101f5b363" class="image-holder thumb" style="background-image: url(https://cdn.hackaday.io/images/resize/600x600/6811231430104465138.jpg)" data-image="https://cdn.hackaday.io/images/resize/600x600/6811231430104465138.jpg">
                    </a>
                
                        <a href="/project/5474/gallery#97a00d6ab750796905d17c34e8b0c4d6" class="image-holder thumb" style="background-image: url(https://cdn.hackaday.io/images/resize/600x600/1908411430309070210.JPG)" data-image="https://cdn.hackaday.io/images/resize/600x600/1908411430309070210.JPG">
                    </a>
                
                        <a href="/project/5474/gallery#89322afd33fd2b4ee02303e0bfdd2e05" class="image-holder thumb thumb-last" style="background-image: url(https://cdn.hackaday.io/images/resize/600x600/4374661430309213682.jpg)" data-image="https://cdn.hackaday.io/images/resize/600x600/4374661430309213682.jpg">
                    </a>
                
            </div>

            
                <div class="view-gallery-holder">
                    <a href="/project/5474/gallery">
                        <div class="view-gallery grey-gold-button very-small-button">View Gallery</div>
                    </a>
                </div>
            

            

            

            

            

                <div class="project-following-container ">
                    <a href="javascript:void(0)" data-href="/project/5474/event/unfollow" class="gold-gold-button unfollow text-changing-button" data-before="<span class='icon-checkmark-gray'>Following</span>" data-after="Unfollow?"><span class="icon-checkmark-gray">Following</span></a>
                    <a href="javascript:void(0)" data-href="/project/5474/event/follow" class="gold-gold-button follow">Follow project</a>
                </div>
                
                

                <div id="similars">
                    <div class="similars-header">
                        Similar projects worth following
                        <a href="javascript:void(0)" class="submissions-close"></a>
                    </div>
                </div>

                
                    <div class="project-skulling-container ">
                        <a href="javascript:void(0)" data-href="/project/5474/event/unskull" class="gold-gold-button unskulled text-changing-button" data-before="<span class='icon-skull'>You</span>" data-after="Unskull?"><span class="icon-skull">You</span></a>
                        <a href="javascript:void(0)" data-href="/project/5474/event/skull" class="gold-gold-button skulled"><span class="icon-skull">Give a</span></a>
                    </div>
                

            

            
            

            <div class="section section-project-stats">
                
                    <span class="icon-view-count" title="View Count">797</span>
                
                <a>
                    <span class="icon-comment-with-hover oi-font-color-grey" title="Comments" id="comment_count">0</span>
                </a>
                
                    <a href="/hackers/all/project/5474/following">
                
                    <span class="icon-view oi-font-color-grey" title="Followers" id="follower_count">18</span>
                
                    </a>
                

                
                    
                        <a href="/hackers/all/project/5474/likers">
                    
                            <span class="icon-skull oi-font-color-grey" title="Skulls" id="like_count">4</span>
                    
                        </a>
                    
                
            </div>

            
                <div class="section section-team">
                    <h5>
                        
                            Team
                        
                    </h5>

                    <ul>
                        
                            
                                <li>
                                    <img src="https://cdn.hackaday.io/images/resize/100x100/7871191430308174729.jpg" class="team-photo"/>
                                    <a class="team-link" href="/hacker/22738-sbigaijin">sbi.gaijin</a>

                                    

                                    
                                </li>
                            
                        
                    </ul>

                    <div class="error-message hide" id="team-error"><p></p></div>

                    
                    <input type="hidden" name="HADPrizeSubmission" value="true"/>
                        
                            <a href="javascript:void(0)"
                               
                                    class="login-button"
                               
                            >Request to join this project</a>
                        
                    

                </div>
            

            

            


            
                
                    <div class="section section-tags">
                        
                            <div class="special-tags">
                                <a href="/projects/tag/hardware" class="tag tag-hardware">hardware</a>
                            </div>
                        
                            <div class="special-tags">
                                <a href="/projects/tag/ongoing%20project" class="tag tag-ongoing">ongoing project</a>
                            </div>
                        
                        
                            <a href="/projects/tag/2015HackadayPrize" class="tag">2015HackadayPrize</a>
                        
                            <a href="/projects/tag/JAL" class="tag">JAL</a>
                        
                    </div>
                
            

            <div class="section section-share">
                <h5>
                    
                        Enjoy this project?
                    
                </h5>
                
                <a href="https://twitter.com/intent/tweet?url=http://hackaday.io/project/5474-share-the-warmth&text=Share%20the%20Warmth by sbigaijin&related=hackadayio&via=hackadayio" target="_blank" class="icon-twitter icon-twitter-notext gray-link">Share on twitter</a> &nbsp; <a href="https://www.facebook.com/sharer/sharer.php?u=http://hackaday.io/project/5474-share-the-warmth" target="_blank" class="icon-facebook icon-facebook-notext gray-link">Share on Facebook</a> &nbsp; <a href="https://plus.google.com/share?url=http://hackaday.io/project/5474-share-the-warmth&h1=en-US" target="_blank" class="icon-google icon-google-notext gray-link">Share on Google+</a>
            </div>

            
            
                <div class="section section-lists">
                    <h5>This project is in these lists</h5>
                    
                        <div class="section-lists list-items">
    <a href="/list/5433-microchip-parts">
        <div title="Microchip Parts" class="list-item-cover"
                
                    style="background-image: url('https://cdn.hackaday.io/images/resize/600x600/8927051429902491090.jpg')"
                
                >
        </div>

        <div class="project-item-title">
            <h4>Microchip Parts</h4>
        </div>
    </a>
</div>

                    
                        <div class="section-lists list-items">
    <a href="/list/5846-2015-thp-microchip-parts">
        <div title="2015 THP: Microchip Parts" class="list-item-cover"
                
                    style="background-image: url('https://cdn.hackaday.io/images/resize/600x600/6342911431802653602.jpg')"
                
                >
        </div>

        <div class="project-item-title">
            <h4>2015 THP: Microchip Parts</h4>
        </div>
    </a>
</div>

                    
                    <a href="/lists/">Browse all lists »</a>
                </div>
            

            
                <div class="section section-submissions-lists">
                    <h5>This project is submitted for</h5>
                    <ul>
                        
                            <li><a href="/submissions/prize2015/list">The 2015 Hackaday Prize</a></li>
                        
                    </ul>
                </div>
            

            <div class="section section-project-time">
                <p class="project-time">
                    This project was
                        
                            created on 04/27/2015
                            
                                 and last updated 2 months ago.
                            
                        
                </p>
            </div>

            

        </div>

        <div class="content-right">

            
                <div class="section section-description">
                    <h5>Description</h5>
                    <div class="description">Background:<br />We have a wood stove and it is fabulous.  It's made from cast iron and soapstone, so it heats up very slowly, but once it's going it burns 24/7 and provides not just a source of heat, but also a centre-piece and focal point within the living area.  It is clean burning and will happily stay alive through those long winter nights on just one load of wood, with the soapstone still radiating heat in the morning.<br /><br />The Problem:<br />Although we have an open-plan living-dining-kitchen area, the bedrooms and bathroom/toilet are on the north side of the house and, because there's no natural airflow from the lounge area, they get exceedingly chilly at night (we're at 700-metres).   We really need an additional heat source for those back rooms.<br /><br />The Solution:<br />The wood stove works well, so all we really need to do is channel some of that heat into those rooms.  It doesn't have to be tropical in there, just warm enough so that it's not torture getting out of bed in the morning. </div>
                </div>
            

            
                <div class="section section-details">
                    <h5>
                        
                            Details
                        
                    </h5>
                    

                    
                        <div class="post-content details-content">
                            <p><p><em></em>Okay, I cheated (just a little bit).  Even before we built the house, we could see that this was going to be an issue, so when I was panelling the internal walls I left spaces for ducts to run from the lounge area, through the under-stairs storage area, to strategically placed openings in the walls of the "cold" rooms.  The plan was to use forced air from the "warm" lounge area to provide warmth from the woodstove.<br></p><h2>The Cheek of it:</h2><p>Yes, I admit it ...I'm submitting to the 2015 Hackaday Prize simply because I could do with an upgrade from my multiple, 40-year old~H~H~H~H~H perf/stripboards to a nice, clean, purple PCB.</p><p>Environmentally friendly?  Yup, tick that box ...even though the environment in question is limited to our bedroom and the bog.  Seriously though, this project  does save us from installing another form of heating, so it reduces our carbon footprint just a little.  It's difficult to envisage this being applicable elsewhere, though.</p><h2>The Hardware:</h2><p>The hardware is very basic.  I'm using 200mm, 700RPM, 12v fans to move the warm air through the ducting.  Because they run so slowly, they are also fairly quiet, at just 19db.  The fans are slowed down even further by using a PIC18F27J53 microcontroller to provide PWM drive to what is effectively a very simple switching (Buck) regulator from a 21v supply.  Why 21v?  Because that's what the transformer (salvaged from an 80's vintage radio/cassette deck) outputs.</p><p><img src="https://cdn.hackaday.io/images/5367881430211192349.jpg" alt="PIC18F27J53 PSU" style="display: block; margin: auto;"></p><p>Temperature sensing is courtesy of a handfull of DS18S20 one-wire temperature sensors.  Why the (fairly ancient) DS18S20?  Because I have close to a metric ton of the dang things sitting in my spares box, gathering dust..</p><p>Communications between the remote sensors and the central microcontroller and button/display interfacing were going to be handled by a couple of satellite PICs talking to the master over an I2C bus (hence the daughter boards in the photograph).  However, things have taken a turn (hopefully for the better) with the introduction of the ESP8266.  I have a couple of ESP-03's and a couple of ESP-12's (and have wasted entirely too much time playing with these wonderful little gadgets) and now plan to put remote sensors and LCD displays on walls (which no longer have to be within a few centimetres of the PIC18) in rooms throughout the house.</p><p><img src="https://cdn.hackaday.io/images/6669791430211637960.jpg" alt="PIC18F27J53 Main Board Schematic" style="display: block; margin: auto;"></p><p>The PIC18 was, up until now, talking to the world via a Lantronix XPort (why? same story ...junk-box) even though it consumes a considerable chunk of power and heats the room almost as well as the woodstove.  However, that too is due to be replaced with either another ESP8266, or a Wiz 5100 (I still rather favour the latter, as a hard-wired connection to the central PIC18 would be preferable and the Wiz 5100 compares very favourably to the ESP8266 in terms of power consumption when communications are active).</p><p>The PIC18F27J53 is nice in that it includes a RTC (as well as a ton of other peripherals and plenty of spare pins), so the idea is that it will have programmable on/off, high/low, normal/quiet settings (accessible via a web page) and also be capable of being overridden by the remote sensor/LCD units if someone wants an immediate blast of warm air, or prefers absolute silence to warmth.</p><h2>The Software/Firmware:</h2><p>The current firmware (such as it is) on the PIC18 was written using JALv2.  I don't see too many projects on the web utilizing this much underrated language, but it is very, very useful (especially for the smaller PICs).  It doesn't have the power, or complexity of C or C++, but it has a lot to recommend as a springboard for novice programmers.  It is simple to use,  easy to pick up, quick to compile and relatively forgiving in the syntax department.  Although it also suffers from that simplicity (in that there are, for instance, no pointers), it does mean it has a very shallow learning curve and, generally speaking, all of the lessons learned when learning JAL will still apply when moving on to something a bit more complex.  It is an ideal language people new to microcontrollers and...</p>
                                
                                    <a class="readmore" href="/post/17014">Read more &raquo;</a>
                                
                            </p>
                        </div>
                    
                    <div class="detail-btns">
                    
                            
                                <span><a href="/post/17014" class="grey-gold-button medium-button show">See all details</a></span>
                            
                    
                    </div>
                </div>

            

            
                
                    <div class="section section-components">
                        <h5>
                            
                                Components
                            
                        </h5>
                        
                            <ul class="section-component-list">
                                
                                    
    <li class="component-45368">
        <span class="component-number">1</span>
        <span class="component-x">×</span>
        <span class="component-content">
            PIC18F27J53
            <span class="component-description">Another magic microcontroller from Microchip</span>
       </span>
    </li>

    <li class="component-45369">
        <span class="component-number">1</span>
        <span class="component-x">×</span>
        <span class="component-content">
            Lantronix XPort
            <span class="component-description">[Deprecated] Will be replaced with the ESP8266 and Wiz5200 modules</span>
       </span>
    </li>

                                
                            </ul>
                        <p>
                            
                            
                        </p>
                    </div>
                
            

            
                <div class="section section-buildlogs">

                    <h5>Project logs</h5>
                    
                    <ul class="buillogs-list post-content details-content">
                    
                        <li>
                            <h2><a href="/project/5474/log/19058-a-different-direction">A different direction...</a></h2>
                            <small class="authorship">2 months ago  &bull;
                            <a class="gray-link" href="/project/5474/log/19058#discussion-list">
                                0 comments
                            </a>
                            </small>
                            <p><p>As mentioned (briefly) in a previous log, I was (note the use of the past tense there!) impressed with the new kid on the block, the ESP8266 and had hatched a cunning plan to  use a bunch of them as remote temperature sensors  and room thermostats for this project.   However, as anyone who has touched an ESP will already know by now, these neat little devices also have an additional feature ...a built in worm-hole which sucks all of the time out of your life space and tunnels it into a black hole in a parallel universe (same place as all of those odd socks end up!).  Trying to do anything with these modules can take the odd couple of centuries (and at the end of that time, you might just end up with someone else's odd sock, rather than a functioning ESP).</p><p><img src="https://cdn.hackaday.io/images/339731433507353094.jpg"></p><p>Recently I've been trying to get the I2C interface to work between an ESP and a DS3231 RTC module (the el-cheapo, middle kingdom version, with the AT24C32 memory chip on the same PCB).  I have it on good authority that it works, as Richard Burton has spent a lot of time putting together libraries for both the <a href="http://richard.burtons.org/2015/04/23/real-time-clock-ds1307ds3231-for-the-esp8266/" target="_blank">DS3231 and the AT24C32 (and his blog is a pretty good read for anyone interested in the ESP)</a>.  However, my attempts to get it to work ended with a pile of odd socks of unknown origin and nothing much else.  &lt;TL;DR&gt; The short story is, if you want to use the I2C funtionality provided by the Espressif IoT SDK, you <strong>must </strong>call :-</p><pre>i2c_master_gpio_init()</pre><strong><em></em></strong><p>   ...before doing anything else (and after having declared which GPIO pins you want to use as SDA and SCL).  This call will set the GPIOs to "open drain" mode and then call the I2C initialize routine before returning.  [The long, Hackaday-fail-of-the-week style story <a href="https://esp8266hints.wordpress.com/2015/06/04/sdk-i2c-code-todays-duh-story/" target="_blank">is here, if you're interested</a>, BTW]</p><p>Okay, so finally I have I2C working and can talk to the DS3231.  As I already mentioned in the main project description, the master microcontroller, the PIC18F27J53 already has a RTC (one of the reasons it was chosen for this project to begin with), so why would I need another?  Well, the DS3231 has a couple of very neat properties.  One is that it has an on-chip temperature sensor (to adjust the internal oscillator for ambient temperature variations) which is not only fairly accurate, but also easy to read (integer part of the temperature in one byte and the fractional part in two bits of the next byte).  It (the DS3231) also has a very versatile alarm setting, allowing easy configuration of repeatable alarms for a wide range of time periods with (importantly) an open-drain output for the alarm output.</p><p>Additionally, the alarms and alarm output are both still available when the DS3231 is running from the back-up, coin-cell battery.  What all of this means is that we can now use the combined ESP8266 + DS3231 module as a standalone, battery-powered temperature sensor or thermostat module, with the main battery only powering the ESP when woken by the alarm from the DS3231.  This should, in theory anyway, get us past the main bugbear of the ESP, its fairly massive current consumption when active.</p><p>We have at least two options for this mode of operation.  The first is to use the DS3231 alarm as an interrupt on the ESP reset pin (instead of connecting it to GPIO16 for normal deep-sleep interrupts) and the second. more interesting one, to use the DS3231 alarm line to control the gate of a small P-channel MOSFET to  switch  VCC to the ESP, for a very nearly zero current  "sleep".</p><p>Stay tuned to find out which of these methods turns out to be the most effective (with the next update due in about, oh, three and a half odd socks).</p>
                                
                            </p>
                        </li>
                    
                        <li>
                            <h2><a href="/project/5474/log/17868-esp8266-esp12-eagle-part">ESP8266-ESP12 Eagle Part</a></h2>
                            <small class="authorship">3 months ago  &bull;
                            <a class="gray-link" href="/project/5474/log/17868#discussion-list">
                                0 comments
                            </a>
                            </small>
                            <p><p><a href="https://github.com/PuceBaboon/Share_the_Warmth/blob/master/eagle/ESP8266-ESP12.lbr">Just added  in an Eagle library file </a>for the ESP-12 with the infamous GPIO04 and GPIO05 pin-swap problem corrected.  I don't have an actual, physical PCB with this part mounted on it yet, so double check the library if you order any boards before I do (I'm a little bit worried that the pad lands may not be wide enough for easy, manual soldering).  Updates welcome!</p>
                                
                            </p>
                        </li>
                    
                        <li>
                            <h2><a href="/project/5474/log/17173-jaluino-bee-v2">Jaluino Bee v2</a></h2>
                            <small class="authorship">4 months ago  &bull;
                            <a class="gray-link" href="/project/5474/log/17173#discussion-list">
                                0 comments
                            </a>
                            </small>
                            <p><h2>Hardware iterations:</h2><p>Once you get your prototype hardware kinda' running, you suddenly find yourself with the issue of carrying on development without breaking what you already have.  For software this is relatively easy,  use CVS, git or whatever your preferred method of source code control is.  For hardware, you pretty much need to have a second unit available so that you can continue to use rev-1 while still developing on rev-1A.  This is all fine and dandy when you've cast your design in stone and had PCBs produced, but becomes a little more time consuming when everything is still on stripboard.  So, I cheated again...</p><p>A while back, [Seb] of the <a href="https://groups.google.com/forum/#!forum/jallib" target="_blank">JALLIB group</a>, very kindly sent me a <a href="http://jaluino.org/category/jaluino-bee" target="_blank">JALuino Bee v2 board</a> for evaluation (it's a great little board and a wonderful advertisement for JALv2 and JALLIB) which I'd played with, but hadn't really put to any good use yet.  The part of this project which I was stumbling over at the time was the XPort implementation (and trying to get a simple, "curses" like library working), so I pressed the "Bee" board into use as a development system, cobbled together with yet another stripboard with the actual XPort and voltage regulator on-board.</p><p><img src="https://cdn.hackaday.io/images/8347941430440186877.jpg"></p><p>It may look a little Heath Robinson, but it works fine and saved me a ton of time over building another complete PIC18 main board.  Thanks again Sebastien, the "Bee v2" rocks!</p>
                                
                            </p>
                        </li>
                    
                    </ul>
                    <p class="log-btns">
                        
                        
                            <a href="/project/5474/logs" class="grey-gold-button medium-button show">
                            
                                View all 5 project logs
                            
                            </a>
                        
                    </p>
                </div>
            

            
                
            
            
            <div class="section section-discussions last">
        <h5 id="j-discussions-title" class="j-discussions-title">Discussions</h5>

    <form id="j-discussion-add-top" action="/discussions/add" name="add-comment" method="POST" class="skip-global-form j-discussion-add hide">
        <div class="textarea-holder">
            <textarea placeholder="Add your comment" name="comment" class="editable input-comment"></textarea>
        </div>
        <input type="hidden" name="categoryId" value="5474" />
        <input type="hidden" name="category" value="project" />
        <input type="hidden" name="_csrf" value="BhuAHMfV-cK8gW7756s7fmJ5DlYbC2auWLSE" />
        <input type="hidden" name="replyTo" value="0" />
        <input type="submit" class="grey-gold-button medium-button" value="Post comment" />
    </form>

    <div id="discussion-list">
        
<p>
    <div class="signup-holder textarea-holder">
        <textarea placeholder="Sign in or become a member to leave your comment" name="comment" class="editable input-comment"></textarea>
    </div>
    <a href="#" class="login-button grey-gold-button medium-button half show">Sign in/up to comment</a>
</p>
<div class="modal-content-holder login-modal" id="login-modal">
    <div class="submissions-close modal-cancel"></div>
    <div class="signup-holder">
        <h2>Become a member</h2>
        <p>In order to follow projects & hackers or give skulls
        <br />you need to create an account.</p>
        <form action="/signup" method="POST">
            <fieldset class="form-left">
                <input type="text" class="input-field" placeholder="Enter your email address" required name="email"  />
                <input type="password" class="input-field" placeholder="Pick a secure password" required name="password"  />
            </fieldset>
            <fieldset class="form-right">
              <button class="gold-gold-button signup" type="submit">Sign up</button>
          </fieldset>
          <input type="hidden" name="_csrf" value="BhuAHMfV-cK8gW7756s7fmJ5DlYbC2auWLSE" />
          <input class="input-field" placeholder="Invitation Code" required name="invitation_code" value="5Ad0ix2-b96J" type="hidden" />
        </form>
        <a id="login-modal-signin" href="/signin">Already a member?</a>
    </div>
</div>








<script type="text/javascript">

    var pageIndex = 0;


</script>
    </div>

    

</div>



        </div>

    </div>

    
        <div class="container">
            <div class="section-recommendations">
                <h2>Similar projects</h2>
                
                    

<div class="project-item   ">

    

    <a href="/project/3253-esp8266-native" class="item-link">
        <div title="ESP8266 Native by Matt Callow" class="project-item-cover"
                
             style="background-image:url(https://cdn.hackaday.io/images/resize/600x600/1858501418113947236.jpg)"
                
                >

        </div>

        
                <div class="project-item-stats">
                    
                    
                        <span class="icon-view-count" title="View Count">24.7k</span>
                    
                    <span class="icon-comment-with-hover" title="Comments">11</span>
                    <span class="icon-view" title="Followers">146</span>
                    
                        <span class="icon-skull" title="Skulls">25</span>
                    
                </div>
         

        <div class="project-item-title ">
            Exploring running native applications on the ESP8266 modules
        </div>
    </a>
    <div class="project-item-headline">
        <span class="project-owner hide">Project Owner</span>
        <span class="project-owner hide">Contributor</span>
        <h3><a href="/project/3253-esp8266-native" title="ESP8266 Native">ESP8266 Native</a></h3>
        <p>by <a href="/hacker/32012">Matt Callow</a></p>
    </div>
</div>
                
                    

<div class="project-item m-last-child  ">

    
        <ul class="submissions-icons">
            
                
                    <li>
                        <a href="/submissions/prize2014/list" class="submission-icon submission-icon-1">
                            Official Hackaday Prize Entry
                        </a>
                    </li>
                
            
        </ul>
    

    <a href="/project/2065-network-pdu-s" class="item-link">
        <div title="Network PDU-S by peter.j.ogden" class="project-item-cover"
                
             style="background-image:url(https://cdn.hackaday.io/images/resize/600x600/8302271406185002308.jpg)"
                
                >

        </div>

        
                <div class="project-item-stats">
                    
                    
                        <span class="icon-view-count" title="View Count">883</span>
                    
                    <span class="icon-comment-with-hover" title="Comments">3</span>
                    <span class="icon-view" title="Followers">44</span>
                    
                        <span class="icon-skull" title="Skulls">9</span>
                    
                </div>
         

        <div class="project-item-title hasBadge">
            Network Power Distribution Unit with Sequencing
        </div>
    </a>
    <div class="project-item-headline">
        <span class="project-owner hide">Project Owner</span>
        <span class="project-owner hide">Contributor</span>
        <h3><a href="/project/2065-network-pdu-s" title="Network PDU-S">Network PDU-S</a></h3>
        <p>by <a href="/hacker/19668">peter.j.ogden</a></p>
    </div>
</div>
                
                    

<div class="project-item  b-last-child ">

    
        <ul class="submissions-icons">
            
                
            
        </ul>
    

    <a href="/project/3380-iot-ethernet-sensor-using-power-over-ethernet" class="item-link">
        <div title="IoT Ethernet Sensor using Power over Ethernet by deandob" class="project-item-cover"
                
             style="background-image:url(https://cdn.hackaday.io/images/resize/600x600/5420511416134259970.PNG)"
                
                >

        </div>

        
                <div class="project-item-stats">
                    
                    
                        <span class="icon-view-count" title="View Count">868</span>
                    
                    <span class="icon-comment-with-hover" title="Comments">0</span>
                    <span class="icon-view" title="Followers">46</span>
                    
                        <span class="icon-skull" title="Skulls">6</span>
                    
                </div>
         

        <div class="project-item-title ">
            This solution has a number of unique benefits, a sensor platform with webserver, powered over Ethernet, accessible and programmed by browser
        </div>
    </a>
    <div class="project-item-headline">
        <span class="project-owner hide">Project Owner</span>
        <span class="project-owner hide">Contributor</span>
        <h3><a href="/project/3380-iot-ethernet-sensor-using-power-over-ethernet" title="IoT Ethernet Sensor using Power over Ethernet">IoT Ethernet Sensor using Power over Ethernet</a></h3>
        <p>by <a href="/hacker/29910">deandob</a></p>
    </div>
</div>
                
            </div>

        </div>
    

    










<div class="footer" id="footer">
  <a href="#header" class="back-to-top" onClick="CT(this, 'Footer', 'GoingUp');">^ Going up? ^</a>
    <div class="container">
        <p><a href="http://hackaday.com/about/">About Us</a> <a href="mailto:projects-contact@hackaday.com">Contact Us</a> <a href="/project/37">Give Feedback</a>&copy; 2015 Hackaday <a href="/tos">Terms of Use</a> <a href="/privacy-policy">Privacy Policy</a></p>
        <a href="/" class="had-skull"  onClick="CT(this, 'Footer', 'Home' ); return false;">Hackaday.io</a>
    </div>
</div>

<script>

    var csrftoken = 'BhuAHMfV-cK8gW7756s7fmJ5DlYbC2auWLSE';

</script>

    <script type="text/javascript">

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47229708-1', 'auto');

    var dimensionValue = 'nonregistered';
    ga('set', 'dimension1', dimensionValue);
    ga('require', 'displayfeatures');

    ga('send', 'pageview');

    </script>

<img src="//analytics.supplyframe.com/trackingservlet/impression?action=pageImpression&amp;zone=HIO_project&amp;extra=logged%3Dfalse%7ChaveAccountCookie%3D0%7C&amp;ab=undefined" class="sf-impression" />
    <div class="j-modal-confirmation modal-background"></div>
<div class="j-modal-confirmation modal-content-holder">
    <p class="align-center" id="modal-message"></p>
    <p class="align-center"><a class="medium-button gold-gold-button delete-project-button" id="modal-yes" href="">Yes, delete it</a> <a class="medium-button grey-gold-button cancel-button" id="modal-cancel">Cancel</a> </p>
</div>

    
    
    
    
    
    
    
    
    
    

    <script src="//cdn.hackaday.io/build/h%2FydgsYIeDTf7pqgYQEKK8Ngblw0IkZCDqfJ9S2tk7zsBoxIHt5iOd49Qp%2BF4vdxEuRj%2BGpGDLbX4aGOQGmbjaOxUZvklg4ReFk68R95OQshFrGKebvogKGQOiB5Hi1xym9KC54c9Ps0WpzuNydLk4B%2FbKi91KhV40Uxhl38XXb1IVAxAI8iW%2BoQUPCFkHVWZxD0B%2BMZ%2BuEXJTlWuBmopNMxTHRK5yleITPZODT6evYhvPcTNHjcVmLti9HxMVov4N%2FG0Vb08G3dKHr8dVQWzXej5t18RehizqZ8wIVJ7qCSmA5v7VaFjCQENYTT0gaQoyhjrODHsQk5JUVvz7t44Dtk%2B11xxmipO4Y%2B9cBwn1IdfK1bYjGht%2Bf1yWZu2SwuQOo6kGY9xwArhHVwpedkUh5kLaSLkPbgFU2aMPMYlr%2FkGi5SGh0159v8zUCbh%2Fx4qqGgiq8xue1QDxwAtojDbMufEMnPeES%2BXUvICUCqPFVF9PsrubQsdtbQAJZsDggl-0.48.6.js"></script>

    <style>
        .mediumInsert-buttons {
            display: none !important;
        }
    </style>

    <div id="submission-popup-back"></div>
    <div id="submission-popup"></div>

    <div id="modal-report-back" class="modal-background"></div>
    <div id="modal-report" class="modal-content-holder container">
        <a href="javascript:void(0);" class="modal-close"></a>
        <form action="/report/project" class="j-modal-form">
            <h2>Report project as inappropriate</h2>

            <p class="intro-text">
                You are about to report the project "<b>Share the Warmth</b>", please tell us the reason.
            </p>

            <textarea name="comment" class="j-report-comment" placeholder="Why do you report the project as inappropriate"></textarea>

            <input type="hidden" name="_csrf" value="BhuAHMfV-cK8gW7756s7fmJ5DlYbC2auWLSE" />
            <input type="hidden" name="projectId" value="5474" />
            <div class="modal-footer">
                <input type="submit" value="Report" class="gold-gold-button"/>
            </div>
            <div class='j-modal-form-message'></div>
        </form>
        <div class='j-modal-message hide'></div>
    </div>



    <div id="modal-contributor-apply-back" class="modal-background"></div>
    <div id="modal-contributor-apply" class="modal-content-holder container">
        <a href="javascript:void(0);" class="modal-close"></a>
        <form id="contributor-apply-form">
            <h2>Send message</h2>

            <textarea name="message" class="j-report-comment">
Hello,

I really like your project and I think I have skills to help you.
            </textarea>
            <p class="application-success">Your application has been submitted.</p>
            <input type="hidden" name="_csrf" value="BhuAHMfV-cK8gW7756s7fmJ5DlYbC2auWLSE" />
            <input type="hidden" name="projectId" value="5474" />

            <div class="modal-footer">
                <input type="submit" value="Send" class="gold-gold-button"/>
            </div>
        </form>

    </div>


    <div id="modal-contributor-remove-back" class="modal-background"></div>
    <div id="modal-contributor-remove" class="modal-content-holder container">
        <a href="javascript:void(0);" class="modal-close"></a>
        <form id="contributor-remove-form">
            <h2>Remove Contributor</h2>
            <p>
                Are you sure you want to remove yourself as a contributor for this project?
            </p>
            <p>Project owner will be notified upon removal.</p>
            <input type="hidden" name="_csrf" value="BhuAHMfV-cK8gW7756s7fmJ5DlYbC2auWLSE" />
            <input type="hidden" name="projectId" value="5474" />
            <input type="hidden" name="remove_contributor_id" id="remove_contributor_id"/>

            <div class="modal-footer">
                <input type="submit" value="Remove" class="gold-gold-button"/>
                <input value="Nevermind" class="gold-gold-button"/>
            </div>
        </form>
    </div>


    <script>
        HIO.projectId = 5474;
    </script>

  </body>
</html>
