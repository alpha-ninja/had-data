<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en" ng-app="buildlogApp"> <!--<![endif]-->
<head>
    
    <title>Project logs &bull; Sol BLE Tracker &bull; Hackaday.io</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" href="//cdn.hackaday.io/css/style.css?version=0.48.6" />
    <script type="text/javascript" src="//use.typekit.net/ymb0lgk.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
</head>
<body class="logs">

    <!--
############################################################################################
############################################################################################
############################################################################################
#####################Kt;tL#######################################Kti,E######################
#######################;   .###################################G    E#######################
#######################K    f##################################    ;########################
########################Wj   E###############################K:  .W#########################
##########################.  :E##############################:  .L##########################
#########################D    f##############################.   .##########################
########################,     ;##############################     :E#######K################
################f######K      ,##############################      ,######Lt################
################  W###W       i##############################       t####j t################
################:  E#L.        f###########################L.        f#Ki .E################
################j  ;E.          j##########################.         .G;  i#################
#################L               i#######################K                ##################
#################W                E#####################K;               ;##################
###################:               .###################D               :f###################
#####################DLfGD           G####WEEEEKW####W           ;GffGK#####################
##########################i         iD##Kfi    :jKW##D          iE##########################
###########################W      ,G##f            jE#E;       j############################
############################L     D##D              ,##K       W############################
#############################D:  G#W                  K#E,   G##############################
###############################;i#L                    j## ,E###############################
###############################KK#.                     ##iE################################
#################################j                      ;K##################################
################################W                        ,##################################
################################E                         ##################################
###############################Ki                         D#################################
###############################E.                         L#################################
###############################f    iD##W;       D###D    :#################################
###############################i   i######K     K#####K;   #################################
###############################;  .E#######     #######D   #################################
###############################;  L########     ########   #################################
###############################i  G#######K     K#######   #################################
###############################j  L#####E,       fE#####   #################################
###############################D  .E##j            .t##E  ;#################################
###############################E:  ;##.              #Wt  j#################################
################################G   ;t      tWi      t    E#################################
#############################KL##           K#K;          #K:K##############################
#############################i ##:          ###t         j#f ;K#############################
############################:  G#K          #E#L        L##    D############################
###########################D   ;W#:         #;#L        W#K    .############################
#####################KKEKK      :##L        ; ..      :D##.      fKEEK######################
###################t.            ;##G:               ,##E,             tD###################
##################G               E##E               i##;               :###################
#################D                W##W    iL    E.    ###D                ##################
################W,               G###W    tG    K.    ####:               K#################
################;  LW;         ,E#####:  ;W#    #G   f#####;         ;KG  :K################
################  D###E       ;########WW####WW####WW#######W       :####: j################
################ ,#####:      ;##############################       G####E i################
################K#######.     ;##############################      L######WG################
########################f     i##############################     j#########################
#########################W   .D##############################.   i##########################
#########################E   G###############################D   ,##########################
########################G:   #################################j   G#########################
#######################f    K##################################j    W#######################
#####################Kt :iE#####################################KL:  K######################
############################################################################################
############################################################################################
############################################################################################
-->

<div class="header" id="header">
    <div class="container">
        <h1 class="logo">
            <a href="/" title="Hackaday.io Home" class="home" onclick="CT(this, 'Menu', 'Home'); return false;"></a>
            <a href="/" title="Hackaday.io Home" class="brand" onclick="CT(this, 'Menu', 'Home'); return false;">Hack a Day</a>
        </h1>

        <a href="javascript:void(0);" class="responsive-menu">Menu</a>

        <ul class="nav" role="navigation">
            <li><a href="/projects" class="">Projects</a></li>
            <li><a href="/lists" class="">Lists</a></li>
            <li><a href="/stack" class="">Stack</a></li>
            <li class="dropdown more-nav j-more-open">
                <a href="javascript:void(0)" class="dropdown-link icon-dropdown">More</a>
                <ul role="menu" class="dropdown-menu more-menu" id="j-more">
                    <li><a href="http://hackaday.com/blog/" target="_blank">Blog</a></li>
                    <li><a href="/events">Events</a></li>
                    <li><a href="/hackerspaces">Hackerspaces</a></li>
                    <li><a href="/hackers">Profiles</a></li>
                    <li><a href="/contests">Contests</a></li>
                    <li><a href="/prize" target="_blank">The Hackaday Prize</a></li>
                    <li><a href="/submissions/prize2015/list">2015 Prize Entries</a></li>
                </ul>
            </li>
            <li class="menu-last-child">
                <div class="search-holder show">
                    <form id="search-form" action="/search" onsubmit="return submitSearch();" method="GET">
                        <input type="text" placeholder="Search" name="term" class="input-search j-add-search" id="j-add-search" value="" autocomplete="off" pattern=".{3,}" required title="3 characters minimum" />
                        <input type="submit" class="search-button" />
                    </form>
                </div>
            </li>
        </ul>

        

            <ul class="nav pull-right" role="navigation">
                <li><a href="/signup" class="grey-white-button become-member">Sign up</a></li>
                <li><a href="/signin?returnUrl=%2Fproject%2F6919%2Flogs%3Fpage%3D1">Sign in</a></li>
            </ul>

        
    </div>
</div>

<div id="topMessage" class="alert"><span class="j-top-content"></span><a href="javascript:void(0);" class="alert-close j-top-message-close">Close</a></div>




    <div class="headline">
        <div class="container">
            <h2><a href="/project/6919-sol-ble-tracker">Sol BLE Tracker</a></h2>
            <p class="description-title"> Project logs</p>
            <p class="description-summary">Solar powered Bluetooth Low Energy Tracker with beeper and LED to assist in locating it.</p>
            <div class="description-metainfo">
                
                    <span>created by <a href="/hacker/11454-dryerzinia" title="Visit Profile">DrYerzinia</a><span>&bull;</span>
                
                25 days ago<span>&bull;</span><a href="/project/6919#discussion-list" title="See Comments">3 Comments</a></span>
            </div>
        </div>
    </div>

    <div class="container post-content">
        <div class="section-buildsort">
            <span class="pull-left">
                <a href="/project/6919-sol-ble-tracker">&#171; Back to project details</a>
            </span>
            <span class="sort-holder pull-right">
                <label for="sort-by">Sort by:</label>
                <select class="sort" id="sort-by">
                    <option value="/project/6919/logs/sort/newest">Newest</option>
                    <option value="/project/6919/logs/sort/oldest" selected="selected">Oldest</option>
                </select>
            </span>
        </div>
        <div class="section section-buildlogs last">
            

                <ul class="buillogs-list">
                    
                        <li>
                            <h2><a href="/project/6919/log/21490-current-status">Current Status</a></h2>
                            <small class="authorship">25 days ago  &bull;
                                <a class="gray-link" href="/project/6919/log/21490#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-21490"><p>I&apos;ve already done a lot of work prior to creating this project on <span class="J-JK9eJ-PJVNOc">hackaday</span> so this is just an overview of the past.</p><p>So
 far there have been 3 prototypes.  The first was eaten by my dog.  It 
was tested by Fiona for several days.  It was discovered that the 
&quot;<span class="J-JK9eJ-PJVNOc">SuperCaps</span>&quot; I had selected where more like batteries.  They couldn&apos;t 
discharge fast enough to drive the Buzzer and couldn&apos;t charge fast 
enough to be reasonable.  This led to my exploration of other options.</p><p><img alt="Origional prototype with &#34;Super Caps&#34; made on very thin board." style="display: block; margin: auto;" src="https://cdn.hackaday.io/images/5271091437869746206.jpg"></p><p><img alt="Wrapped safely in silicone tape. Those cells where way to small to be useful." style="display: block; margin: auto;" src="https://cdn.hackaday.io/images/6529241437869871586.jpg"></p><p><img alt="Apparently the doggy doesn't have enough chew toys so he has to resort to stealing my prototypes off of tables." style="display: block; margin: auto;" src="https://cdn.hackaday.io/images/7515311437869962951.jpg"></p><p>The
 second prototype was designed with a footprint for a rechargeable 
lithium coin cell.  This also proved not to be able to supply the 
necessary current for the buzzer.  Even with a large 100uF+ capacitor to
 buffer it couldn&apos;t keep up.</p><p><img alt="Swapped out that lame coin cell for a 40mAH LiPo!" style="display: block; margin: auto;" src="https://cdn.hackaday.io/images/4017141437870128367.jpg"></p><p>The third prototype just had an 1206 
footprint on the edge to connect a second power board so I could 
experiment with alternate battery source.  I had wanted something super 
thin and the thinnest <span class="J-JK9eJ-PJVNOc">LiPo</span> I could find was still about 5mm thick.  That 
is what I used for the 3rd and was the only power storage option that 
worked.</p><p><img alt="Replaceable Power Board on the end!  Ultimatly that was totaly poinless LiPo is the only way to go it seems." style="display: block; margin: auto;" src="https://cdn.hackaday.io/images/7572861437870281120.jpg"></p><p>I wired up the second prototype with the same battery as I
 was using for the 3rd and put them on Jasper and Fiona for testing.  
For insulation I sandwiched the boards between 2 layers of Silicon 
tape.  They lasted for about 3 days before problems started occurring.  
The copper clad film was tearing around the Micro <span class="J-JK9eJ-PJVNOc">USB</span> connector and 
cutting off the ground from the power.  I expect the professionally 
produced Flexible <span class="J-JK9eJ-PJVNOc">PCB&apos;s</span> will not have this problem.  The batteries had 
hardly lost any juice over the 3 days and I estimated they would have 
lasted at least 4 months between charges.</p><p>The 4th prototype design 
which I am waiting on parts for using a different solar charge circuit as
 well as on board battery protection.  I also found some flexible <span class="J-JK9eJ-PJVNOc">LiPo</span> 
<span class="J-JK9eJ-PJVNOc">batterys</span> to use so the whole unit Batter+Solar cell +PCB will be able to 
conform to the shape of the cat collar.  I also opted for the use of 
much smaller transistor packages as well as a Buzzer 1/4 the size of the
 previous one.  The <span class="J-JK9eJ-PJVNOc">BLE</span> radio was upgraded to the Long Range version to 
boost the detectable range of the collar.</p><p><img alt="The old uneaten prototypes sans batteries as well as the future, a flexible solar panel and flexible 0.5mm thick battery." style="display: block; margin: auto;" src="https://cdn.hackaday.io/images/1815371437782181583.jpg"></p><p>By the end of next week I
 will have the 4th and hopefully final prototype of the electronics 
board.  For packaging I intend to print a flexible rubber case to fit 
over the components and meld with the battery and solar panel.<br></p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/6919/log/22193-sol-ble-tracker-prototype-4-update">Sol BLE Tracker Prototype 4 Update</a></h2>
                            <small class="authorship">13 days ago  &bull;
                                <a class="gray-link" href="/project/6919/log/22193#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-22193"><iframe width="420" height="315" src="https://www.youtube.com/embed/r21RYZcHSHE" frameborder="0" allowfullscreen=""></iframe><p>A quick update on the status of the Sol BLE Tracker.  I&apos;m just repeating whats in the video above in text down here so if you watched it there is nothing new below.</p><p>I&apos;m currently working on producing the 4th prototype of the tracker, due to the smaller packages I used to save space I&apos;ve been having some trouble with the soldering.  I got everything on alright but while trying to rework a resistor when it somehow shorted to another trace underneath where I couldn&apos;t see I tore off a trace that went under a DFN transistor 1mm x 0.6mm and that made the battery protection section basicly a lost cause.  I&apos;m planning on changing that section to a LTC4071.  Its a combined LiPo battery protection circuit as well as charger.  It has lower quiescent current and requires less external components.  No transistors in particular.  Its also an MSOP-8 which will be much easier to solder than the 2 DFN transistors and the DFN charger package as well as taking up less overall space.  The only downside is its only rated for 60mA current which the buzzer should draw more than.  I think I can get around this with some decoupling capacitors near the buzzer.  In the current design however both the charger and battery protection where tested to be working.</p><p><img src="https://cdn.hackaday.io/images/9504541438826815070.png"></p><p>I continued to assemble the board despite this SNAFU when I discovered I did not order the 4.42M ohm 0402 resistors.  These are part of the solar charge circuit.  I&apos;m going to try and get some 4.7M ohm 0805 resistors in there place to test with.  I want to measure the current to or from the battery in various lighting conditions to make sure the charger is working as expected.</p><p><img src="https://cdn.hackaday.io/images/9115131438827063092.png"></p><p>You can see in the picture below one of the NPN DFN transistors I used for the buzzer.  I&apos;m going to swap these out with SOT-923F package transistors which have leads.  This way if something goes wrong I don&apos;t have to scrap the section they are in because of it and it will be much easier to solder them.  They are bout the same size as the DFNs anyway.  I changed to a smaller buzzer in this design it takes up about a quarter of the space the old one did.  Another thing to note is all the jumper resistors.  They are only in this design for ease of construction.  The production PCBs will be made by FlexPCB.  I&apos;m going to use a second layer for the jumpers and use the bottom layer as a ground plane as well which should also help RF performance.</p><p><img src="https://cdn.hackaday.io/images/645741438827175311.png"></p><p>Expect an update about the current measurements to the battery from the solar charger in the next few days.</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/6919/log/22262-solar-power-measurments">Solar Power Measurments</a></h2>
                            <small class="authorship">12 days ago  &bull;
                                <a class="gray-link" href="/project/6919/log/22262#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-22262"><iframe src="https://www.youtube.com/embed/bQrd-05p5dg" allowfullscreen="" frameborder="0" height="315" width="560"></iframe><p>So I did the measurements on the power and I&apos;ll just get strait to the point here:</p><p>In direct sunlight it was charging at ~2mA.  That
 works out to needed 7.2 minutes a day of direct sun to keep the device 
operating or for a full charge of the battery 5 hours of direct sun.  So
 if your cat likes to sun itself for atleast 7.2 minutes a day or 5 hours
 a month you will never have to charge the collar.  I measured about 80,000 LUX in this environment.</p><p>Alternatively
 on a sunny day the ambient light generates ~30uA of charge current.  
That&apos;s 3x the devices power requirement.  So if the collar only gets 
ambient light 8 hours a day it should still be able to never need charging.  I measured my ambient lighting at ~300 lux.</p><p>Those
 are the practical figures.  Now I will go on telling the story of the 
adventure I had building and testing the circuit.  First problem was 
fitting the bodge resistors on the board.</p><p><img src="https://cdn.hackaday.io/images/7526601438904632357.jpg"></p><p>There not technically bodge resistors, just oversized ones because I forgot </p><p>to order the 0402&apos;s which will now be here on Saturday.  I managed to barley get them in.</p><p>The next set back wasn&apos;t detected till I 
started probing the circuit.  After applying sun to the cell I didn&apos;t 
get any boost conversion going.  The chip wasn&apos;t loading down the cell 
and I got less voltage out than in!</p><p>So a quick look at the 
recommended application circuit schematic and I realized *DOE* I forgot a
 connection from VSolar to the VIn off the chip!</p><p>Time to add a bodge wire.</p><p><img src="https://cdn.hackaday.io/images/6281421438905054661.jpg"></p><p>So I bodged in a wire from the resistor on the VIN to the inductor on the VSolar.  And IT WORKED!</p><p>Only
 one strange problem, the voltage of the solar cell was oscillating up 
and down.  Another trip to the datasheet and I understood why.  The MPPT
 algorithm works on a 16 second cycle.  It samples the unloaded solar 
cell voltage through a resistive divider which in this case give 73% of 
open circuit voltage and stores that in a capacitor for reference.  Then
 feedback from that voltage its used to determine how much current to 
pull from the solar cell to boost its output to charge the battery.  My 
first thought after looking at the circuit was just how very close that 
capacitor was to shorting back across itself to ground.  And I did a bit
 of rework to move its important end to be more isolated.  Broke a trace
 doing it and added another bodge wire.</p><p><img src="https://cdn.hackaday.io/images/6761231438905067647.jpg"></p>You can see roughly the operation of that section of the circuit in the above image.  After the rework, a thorough cleaning with isopropyl alcohol and some time for the alcohol to evaporate I had a much smaller oscillation.  Only about 200 mV peak to peak or 7% full scale.  I expect this figure to improve on a professional board where the whole thing will be reflowed with solder paste.  Much less residue to reduce resistance between the sides of the capacitor.  I am using the recommended X7R capacitor type for minimal leakage so it can&apos;t be that.<p>Now that everything was working its time to test the circuit performance under real world lighting conditions the results of which are at the top of this post.</p><p><img src="https://cdn.hackaday.io/images/7002581438905404581.jpg"></p>The location of the first setup.  Full direct sun with occasional leaf <p>interference.  Yes the tree got in the way for a bit.  And with 80kLux </p><p>we get a charge of atleast 2 <span class="J-JK9eJ-PJVNOc">mA</span>.  Way more than enough to charge and run </p><p>the collar.</p><p><img src="https://cdn.hackaday.io/images/9565291438905539449.jpg"></p><p><span class="redactor-invisible-space">The next setup was on the </span>back of the couch in the main TV room.  The moment I started recording Fiona hopped up to check out what was going on and unexpectedly landed on the circuitry.  Here I recorded 300 lux with my phone and a respectable 30uA current.  Enough to run the circuit and charge at 2x the operating current.<span class="redactor-invisible-space"><br>I took</span> away a few things from this experiment, first solar powered harvesting devices for radio networks have to be ridiculously efficient if they don&apos;t get direct sunlight.  Ambient light at 300 lux is nothing compared to the raw 80000 lux power of direct sunlight. That&apos;s 260x more energy in direct sun!  But thankfully with my designs 10uA current draw we can still pull it off with low light levels if we have to and as a last resort you can always charge the battery with micro USB.</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/6919/log/22489-more-light-tests">More Light Tests</a></h2>
                            <small class="authorship">8 days ago  &bull;
                                <a class="gray-link" href="/project/6919/log/22489#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-22489"><p>The power supply section of the revision 5 board of the Sol BLE Tracker is built.  And of course its time to test how much charge current I get.  In these tests its drawing all the quiescent current it would normally minus the 1.6 uA of the BLE radio.</p><iframe width="560" height="315" src="https://www.youtube.com/embed/9Pj6OSwIxic" frameborder="0" allowfullscreen=""></iframe><p><img src="https://cdn.hackaday.io/images/8354141439281768074.jpg"></p><p>Revision 5 minus the radio.</p><p><img src="https://cdn.hackaday.io/images/9218151439281173617.jpg"></p><p>Above you can see the by the window couch test.  992 lux on a sunny day providing 76uA of charge current.  7x more than enough to run the system.</p><p><img src="https://cdn.hackaday.io/images/849151439281133003.jpg"></p><p>The readings from the real world tests are not a nice strait line and I suspect this is because of how much the angle of incidence affects the lux meter on my Galaxy S6 Active but we can still draw some useful conclusions from it.  The main thing to take away is that on a sunny day in the open areas of the house the ambient light is going to be enough to charge the system.  Also if the cats spend just a few minutes a day in direct sunlight it will have no problem running forever without having to attach an external charger.</p><p><img src="https://cdn.hackaday.io/images/9050661439281104345.jpg"></p><p>In the data for the microscope light test you can see a small jump where it also changes slope.  That was where I moved the light physically closer rather than varying the input voltage to get a higher lux reading.  The first set of sets showed a slope of 25 lux/uA.  The second set 42/uA.  The main takeaway here is we should expect to need 300+ lux to run the system.  With a proper lux meter the real world measurements would likely match this figure as the angle of incidence problem would be solved.  I expect this test to be fairly accurate as all the light is coming from one direction however the LED spectrum is not the same as sunlight.</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/6919/log/22839-sol-ble-tracker-r6-current-consumption-tests">Sol BLE Tracker r6 Current Consumption Tests</a></h2>
                            <small class="authorship">4 days ago  &bull;
                                <a class="gray-link" href="/project/6919/log/22839#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-22839"><p>Before I get into the tests an update about the last week.  I have a lot of footage and pictures from testing to go through still and make some videos and more logs because I was crunched for time to make the 3 prototypes to send in for the best product competition and didn&apos;t have time to edit the videos and write up the projects logs so expect a lot of stuff this weekend.</p><iframe width="560" height="315" src="https://www.youtube.com/embed/lKFf3RvCbi4" frameborder="0" allowfullscreen=""></iframe><p>This set of tests analyzes the current consumption of the device with various beacon rates advertising only on channel 39.  The test was conducted by running the device from a capacitor and calculating how much energy was drained from the capacitor by measuring the voltage change.  This information was then converted to a average current consumption figure.</p><p><img src="https://cdn.hackaday.io/images/6205631439605418426.png"></p><p>Above you can see a picture of the setup.  I use the stopwatch on my phone to measure the time elapsed, a Fluke 87V to measure voltage, and a 1000uF cap as the power storage.  The test is started by unplugging the USB power to the circuit.  We can use all this information to calculate current consumption by the following formulas:</p><p>First we calculate power consumption by taking the difference of the energy in the capacitors divided by elapsed time.</p><p><img src="/api/latex?tex=%5Ccolor%7BWhite%7D%20%5Clarge%20%5Cfrac%7B(%5Cfrac%7B1%7D%7B2%7D%20%5Ccdot%20F_%7Bcap%7D%20%5Ccdot%20V_0)%20-%20(%5Cfrac%7B1%7D%7B2%7D%20%5Ccdot%20F_%7Bcap%7D%20%5Ccdot%20V_f)%7D%7B%5CDelta%20t%7D%20%3D%20W"></p><p>Next we estimate the power drained by the meter at the low voltage point so our estimate is conservative.</p><p><img src="/api/latex?tex=%5Ccolor%7BWhite%7D%20%5Clarge%20%5Cfrac%7BV_%7Bfinal%7D%5E2%7D%7BR_%7Bmeter%7D%7D%20%3D%20W_%7Bmeter%7D">We subtract the estimated meter power consumption to get the power consumed by the device under tests.</p><p><img src="/api/latex?tex=%5Ccolor%7BWhite%7D%20%5Clarge%20W%20-%20W_%7Bmeter%7D%20%3D%20W_%7BDUT%7D">Finally we divide power by the midpoint voltage of the test to calculate average current consumption</p><p><img src="/api/latex?tex=%5Ccolor%7BWhite%7D%20%5Clarge%20%5Cfrac%7BW_%7BDUT%7D%7D%7BV_%7Bmidpoint%7D%7D%20%3D%20A_%7Bavg%7D">Plugging in for everything we end up with for the 10.24 second interval case:</p><p><img src="/api/latex?tex=%5Ccolor%7BWhite%7D%20%5Clarge%20%5Cfrac%7B(%5Cfrac%7B1%7D%7B2%7D%20%5Ccdot%201107uF%20%5Ccdot%204.196v%5E2)%20-%20(%5Cfrac%7B1%7D%7B2%7D%5Ccdot%201107%20uF%20%5Ccdot%204.012v%5E2)%7D%7B%2060s%7D%20%3D%2013.93225%20uW"><img src="/api/latex?tex=%5Ccolor%7BWhite%7D%20%5Clarge%2013.93225%20uW%20-%20%5Cfrac%7B4.012v%5E2%7D%7B11.0855M%5COmega%7D%20%3D%2012.48025uW"><img src="/api/latex?tex=%5Ccolor%7BWhite%7D%20%5Clarge%20%5Cfrac%7B12.48025uW%7D%7B%5Cfrac%7B4.196v%20%2B%204.012v%7D%7B2%7D%7D%20%3D%203.04099uA">So for a advertising interval of 10.24 seconds we get an average current consumption of  ~3uA.</p><p><img src="https://cdn.hackaday.io/images/1539971439608390508.jpg"></p><p>Above are the plots for the current consumption.  By inverting the advertising interval to get advertisements per second we get a graph that has a linear relationship.  Running a linear regression on that we get:</p><p><img src="/api/latex?tex=%5Ccolor%7BWhite%7D%20%5Clarge%20uA%20%3D%2037.277370425102%20%5Ccdot%20(%5Ctext%7Bpackets%2Fs%7D)%20%2B%202.4100354157607"></p><p>So now we can estimate current consumption from the advertisement interval.  The correlation coeffecent for this line is 0.999489068 so it is a very good fit.</p><p>In addition to testing current consumption I also did a bit of testing how hard it was to connect to the devices at each advertisement interval.  Unfortunately it turns out to be nearly impossible to connect to a device at distance with an interval over 1 second.  To maintain the low 10uA current consumption and improve range I am going to modify the firmware to beacon with a 320mS interval every 120 seconds for 10 seconds.  This means to connect to the device you will have to wait up to 110 seconds for the packet burst.  But once connected communication is continuous so its easier to find the device from that point on.<br></p><p>Another thing I will have to test is to see how multi-channel advertising works.  It might send a packet on each of the 3 advertising channels each interval in which case that would triple the current consumption.  If this is the case I will have to either decrease the interval to 1 second or only do the burst every 6 minutes to maintain the 10uA.  The problem with the single channel advertisements is that when and Android device scans for BLE devices it seems to linger on each channel for several seconds rather than rapidly jumping which means it could miss the entire burst on a single channel.  You can see this behavior in the image below.</p><p><img src="https://cdn.hackaday.io/images/1719661439607833744.png" width="186" height="329" style="width: 186px; height: 329px;"></p><p>The blue line is the signal from the r6 prototype.  The red from r2.  r2 is using a 320mS interval on all advertising channels while r6 is using a 320mS interval on only advertising channel 39.  you can see the large 7 second gaps in reception where it stops scanning channel 39.</p><p>And finally a close up of the first revision 6 prototype fresh off the soldering iron.</p><p><img src="https://cdn.hackaday.io/images/9902471439607438718.jpg"></p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/6919/log/22844-shipped-3-best-product-prototypes">Shipped 3 Best Product Prototypes</a></h2>
                            <small class="authorship">4 days ago  &bull;
                                <a class="gray-link" href="/project/6919/log/22844#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-22844"><p>Managed to finish all 3 prototypes just in time.  Testing completed at 7:30AM after working 16 consecutive hours to get the last 2 done.  30 minutes before the post office opens.  I have pretty much worked nonstop, every moment of my free time this last week to get these prototypes ready to ship.  And I just barley made it.</p><p>Tested working before shipping.  You can see the 3 devices detected on the scanner app on the phone in the background.  If you are the person at hackaday trying to test my prototypes and you can&apos;t scan them an important note.  They are shipped with the battery protection IC in shipping mode.  You have to briefly apply power to them on the micro USB port to activate them.  When you do be careful because the PCB is super thin polyimide film so its best to firmly grip the device by the micro USB connector when plugging and unplugging or you may tear the polyimide film and trace on it.</p><p><img src="https://cdn.hackaday.io/images/8020571439609762921.JPG"></p><p>Odd one out.  Only had 2 working flexible LiPO batteries left so the last prototype had to use a bigger different battery.  What it lost in thickness it more than makes up for in battery life.</p><p><img src="https://cdn.hackaday.io/images/8013421439610900388.JPG"></p><p>Solar panels strapped on.  Not exactly the most stable configuration but it will do.  It pretty much does everything but stay attached to a cats collar.  Look out for a post this weekend showing the 3D printed case prototype.</p><p><img src="https://cdn.hackaday.io/images/2678491439610800498.JPG"></p><p>On the way to the post office, got the address and the trackers.  Sending it overnight.</p><p><img src="https://cdn.hackaday.io/images/854761439610843329.jpg"></p><p>The fallen comrades of revision 6.  Some obsolete still work, some had the FR4 epoxy erupt under IR rework, some didn&apos;t etch right.  All in all I&apos;ve made a lot of freaking boards and soldered a lot of tiny tiny parts.  You can see I was rather stingy with the radios as they are the most expensive part.  Putting it on last and only if everything else was functional.</p><p><img src="https://cdn.hackaday.io/images/8975641439610987113.jpg"></p><p>Now I just have to make another one for testing over the weekend...</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/6919/log/23002-advertisement-burst-testing">Advertisement Burst Testing</a></h2>
                            <small class="authorship">3 days ago  &bull;
                                <a class="gray-link" href="/project/6919/log/23002#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-23002"><p>I made myself a 4th copy of the revision 6 prototype after sending off the first 3 to hackaday.</p><p><img src="https://cdn.hackaday.io/images/314971439708968788.jpg"></p><p>Its missing the LTC4071 and battery because I&apos;ve run out.  I had to scavenge some of the parts from older prototypes.  Now that I got paid again this week I can order more parts to finish it.</p><p>The first test I did was a comparison of current consumption between single channel advertising and all three channel advertising.  I tested with the 1 second interval which I had previously recorded an average current consumption of  17.35368 uA.</p><p><img src="/api/latex?tex=%5Ccolor%7BWhite%7D%20%5Clarge%20%5Cfrac%7B(%5Cfrac%7B1%7D%7B2%7D%5Ccdot%201107%20%5Cmu%20F%20%5Ccdot%205.121v%5E2)-(%5Cfrac%7B1%7D%7B2%7D%5Ccdot%201107%20%5Cmu%20F%20%5Ccdot%5C%202.956v%5E2)%7D%7B71s%7D%20%3D%2013.632241%20%5Cmu%20W%20"><img src="/api/latex?tex=%5Ccolor%7BWhite%7D%20%5Clarge%2013.632241%20%5Cmu%20W%20-%20%5Cfrac%7B3.472v%5E2%7D%7B11.0855M%5COmega%7D%20%3D%2013.553417%20%5Cmu%20W"><img src="/api/latex?tex=%5Ccolor%7BWhite%7D%20%5Clarge%20%5Cfrac%7B13.553417%20%5Cmu%20W%7D%7B%5Cfrac%7B5.121v%20%2B%202.956v%7D%7B2%7D%7D%20%3D%2033.56052%20%5Cmu%20A">33.56 uA which is about double the single channel advertisement.  I has expected triple but I guess the time spent switching between active and power mode 2 is a significant amount of the power used transmitting so when you average that in with the actual time spend advertising it end up only needing 2x as much current.  Knowing this I can calculate how well my idea of using a 640mS interval for a 10 second burst every 2 minutes will work out.</p><p><br><img src="/api/latex?tex=%5Ccolor%7BWhite%7D%20%5Clarge%20%5Cfrac%7B10s%20%5Ccdot%202%20%5Ccdot%2061.33696%5Cmu%20A%20%2B%203.04099%5Cmu%20A%20%5Ccdot%20110s%7D%7B120s%7D%20%3D%2013.0104008333%20%5Cmu%20A">That&apos;s pretty close to being my goal of 10uA so I programmed it in and tested it.  I ended up measuring 15 uA.</p><p>Now that I had it working with appropriate current consumption I needed to see how hard it was to connect to.  The first thing I discovered was that the autoConnect feature of androids BLE API is nowhere near aggressive enough to catch it in the 10 seconds.  It occasionally got it but I would have to wat 5-10 minutes!  But I guess its designed to run in the background all the time so it has to be rather power conservative.  When I write my Android app I&apos;ll be sure to write a foreground service that attempts to connect more aggressively.  When I watched the scanner and hit connect when I first saw it I managed to get a connection every try even when I was outside on the far corner of the house with a signal strenth of 96 dBm.</p><p>These results are quite good.  A purpose built device in the house would be able to monitor BLE and alert you by text message if it missed 2 burst periods and should be quite reliable.  And scanning with the phone anywhere in the house should always find that cat within 2 minutes.  This coupled with the fact that we can run on only 15 uA means we have a workable solar powered BLE tracker!  I&apos;m going to print the first prototype case tonight so expect info on that tommorow.</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/6919/log/23277-first-shot-at-a-case">First shot at a case</a></h2>
                            <small class="authorship">2 days ago  &bull;
                                <a class="gray-link" href="/project/6919/log/23277#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-23277"><iframe width="560" height="315" src="https://www.youtube.com/embed/w0OkOXmOvtg" frameborder="0" allowfullscreen=""></iframe><p>This was my first attempt at printing the case design.  This model is designed to have the collar threaded through it.  Its low profile about 4mm thick.  The solar cell sets in the cavity&apos;s at the top and the board sits in the well below with holes for the buzzer and the micro USB.  I haven&apos;t figured out what to do with the LED yet it will clearly need some form of light pipe.</p><p><img src="https://cdn.hackaday.io/images/1869141439801125110.png"></p><p>The model looks nice but unfortunately my 3D printer is just not up to snuff to print it.</p><p><img src="https://cdn.hackaday.io/images/2739971439801402000.jpg"></p><p>You can see one of the walls is destroyed and its all kinds of messy.  I currently have a very limited 3D printer.  It has no heated bed, a remote extruder, no extruder fan and there is a space between the knurling bolt and the tube that allows the filament to pinch so I have to be vigilant and push it in with a screwdriver so it keeps feeding to print flexible filament.</p><p><img src="https://cdn.hackaday.io/images/5900051439801529229.jpg"></p><p>I could add a heated bed but I don&apos;t think a direct feed extruder is possible with this design, some one correct me if I&apos;m wrong.  Right now I&apos;m looking to get a TAZ 4, hopefully I&apos;ll have some money for that in the next couple of months.</p><p>The case should work If I get it to print right.  I&apos;ll try again soon.</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/6919/log/23293-best-product-requirements">Best Product Requirements</a></h2>
                            <small class="authorship">2 days ago  &bull;
                                <a class="gray-link" href="/project/6919/log/23293#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-23293"><p>All non hackaday people can ignore this post I just am putting this up so they can easily find all the requirements for the best product contest.<br></p><p><span class="GramE"><strong>Entry Round (Stage 1)</strong>.</span>Complete the following steps</p><p>i.Personal Profile. Create a personal profile on hackaday.io, completing all required fields and following all instructions (required of each Participant, including each member of a team).</p><ul><li>Obviously if this project exists this happened</li></ul><p>ii.Project Profile. Create a project profile on hackaday.io, completing all required fields and following all instructions (&#x201C;Project Profile&#x201D;). Tag the Project Profile with: HackadayPrize.</p><ul><li>Obviously if this project exists this happened</li></ul><p>iii.On the Project Profile:</p><p>a)Discuss the problem which has been chosen as the subject of the project</p><ul><li>In the details section</li></ul><p>b)Discuss how this project will work to alleviate or solve the problem</p><ul><li>In the details section</li></ul><p>c)Publish at least one (1) image to help illustrate how the project might be used. This may be a sketch, schematic, flow chart, rendering, or other type of image.</p><ul><li>Third image in the gallery</li></ul><p><span class="GramE"><strong>Quarterfinals (Stage 2)</strong>.</span> By 1:50 p.m. P.D.T. on August 17, 2015, complete the following steps:</p><p>i.Complete all Stage One requirements</p><ul><li>See above</li></ul><p>ii.Video. Create a video, no more than two (2) minutes in <span class="GramE">length, that</span> shows the prototype in progress (i.e., what works, what does not work, what the Participant wants to improve). The video does not need to be &#x201C;studio quality.&#x201D; Upload the video to YouTube or Youku and tag the video with the keywords: HackadayPrize, quarterfinals.</p><p><iframe width="500" height="281" src="//www.youtube.com/embed/7UOP6nT7XNQ" frameborder="0" allowfullscreen=""></iframe></p><p>iii.Project Profile. On the Project Profile:</p><p>a)Link to the video</p><ul><li>See external links section on project page</li></ul><p>b)Update and add detail to info entered at the Entry Round stage</p><ul><li>See project logs and details section (In details updated chip change and net change from r4 to r6)</li></ul><p>c)Show at least four (4) Project Log updates</p><ul><li>Not including this log that&apos;s not really related I am up to 8</li></ul><p>d)Link to any repositories (e.g., Github)</p><ul><li>See external links section, code, schematic, licensing, 3D models all in git repo.</li></ul><p>e)Post a system design document, including a preliminary components list. The system design document should show what is working and what the Participant is building toward</p><ul><li>See external links, system design document was rather vague, should it be a picture of the system architecture, should it be everything.  So I went all out and typed up a fairly detailed technical paper describing the system and testing done on it.  More info to come soon to that I still want to describe the operation of the solar charge circuits and the quirks I experienced using it.</li><li>Currently posted system design document does not contain component list I&apos;ll get right on that but remember its all on the project page!</li><li><strong>UPDATE:</strong> Design Document has parts list!</li></ul><p>f)Document all open-source licenses and permissions as well as any applicable third-party licenses/restrictions</p><ul><li>The UNLICENSE, mentioned in details section as well as being in root of git REPO.  Do what you want with it.</li></ul><p><span class="GramE"><strong>Semifinals (Stage 3)</strong>.</span> By 1:50 p.m. P.D.T. on September 21, 2015, complete the following steps:</p><p>i.Video. Create a video, no more than five (5) minutes in <span class="GramE">length, that</span> shows a near complete prototype (i.e., what works, what does not work, what the Participant wants to improve). The video should describe the problem it is solving and demonstrate how it facilitates the solution. The video does not need to be &#x201C;studio quality.&#x201D; Upload the video to YouTube or Youku and tag the video with the keywords: HackadayPrize, semifinals.</p><p><iframe width="500" height="281" src="//www.youtube.com/embed/UpAWcF0HR8o" frameborder="0" allowfullscreen=""></iframe></p><ul><li>Yes I know its the same prototype as the quarter finals but they are due the same day for best product so what do you expect!</li><li>I would have done a video on the r4 or r5 for quarter finals but I was to busy getting it working so I could mail some prototypes.  Haven&apos;t spent a free moment doing anything but this project in 3 weeks!</li></ul><p>ii.Project Profile. On the Project Profile:</p><p>a)Link to the new video</p><ul><li>See external links section and this post</li></ul><p>b)Update and add detail to info entered at the previous stages</p><ul><li>Same as quarter finals, project logs and details section</li></ul><p>c)Show at least eight (8) Project Log updates</p><ul><li>Not including this unrelated log there are 8, including this one 9!  Yay counting!</li></ul><p>d)Post a near-complete (at least 90%) components list</p><ul><li>Still need to update this for r6 but its definetly atleast 90%</li><li><strong>UPDATE</strong>: Its fixed, only thing missing is the 3D printed case and the wires to connect the battery and solar cell</li><li>Also its in the project links</li><li>Also its in the git repo: <a href="https://github.com/DrYerzinia/Cat-Finder/blob/master/schem/boards/BLE/BOM.ods">https://github.com/DrYerzinia/Cat-Finder/blob/master/schem/boards/BLE/BOM.ods</a></li></ul><p>e)Post videos of your prototype in action</p><ul><li>These are of it in action how it should be used</li></ul><p><iframe width="500" height="281" src="//www.youtube.com/embed/LO2qe3WNlLM" frameborder="0" allowfullscreen=""></iframe></p><iframe width="500" height="281" src="//www.youtube.com/embed/UpAWcF0HR8o" frameborder="0" allowfullscreen=""></iframe><span class="redactor-invisible-space"></span><ul><li>If you define action as it &quot;Just Operating&quot; lots of the videos show it beeping, or charging the battery from solar power!  But the cases above are the best examples.  Yea its more watching paint dry than action if you want a video of it charging from the sun.</li></ul><p>f)Post an artist&#x2019;s rendition of the &#x201C;productized&#x201D; design/look and feel of the project</p><ul><li>See picture 5 in the gallery, made it in inkscape, took me like an hour.  Drawing is hard, harder than making complex high impedence solar charging circuits that if you get a little contamination on them suddenly start oscillating, then you reflow it and it works, but then you check it the next day and wtf its back how it was.  But then you look closer and its fine.  Yea, drawing&apos;s still harder.</li></ul><p><strong>Best Product.</strong> By 1:50 p.m. P.D.T. on August 17, 2015, complete the following steps:</p><p>i.Complete all Stage 1, Stage 2, and Stage 3 requirements.</p><ul><li>See above</li></ul><p>ii.Use the &#x201C;Submit-to&#x201D; button on the Project Profile to Opt-In for the Best Product prize competition</p><ul><li>Clicked that a while ago</li></ul><p>iii.Three (3) working beta test units must arrive at Sponsor&apos;s shipping address by this cutoff date. Units should be shipped to the following address; two of the units will be returned at the end of the Contest.</p><ul><li>Send Friday morning EXPRESS! ZOOM!</li><li>They were there yesterday but obviously no one was home, expect delivery tomorrow around 10:30AM.</li></ul><p>Supplyframe Inc.<br>ATTN: 2015 Hackaday Prize Best Product<br>51 W. Dayton St., Suite 100<br>Pasadena, CA 91105</p></div>
                            </div>
                        </li>
                    
                </ul>

                

                

                </p>

            
        </div>
    </div>

    










<div class="footer" id="footer">
  <a href="#header" class="back-to-top" onClick="CT(this, 'Footer', 'GoingUp');">^ Going up? ^</a>
    <div class="container">
        <p><a href="http://hackaday.com/about/">About Us</a> <a href="mailto:projects-contact@hackaday.com">Contact Us</a> <a href="/project/37">Give Feedback</a>&copy; 2015 Hackaday <a href="/tos">Terms of Use</a> <a href="/privacy-policy">Privacy Policy</a></p>
        <a href="/" class="had-skull"  onClick="CT(this, 'Footer', 'Home' ); return false;">Hackaday.io</a>
    </div>
</div>

<script>

    var csrftoken = 'CtH5v8bs-_qVIz81iSYdkmvZvK2a0J4B7iWQ';

</script>

    <script type="text/javascript">

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47229708-1', 'auto');

    var dimensionValue = 'nonregistered';
    ga('set', 'dimension1', dimensionValue);
    ga('require', 'displayfeatures');

    ga('send', 'pageview');

    </script>

<img src="//analytics.supplyframe.com/trackingservlet/impression?action=pageImpression&amp;zone=HIO_logs&amp;extra=logged%3Dfalse%7ChaveAccountCookie%3D0%7C&amp;ab=undefined" class="sf-impression" />

    
    
    <script src="//cdn.hackaday.io/build/h%2FydgsYIeDTf7pqgYQEKK8Ngblw0IkZCDqfJ9S2tk7zsBoxIHt5iOd49Qp%2BF4vdxEuRj%2BGpGDLbX4aGOQGmbjaOxUZvklg4ReFk68R95OQshFrGKebvogKGQOiB5Hi1xym9KC54c9Ps0WpzuNydLk4B%2FbKi91KhV40Uxhl38XXb1IVAxAI8iW%2BoQUPCFkHVWZxD0B%2BMZ%2BuEXJTlWuBmopNMxTHRK5yleITPZODT6evbVRQc6AXs9w2Pfk7FS2nKy-0.48.6.js"></script>

</body>
</html>