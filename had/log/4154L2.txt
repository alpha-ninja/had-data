<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en" ng-app="buildlogApp"> <!--<![endif]-->
<head>
    
    <title>Project logs &bull; Bench Power Supply &bull; Hackaday.io</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" href="//cdn.hackaday.io/css/style.css?version=0.48.6" />
    <script type="text/javascript" src="//use.typekit.net/ymb0lgk.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
</head>
<body class="logs">

    <!--
############################################################################################
############################################################################################
############################################################################################
#####################Kt;tL#######################################Kti,E######################
#######################;   .###################################G    E#######################
#######################K    f##################################    ;########################
########################Wj   E###############################K:  .W#########################
##########################.  :E##############################:  .L##########################
#########################D    f##############################.   .##########################
########################,     ;##############################     :E#######K################
################f######K      ,##############################      ,######Lt################
################  W###W       i##############################       t####j t################
################:  E#L.        f###########################L.        f#Ki .E################
################j  ;E.          j##########################.         .G;  i#################
#################L               i#######################K                ##################
#################W                E#####################K;               ;##################
###################:               .###################D               :f###################
#####################DLfGD           G####WEEEEKW####W           ;GffGK#####################
##########################i         iD##Kfi    :jKW##D          iE##########################
###########################W      ,G##f            jE#E;       j############################
############################L     D##D              ,##K       W############################
#############################D:  G#W                  K#E,   G##############################
###############################;i#L                    j## ,E###############################
###############################KK#.                     ##iE################################
#################################j                      ;K##################################
################################W                        ,##################################
################################E                         ##################################
###############################Ki                         D#################################
###############################E.                         L#################################
###############################f    iD##W;       D###D    :#################################
###############################i   i######K     K#####K;   #################################
###############################;  .E#######     #######D   #################################
###############################;  L########     ########   #################################
###############################i  G#######K     K#######   #################################
###############################j  L#####E,       fE#####   #################################
###############################D  .E##j            .t##E  ;#################################
###############################E:  ;##.              #Wt  j#################################
################################G   ;t      tWi      t    E#################################
#############################KL##           K#K;          #K:K##############################
#############################i ##:          ###t         j#f ;K#############################
############################:  G#K          #E#L        L##    D############################
###########################D   ;W#:         #;#L        W#K    .############################
#####################KKEKK      :##L        ; ..      :D##.      fKEEK######################
###################t.            ;##G:               ,##E,             tD###################
##################G               E##E               i##;               :###################
#################D                W##W    iL    E.    ###D                ##################
################W,               G###W    tG    K.    ####:               K#################
################;  LW;         ,E#####:  ;W#    #G   f#####;         ;KG  :K################
################  D###E       ;########WW####WW####WW#######W       :####: j################
################ ,#####:      ;##############################       G####E i################
################K#######.     ;##############################      L######WG################
########################f     i##############################     j#########################
#########################W   .D##############################.   i##########################
#########################E   G###############################D   ,##########################
########################G:   #################################j   G#########################
#######################f    K##################################j    W#######################
#####################Kt :iE#####################################KL:  K######################
############################################################################################
############################################################################################
############################################################################################
-->

<div class="header" id="header">
    <div class="container">
        <h1 class="logo">
            <a href="/" title="Hackaday.io Home" class="home" onclick="CT(this, 'Menu', 'Home'); return false;"></a>
            <a href="/" title="Hackaday.io Home" class="brand" onclick="CT(this, 'Menu', 'Home'); return false;">Hack a Day</a>
        </h1>

        <a href="javascript:void(0);" class="responsive-menu">Menu</a>

        <ul class="nav" role="navigation">
            <li><a href="/projects" class="">Projects</a></li>
            <li><a href="/lists" class="">Lists</a></li>
            <li><a href="/stack" class="">Stack</a></li>
            <li class="dropdown more-nav j-more-open">
                <a href="javascript:void(0)" class="dropdown-link icon-dropdown">More</a>
                <ul role="menu" class="dropdown-menu more-menu" id="j-more">
                    <li><a href="http://hackaday.com/blog/" target="_blank">Blog</a></li>
                    <li><a href="/events">Events</a></li>
                    <li><a href="/hackerspaces">Hackerspaces</a></li>
                    <li><a href="/hackers">Profiles</a></li>
                    <li><a href="/contests">Contests</a></li>
                    <li><a href="/prize" target="_blank">The Hackaday Prize</a></li>
                    <li><a href="/submissions/prize2015/list">2015 Prize Entries</a></li>
                </ul>
            </li>
            <li class="menu-last-child">
                <div class="search-holder show">
                    <form id="search-form" action="/search" onsubmit="return submitSearch();" method="GET">
                        <input type="text" placeholder="Search" name="term" class="input-search j-add-search" id="j-add-search" value="" autocomplete="off" pattern=".{3,}" required title="3 characters minimum" />
                        <input type="submit" class="search-button" />
                    </form>
                </div>
            </li>
        </ul>

        

            <ul class="nav pull-right" role="navigation">
                <li><a href="/signup" class="grey-white-button become-member">Sign up</a></li>
                <li><a href="/signin?returnUrl=%2Fproject%2F4154%2Flogs%3Fpage%3D2">Sign in</a></li>
            </ul>

        
    </div>
</div>

<div id="topMessage" class="alert"><span class="j-top-content"></span><a href="javascript:void(0);" class="alert-close j-top-message-close">Close</a></div>




    <div class="headline">
        <div class="container">
            <h2><a href="/project/4154-bench-power-supply">Bench Power Supply</a></h2>
            <p class="description-title"> Project logs</p>
            <p class="description-summary">Designing an open source, modular bench power supply to rule them all.</p>
            <div class="description-metainfo">
                
                    <span>created by <a href="/hacker/4501-the-big-one" title="Visit Profile">The Big One</a><span>&bull;</span>
                
                7 months ago<span>&bull;</span><a href="/project/4154#discussion-list" title="See Comments">56 Comments</a></span>
            </div>
        </div>
    </div>

    <div class="container post-content">
        <div class="section-buildsort">
            <span class="pull-left">
                <a href="/project/4154-bench-power-supply">&#171; Back to project details</a>
            </span>
            <span class="sort-holder pull-right">
                <label for="sort-by">Sort by:</label>
                <select class="sort" id="sort-by">
                    <option value="/project/4154/logs/sort/newest">Newest</option>
                    <option value="/project/4154/logs/sort/oldest" selected="selected">Oldest</option>
                </select>
            </span>
        </div>
        <div class="section section-buildlogs last">
            

                <ul class="buillogs-list">
                    
                        <li>
                            <h2><a href="/project/4154/log/15309-routed-board">Routed Board</a></h2>
                            <small class="authorship">5 months ago  &bull;
                                <a class="gray-link" href="/project/4154/log/15309#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-15309"><p>As promised, below is the routed version of the schematic shown in the last log.  There is still some more testing to do on the breadboard, but I think it is getting close.</p><img src="https://cdn.hackaday.io/images/7311031426536197500.png"><p><span></span><br></p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4154/log/15389-working-on-usb-calibration">Working on USB Calibration</a></h2>
                            <small class="authorship">5 months ago  &bull;
                                <a class="gray-link" href="/project/4154/log/15389#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-15389"><p>A core part of this project (and what sets it apart from other simple PSU builds) is the software.  I am planning on including software to support calibration of voltage setpoint / readout and current limit setpoint / actual current readout.  Last night I started work on this, and things are coming along nicely.</p><p>Communication is over USB, using a Raw HID protocol, so that no drivers will be needed.</p><p>There are a few things left which I want to test (both in relation to this software calibration as well as some other aspects of the project); once I am happy with how it is working, I will go ahead with the PCB order.</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4154/log/15390-entry-to-the-hackaday-prize">Entry to The Hackaday Prize</a></h2>
                            <small class="authorship">5 months ago  &bull;
                                <a class="gray-link" href="/project/4154/log/15390#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-15390"><p>I have been thinking about entering this project into THP for a few days now, and today I made the leap.</p><p>You may ask why I bothered, given that a benchtop power supply will not change the world.</p><p>While this is definitely true, I feel that having good, affordable tools is a requirement for every lab, whether it be a solo hacker in his [mother's?] basement, or a popular hackerspace.  While my bench top power supply may not by itself change the world, I hope that it can assist someone else in doing so.</p><p>More details and updates will follow as I complete the documentation required for this entry.</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4154/log/15419-voltage-calibration-working-plus-pictures">Voltage calibration working (plus pictures)</a></h2>
                            <small class="authorship">5 months ago  &bull;
                                <a class="gray-link" href="/project/4154/log/15419#discussion-list">
                                    8 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-15419"><p>Last night I finished the voltage calibration code for both setpoint and actual readings.  It works by connecting a multimeter to get a known reading, and then setting the raw DAC output to find a known value + reading the ADC.  You do this twice (for 0 and 8000 mV), and a bit of linear math gets you the slope and offset required.  You can then save this to EEPROM.</p><p>From initial testing, this looks to be very promising.  Across the entire range I was not getting an error rate of no more than about +/-10mV (i.e. +/- 1 on the least significant digit on my 2 decimal place multimeter).  This may not be running into the 'precision' measurement range, but it is well within my desires for this supply.  Also, this is done using a linear algorithm and two measurement points.  By adjusting the measurement points (if you know you need 5v to be calibrated, use that as a point) or by using a non-linear calibration algorithm with multiple calibration points I could probably improve things (although I would really need a more accurate multimeter before I could do much more than what I have already).</p><p>Next up is the current calibration (both for current measurement as well as current limiting setpoints).  I am planning on the same approach; most of the code is ready although it needs to be tested and fine tuned.</p><p>Finally, I thought I would share some pictures of my test setup.</p><p>Here you can see the power supply (one channel, comprising two linear regulators + heat sinks with accompanying op amps, plus control board / encoders / display), with my constant current dummy load attached.<br></p><p><img src="https://cdn.hackaday.io/images/4867731426779439269.JPG"></p><p>Here is a closeup of the two regulators and op amps comprising the single channel.</p><p><img src="https://cdn.hackaday.io/images/232521426779549373.JPG"></p>Finally, here is a closeup of the control board and UI.<p><img src="https://cdn.hackaday.io/images/4446701426779623881.JPG"></p><br></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4154/log/15437-call-for-help-current-limiting">Call for Help: Current Limiting</a></h2>
                            <small class="authorship">5 months ago  &bull;
                                <a class="gray-link" href="/project/4154/log/15437#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-15437"><p>Hello Hackaday!</p><p>I am trying to get adjustable current limiting via DAC setpoints working, but am coming up against some problems: while the limiting does work, it is very imprecise, non linear / non deterministic (the same analog input value does not guarantee the same output), and tends to drift (+ / - tens of mA).</p><p>For those who have done similar... is this just a limitation of the LM317?  Am I expecting too much with my approach here?  Or am I completely missing something obvious?</p><p>Any thoughts / suggestions / comments would be appreciated.</p><p>My latest schematic can be seen below:</p><p><img src="https://cdn.hackaday.io/images/4119701426536552097.png"></p><p>As you can see, the current limiting is done after the first regulator, and consists of a shunt resistor (I am using 1ohm).  The DAC value is added to the voltage drop from the shunt resistor, and applied against the Vadj pin.  This design does work (for large changes to the set point), but fine changes seem to be lost in the other inaccuracies.</p><p>Thanks for any comments!</p><p>Cheers</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4154/log/15457-stupid-loads-and-assumptions-you-know-what-they-say">Stupid loads and assumptions (you know what they say...)</a></h2>
                            <small class="authorship">5 months ago  &bull;
                                <a class="gray-link" href="/project/4154/log/15457#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-15457"><p>Backstory: a couple days ago I had made some changes to my adjustable dummy load: I wanted the fans and op amp to be powered from a separate source, so that I could turn the load current right down to 0 mA.  While doing this I also swapped out the op amp for a different one that could run at higher voltages, so I didn't need an onboard 5v regulator.  Initial tests showed that it worked, so I didn't think anything more about it.</p><p>This evening I had some time to work on hardware again (the last few evenings I had been doing USB programming).  I wanted to test some higher currents, with the hope of figuring out a working implementation of current limiting.  I started off by calibrating the supply for a LM338 (so that I am not limited to 1.5A).  The voltage calibration went fine, but when I tried to calibrate the current measurement, things went wonky.</p><p>I pulled out my scope to see what was happening, and to my astonishment saw extreme oscillations, noise, and all sorts of ugly garbage on the Vout line, whenever the current exceeded about 200mA.</p><p>Initially I assumed that I did something wrong.  I triple checked the breadboard against the schematic, added bypass caps at every place I could think of, looked for shorts in the control circuit, etc.  Nothing.  Next I started tearing down the supply and going back to basics, all the way back to using a single pot to control voltage.  Still, oscillations out the wah-zoo!</p><p>My overly paranoid brain next went to ESD... had I zapped the regulator at some point?  I pulled out a new LM338, straight from the staic wrapping... AND THE SAME THING WAS HAPPENING.</p><p>At this point I really started to doubt myself.  Had I actually done the right setup when I originally measured regulation under load?   Perhaps I had thought I was testing under load, but was in fact not... who knows?!?  By now I had been staring at the same board for hours, with no progress.</p><p>So what was different?</p><p>Right... my dummy load (stupid load) had changed.</p><p>I tried a couple of simple current sinks using a LM338 with a single resistor (trying a few distinct current loads, from 2A down to 500mA-ish).  The output was solid as a rock.</p><p>Well, now we are getting somewhere.</p><p>I did some reading on dummy loads similar to mine, and found some suggestions.  Don't drive the transistor directly with a LM324 (use a resistor in series); add decoupling caps between the inverting and non-inverting inputs; add decoupling caps between GND and the base of the transistor, etc.  I ended up doing all of them (why go halfway!), and while the load is still a bit noisy, it is much better than before.  Furthermore, since I know that the source of the noise is the load, I don't have to worry quite so much about it.  (As long as I can try a clean load at various currents to verify load regulation, I am good).</p><p>The moral of this story is two-fold: 1) You know what happens when you make assumptions, and 2) Dummy loads can be quite stupid.</p><p>Cheers</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4154/log/15529-current-limiting-works">Current Limiting Works</a></h2>
                            <small class="authorship">5 months ago  &bull;
                                <a class="gray-link" href="/project/4154/log/15529#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-15529"><p>After the problems that I was having when using an LM317 as the adjustable current regulator, I decided to scrap that approach and go back to basics.  I swapped out the current limiting LM317 for a TIP102 (generic NPN darlington transistor).  The base of the transistor is driven by a high gain op amp which is comparing the current set poitnt with the current output.  Lo and behold, it actually works!  I can get all the way down to 20mA (i.e. low enough that I can drive a single low power LED without any extra resistors).</p><p>Some other changes include using an op amp in instrumentation amplifier mode rather than differential amplifier mode, and adding some more decoupling capacitors for stability.</p><p>The updated schematic is below.  Thanks to all of you who have given suggestions on how to improve things!</p><p>Cheers</p><p><img src="https://cdn.hackaday.io/images/3046781427082751317.png"></p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4154/log/15680-update-current-limiting-dacs-magic-smoke-etc">Update (Current Limiting, DACs, Magic Smoke, etc)</a></h2>
                            <small class="authorship">5 months ago  &bull;
                                <a class="gray-link" href="/project/4154/log/15680#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-15680"><p>It has been a productive few days since the last log entry.  But first for the magic smoke!</p><p>A week or so ago I plugged the ADC pin on my MCU directly into 12V Vout.  There was some smoke, the smell of burnt chips... but the thing still apparently worked!</p><p>Or so I thought.  On Tuesday evening it finally gave up the ghost, so I had to replace the 32u4 with another one which I (luckily) had available.  Note to future self: triple check your inputs before plugging them into a MCU!</p><p>On a more positive note, I now have improved current limiting efficiency (thanks to Hacker404's suggestions).  I am now using a PNP transistor instead of NPN, and the voltage drop from rails is only 0.7v as compared to 1.4v.  This will let me get higher output voltages from lower inputs, which is good news all around.</p><p>The current limiting now gives a smooth curve down as it kicks in, rather than oscillating between fully on and fully off.</p><p>I have added support for an LED to show whether current limiting is enabled or not.  (It is essentially just a 'high' signal, so you could hook it into a MCU or something if you wanted to do something more with it.... just be sure to step it down, as it is 12+V!)</p><p>Yesterday I successfully implemented and verified the DAC I2C address change message.  (The DAC which I have chosen, the MCP4728, has a programmable address offset consisting of 3 bits.  This is wonderful, but it means that you need to program them when putting the thing together.)  With my latest code, this should be quite easy.</p><p>One problem that I am still encountering is completely turning off the output when current limiting is in effect.  When testing, I noticed that I could not get any lower than 35mA output (at 12V), no matter what value I set the current limiting DAC to.  I assumed it was just the PNP transistor leaking; however the phenomenon continued even when physically removing the current limit transistor!  After tracing through the schematic, I found the source: the VSET op amp was supplying 35mA of current, which was traveling through the 200Î© resistor and the protection diode to the output.</p><p>I am not sure how best to solve this problem.  The obvious answer would be to increase the resistance in the output path.  Initial experiments show that this won't work properly, though, as adjusting the resistance makes controlling the LM317 very difficult.  Other options would include using a shunt transistor to reduce the VSET voltage when current limiting is in effect (doable, but I would like to avoid the use of an extra transistor if possible).  A 'nuke it from orbit' approach would be to revert back to using an NPN transistor for the voltage regulator... this is doable (I had voltage regulation working initially with this approach), but I do like the smooth output of the 317.  More time will be spent on this problem this evening.</p><p>Finally, attached is my latest schematic.  Enjoy!</p><p><span></span><br></p><p><img src="https://cdn.hackaday.io/images/842971427386952521.png"></p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4154/log/15909-current-sense-woes">Current Sense Woes</a></h2>
                            <small class="authorship">5 months ago  &bull;
                                <a class="gray-link" href="/project/4154/log/15909#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-15909"><p>I am experiencing some difficulty getting the current sense working as desired.</p><p>Originally, I had it after the regulator (the theory being that it would be more accurate that way, since all the current which was going to the load would have to go through the current sense resistor).  It worked, but there was voltage drop at high currents due to the resistor.  When pulling 5A, there was a 0.5V drop, which is unacceptable for me.  (I am not too worried voltage drops on load, but 0.5V is too much.  1% (so a 0.1V drop at 10V) would be fine by me.  (For the record, the LM317 has nominal 0.5% load regulation).</p><p>I then decided to move it before the regulator.  Since the voltage is regulated after the current sense, the regulator should be able to handle all sorts of loads (as mentioned above, the 317 has decent load regulation).  After wiring it all up, I tried it.... and it didn't work.</p><p>It turns out that the problem is due to the common mode voltage on my op amps.  When the current sense is before the regulator, it is running at about 0.7V lower than my rail voltages (+/- 16V, so the voltage reading on the high side would be about 15.3V).  My op amps are not rail to rail, and so cannot output this much.  (I am using a three-op-amp instrumentation amplifier configuration, so the first amp buffers the input voltage, but the most it can output is about 14.5V).</p><p>If I switch to the simpler single op-amp differential configuration with a gain of 10x, I can just barely squeak by (there are implied voltage dividers in this configuration, so it drops the voltage down a bit before the op amp inputs).  Perhaps if I switched to a 5x gain it may be better, albeit a bit less precise.  (There are other benefits to doing it this way, including reducing the number of op amp ICs I need for each channel).</p><p>Of course, another option is to use a dedicated current sense IC... for instance I already have some INA169s lying around.  While tempting, they do not work on negative voltages, so would pose a restriction on one of the major goals of this project (i.e. having the same board used for positive and negative channels).  Or, if not a current sense IC, a differential amp with high common mode voltage.  I am not sure that I want to go that route, though... I am trying to use generic components as much as possible here, at least for each channel (the control board is a bit more specialized, but such is life).</p><p>So at this point I am a bit lost.  From what I can see, the only reasonable option is to use a single op amp as a differential amplifier, with a reduced 5x gain.  I suppose that using a three-amp instrumentation amp would not really buy me much, since the values I am measuring are very low impedance anyway (it's a freakin' power supply!)  I'm still a bit annoyed that I can't get it to work, even though I know exactly what is wrong and why it is failing.</p><p>Oh well.  Onward and upward...</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/4154/log/16038-final-design-for-rev-10">Final Design for Rev 1.0</a></h2>
                            <small class="authorship">5 months ago  &bull;
                                <a class="gray-link" href="/project/4154/log/16038#discussion-list">
                                    2 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-16038"><p>I think that I have figured out everything that needs to be done here.  Yay!</p><p>First, some comments on which of my original design goals I was successful with and which I was not.</p><p>The final design:</p><ol><li>Is modular, allowing for a variety of power sources (transformer + rectifier, dual switch mode supply, or even a wall wart (although the wall wart comes with limitations on functionality)</li><li>Allows for up to 6 channels, with each channel able to be defined as either positive or negative.</li><li>Each channel's voltage / current limit setpoints and voltage / actual current sense feedback is an analog value in the range 0-5V.  They can be driven by potentiometers or DACs, and read by an ADC.</li><li>Each channel to go all the way down (or up, for negative channels) to 0</li><li>Allows a current limit setpoint all the way down to 0mA</li><li>When using the digital control board, encoders + a display allow easy changing of set points and viewing of actual values</li><li>The digital control board includes calibration and control over USB</li><li>If you use less than 6 channels, you can assign the DAC output of channel 6 as AREF on the microcontroller, allowing for a more stable voltage reference which will improve the ADC accuracy</li></ol><p>The biggest limitation that I was unable to overcome (without introducing extra complexity or other limitations) was when using a single supply (e.g. a wall wart); voltage regulation works (down to 1.25V instead of 0V), but current limiting seems iffy at best.  Perhaps if a rail to rail op amp was used it would work better (I don't have any rail to rail op amps to test).  That said, a split supply (whether it be from a scrap transformer or a couple of cheap isolated switch mode supplies) are cheap enough that I don't think running from a wall wart is really worthwhile.</p><p>Another limitation / bug that I can't figure out is the current limiting LED indicator light.  It is supposed to come on whenever the actual current matches or exceeds the setpoint current.  It works, but it tends to be delayed by a number of seconds (the exact length of time seeming to depend on the current limit setpoint: the higher the setpoint the slower it is).  I am not sure why it does that... the actual current limiting kicks in immediately.  It is only the indicator light that is delayed, and they are running from the same output.</p><p></p><p>The final schematic is below:</p><p><img src="https://cdn.hackaday.io/images/4577301428082476445.png"></p><p>You will notice a few changes from last time:</p><ol><li>A diode D3 between the voltage adjustment pin and the voltage adjustment op amp prevents the op amp from sourcing any current to VOUT.  It can essentially only 'pull down' the adjustment pin (if left unconnected, VOUT would rise to its maximum output of about 13.5V on a 16V rail).</li><li>The current limit setpoint is now passed through an op amp U2D.  This biases the output to go below zero, which is required for current limiting all the way to 0mA.</li><li>I have reduced the value of some capacitors (most notably the capacitor on the I_LIM net, to turn the transistor on / off, and the size of the electrolytic capacitors on the main power line).  The smaller values seem to be fine across all sorts of loads.</li></ol><p>The board layout is also completed, and can be seen below:</p><p><img src="https://cdn.hackaday.io/images/6097511428083504594.png"></p>I plan on waiting for a day or two to make sure that I have not forgotten anything, and then submitting the board to DirtyPCBs for manufacturing.  If anyone in the community notices any issues, please let me know ASAP!  :-)<p>After the board has been submitted, I plan on working on the software some more.  The basics are there and working, but there is still lots of room for improvement:</p><ol><li>The encoders could use some TLC; currently they sometimes skip signals.</li><li>Calibration should use multiple measurements at common values (0, 1.8, 3.3, 5.0, 8.0, 12.0, etc) and interpolate in between them.  This will allow for more accuracy across the entire range.  This is especially important for current limiting, which does not seem to be quite as linear as the voltage setpoints.</li><li>The user interface needs some improvement to allow quickly and easily setting voltage and current setpoints</li><li>There should be some functionality for setting common values (say 5V at 500mA maximum to test a USB load)</li><li>There needs to be more computer-side utilities for setting and logging data (all the USB HID commands are implemented on the AVR side, I just need to write a simple Python script to tie it all together).</li></ol><p>I think that's all for now... feel free to comment below if you have any questions / comments / suggestions.</p><p>Cheers</p></div>
                            </div>
                        </li>
                    
                </ul>

                
                <div class="pagination">
                    
                    <a href="?page=1" class="grey-gold-button prev-button ">Previous</a>
                    
                    
                    <a href="?page=3" class="grey-gold-button next-button ">Next</a>
                    
                </div>
                

                

                </p>

            
        </div>
    </div>

    










<div class="footer" id="footer">
  <a href="#header" class="back-to-top" onClick="CT(this, 'Footer', 'GoingUp');">^ Going up? ^</a>
    <div class="container">
        <p><a href="http://hackaday.com/about/">About Us</a> <a href="mailto:projects-contact@hackaday.com">Contact Us</a> <a href="/project/37">Give Feedback</a>&copy; 2015 Hackaday <a href="/tos">Terms of Use</a> <a href="/privacy-policy">Privacy Policy</a></p>
        <a href="/" class="had-skull"  onClick="CT(this, 'Footer', 'Home' ); return false;">Hackaday.io</a>
    </div>
</div>

<script>

    var csrftoken = 'mEpFe0YZ-fjR1uljaDUZR6hru4XPwy_vVOSo';

</script>

    <script type="text/javascript">

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47229708-1', 'auto');

    var dimensionValue = 'nonregistered';
    ga('set', 'dimension1', dimensionValue);
    ga('require', 'displayfeatures');

    ga('send', 'pageview');

    </script>

<img src="//analytics.supplyframe.com/trackingservlet/impression?action=pageImpression&amp;zone=HIO_logs&amp;extra=logged%3Dfalse%7ChaveAccountCookie%3D0%7C&amp;ab=undefined" class="sf-impression" />

    
    
    <script src="//cdn.hackaday.io/build/h%2FydgsYIeDTf7pqgYQEKK8Ngblw0IkZCDqfJ9S2tk7zsBoxIHt5iOd49Qp%2BF4vdxEuRj%2BGpGDLbX4aGOQGmbjaOxUZvklg4ReFk68R95OQshFrGKebvogKGQOiB5Hi1xym9KC54c9Ps0WpzuNydLk4B%2FbKi91KhV40Uxhl38XXb1IVAxAI8iW%2BoQUPCFkHVWZxD0B%2BMZ%2BuEXJTlWuBmopNMxTHRK5yleITPZODT6evbVRQc6AXs9w2Pfk7FS2nKy-0.48.6.js"></script>

</body>
</html>