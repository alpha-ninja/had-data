<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en" ng-app="buildlogApp"> <!--<![endif]-->
<head>
    
    <title>Project logs &bull; NXP Phase Frequency Detector &bull; Hackaday.io</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" href="//cdn.hackaday.io/css/style.css?version=0.48.6" />
    <script type="text/javascript" src="//use.typekit.net/ymb0lgk.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
</head>
<body class="logs">

    <!--
############################################################################################
############################################################################################
############################################################################################
#####################Kt;tL#######################################Kti,E######################
#######################;   .###################################G    E#######################
#######################K    f##################################    ;########################
########################Wj   E###############################K:  .W#########################
##########################.  :E##############################:  .L##########################
#########################D    f##############################.   .##########################
########################,     ;##############################     :E#######K################
################f######K      ,##############################      ,######Lt################
################  W###W       i##############################       t####j t################
################:  E#L.        f###########################L.        f#Ki .E################
################j  ;E.          j##########################.         .G;  i#################
#################L               i#######################K                ##################
#################W                E#####################K;               ;##################
###################:               .###################D               :f###################
#####################DLfGD           G####WEEEEKW####W           ;GffGK#####################
##########################i         iD##Kfi    :jKW##D          iE##########################
###########################W      ,G##f            jE#E;       j############################
############################L     D##D              ,##K       W############################
#############################D:  G#W                  K#E,   G##############################
###############################;i#L                    j## ,E###############################
###############################KK#.                     ##iE################################
#################################j                      ;K##################################
################################W                        ,##################################
################################E                         ##################################
###############################Ki                         D#################################
###############################E.                         L#################################
###############################f    iD##W;       D###D    :#################################
###############################i   i######K     K#####K;   #################################
###############################;  .E#######     #######D   #################################
###############################;  L########     ########   #################################
###############################i  G#######K     K#######   #################################
###############################j  L#####E,       fE#####   #################################
###############################D  .E##j            .t##E  ;#################################
###############################E:  ;##.              #Wt  j#################################
################################G   ;t      tWi      t    E#################################
#############################KL##           K#K;          #K:K##############################
#############################i ##:          ###t         j#f ;K#############################
############################:  G#K          #E#L        L##    D############################
###########################D   ;W#:         #;#L        W#K    .############################
#####################KKEKK      :##L        ; ..      :D##.      fKEEK######################
###################t.            ;##G:               ,##E,             tD###################
##################G               E##E               i##;               :###################
#################D                W##W    iL    E.    ###D                ##################
################W,               G###W    tG    K.    ####:               K#################
################;  LW;         ,E#####:  ;W#    #G   f#####;         ;KG  :K################
################  D###E       ;########WW####WW####WW#######W       :####: j################
################ ,#####:      ;##############################       G####E i################
################K#######.     ;##############################      L######WG################
########################f     i##############################     j#########################
#########################W   .D##############################.   i##########################
#########################E   G###############################D   ,##########################
########################G:   #################################j   G#########################
#######################f    K##################################j    W#######################
#####################Kt :iE#####################################KL:  K######################
############################################################################################
############################################################################################
############################################################################################
-->

<div class="header" id="header">
    <div class="container">
        <h1 class="logo">
            <a href="/" title="Hackaday.io Home" class="home" onclick="CT(this, 'Menu', 'Home'); return false;"></a>
            <a href="/" title="Hackaday.io Home" class="brand" onclick="CT(this, 'Menu', 'Home'); return false;">Hack a Day</a>
        </h1>

        <a href="javascript:void(0);" class="responsive-menu">Menu</a>

        <ul class="nav" role="navigation">
            <li><a href="/projects" class="">Projects</a></li>
            <li><a href="/lists" class="">Lists</a></li>
            <li><a href="/stack" class="">Stack</a></li>
            <li class="dropdown more-nav j-more-open">
                <a href="javascript:void(0)" class="dropdown-link icon-dropdown">More</a>
                <ul role="menu" class="dropdown-menu more-menu" id="j-more">
                    <li><a href="http://hackaday.com/blog/" target="_blank">Blog</a></li>
                    <li><a href="/events">Events</a></li>
                    <li><a href="/hackerspaces">Hackerspaces</a></li>
                    <li><a href="/hackers">Profiles</a></li>
                    <li><a href="/contests">Contests</a></li>
                    <li><a href="/prize" target="_blank">The Hackaday Prize</a></li>
                    <li><a href="/submissions/prize2015/list">2015 Prize Entries</a></li>
                </ul>
            </li>
            <li class="menu-last-child">
                <div class="search-holder show">
                    <form id="search-form" action="/search" onsubmit="return submitSearch();" method="GET">
                        <input type="text" placeholder="Search" name="term" class="input-search j-add-search" id="j-add-search" value="" autocomplete="off" pattern=".{3,}" required title="3 characters minimum" />
                        <input type="submit" class="search-button" />
                    </form>
                </div>
            </li>
        </ul>

        

            <ul class="nav pull-right" role="navigation">
                <li><a href="/signup" class="grey-white-button become-member">Sign up</a></li>
                <li><a href="/signin?returnUrl=%2Fproject%2F6034%2Flogs%3Fpage%3D1">Sign in</a></li>
            </ul>

        
    </div>
</div>

<div id="topMessage" class="alert"><span class="j-top-content"></span><a href="javascript:void(0);" class="alert-close j-top-message-close">Close</a></div>




    <div class="headline">
        <div class="container">
            <h2><a href="/project/6034-nxp-phase-frequency-detector">NXP Phase Frequency Detector</a></h2>
            <p class="description-title"> Project logs</p>
            <p class="description-summary">This is a phase frequency detector based using NXP 74aup2g57gm.</p>
            <div class="description-metainfo">
                
                    <span>created by <a href="/hacker/60614-shane-kirkbride" title="Visit Profile">shane kirkbride</a><span>&bull;</span>
                
                3 months ago<span>&bull;</span><a href="/project/6034#discussion-list" title="See Comments">0 Comments</a></span>
            </div>
        </div>
    </div>

    <div class="container post-content">
        <div class="section-buildsort">
            <span class="pull-left">
                <a href="/project/6034-nxp-phase-frequency-detector">&#171; Back to project details</a>
            </span>
            <span class="sort-holder pull-right">
                <label for="sort-by">Sort by:</label>
                <select class="sort" id="sort-by">
                    <option value="/project/6034/logs/sort/newest">Newest</option>
                    <option value="/project/6034/logs/sort/oldest" selected="selected">Oldest</option>
                </select>
            </span>
        </div>
        <div class="section section-buildlogs last">
            

                <ul class="buillogs-list">
                    
                        <li>
                            <h2><a href="/project/6034/log/18859-received-all-the-hardware-its-time-to-get-busy-and-build">RECEIVED ALL THE HARDWARE: IT&#39;S TIME TO GET BUSY AND BUILD!</a></h2>
                            <small class="authorship">3 months ago  &bull;
                                <a class="gray-link" href="/project/6034/log/18859#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-18859"><p>NXP is hosting a design competition called <a href="http://convergencepromotions.com/TheBigIdea/">The Big Idea</a>. I've decided to enter into this competition to go through the process of building a digital phase locked loop. I'm not going to have it be really fast; I will be happy if it works. Since I have never directly built a phase locked loop this should be a bit of a learning experience. The parts of the pll that I will be designing are the phase-frequency detector, the charge-pump, the low pass filter, the voltage controlled oscillator and the frequency divider. I'll be documenting these sections in this blog post.</p><p>Frequency Phase Detector:</p><p><img alt="Day 2: the Phase-Frequency Detector" src="https://images-blogger-opensocial.googleusercontent.com/gadgets/proxy?url=http%3A%2F%2Fconvergencepromotions.com%2FTheBigIdea%2Fimages%2Feasyblog_images%2F876%2F2e1ax_timeless_entry_phase-frequency-detector.png&amp;container=blogger&amp;gadget=a&amp;rewriteMime=image%2F*"></p><p>I've done a logic schematic for the phase-frequency detector for my phase lock loop. This is the part in the phase lock loop that determines what frequency the voltage controlled oscillator is set at. The schematic is an optimized version of two D-Flip Flops and some other logic. If I had the NXP part in the MultiSIM Blue library I would be able to use a single part number for each one of these logic gates. </p><p>Frequency Divider</p><p><img alt="Day 3: The Frequency Divider" src="https://images-blogger-opensocial.googleusercontent.com/gadgets/proxy?url=http%3A%2F%2Fconvergencepromotions.com%2FTheBigIdea%2Fimages%2Feasyblog_images%2F876%2F2e1ax_timeless_entry_frequency-divider.png&amp;container=blogger&amp;gadget=a&amp;rewriteMime=image%2F*"></p><p>One of the blocks in the phase locked loop is the frequency divider. I've designed a divide by 2 frequency divider out of a D-flip flop with feedback. I could use the 74AUP2G57GM in this design if it existed in the MultiSIM Blue library. However it does not. I've asked when they plan to have this part available and I haven't received a reply. I'll post the theory on my own personal blog when I'm done.</p><p>I have all the hardware I need to complete this project. I'll be uploading a few pictures and videos in the next few days of this working. I've decided to close the loop with the Arduino Uno. The Arduino will receive the output of the phase-frequency detector and change the input. I needed to do this for a few reasons. The time required to assemble and debug the entire phase-locked loop would have taken longer than I would of had. Second the Arduino adds a really interesting component to this project. Since the phase-frequency detector is a very robust you can do things like lock two XBees together and double your sensor bandwidth for 3D imaging. Or you can use it to drive two wheels forward and keep them moving at the same speed with two electric motors. </p><p>Also the demo kit that NXP sent is awesome for a lot of reasons. It allows easy prototyping of typically difficult to work with surface mount components. The kit shows how small the SMT components are. The additional resistors and capacitors for proper functionality are also included in the dev kit. I hope NXP would consider selling it would be great to use in electrical designs that would eventually be miniaturized. </p><p>First let's take a look at a single demo board. There are a few observations about this board I'll make before I move onto the design.</p><p><img alt="b2ap3_thumbnail_hardwareSize.png" src="https://images-blogger-opensocial.googleusercontent.com/gadgets/proxy?url=http%3A%2F%2Fconvergencepromotions.com%2FTheBigIdea%2Fimages%2Feasyblog_images%2F876%2Fb2ap3_thumbnail_hardwareSize.png&amp;container=blogger&amp;gadget=a&amp;rewriteMime=image%2F*"></p><p>Figure 1: Single Demo Board (Back)</p><p>As you can see in this demo board there are some added resistors and capacitors. This will help to limit the current through the device. In my original schematic I neglected these but it is clear they are needed. Second I wanted to point out the dime to the left of the board in Figure 1. If you compare Franklin D. Roosevelt's ear to the size of the<strong> 74AUP2G57GM</strong> his ear is slightly larger! This is a very small chip; ideal for the Internet of Things and wearables.</p><p>So I was sent 5 of these boards. I can imagine they are ESD sensitive. I found some ESD Foam and used that to lay out all the boards. The boards for the phase frequency detector are shown below as well as their alignment as it shows in the schematic.</p><p><img alt="b2ap3_thumbnail_Step2.png" src="https://images-blogger-opensocial.googleusercontent.com/gadgets/proxy?url=http%3A%2F%2Fconvergencepromotions.com%2FTheBigIdea%2Fimages%2Feasyblog_images%2F876%2Fb2ap3_thumbnail_Step2.png&amp;container=blogger&amp;gadget=a&amp;rewriteMime=image%2F*"></p><p>Figure 2a: The initial layout of the boards.</p><p><img alt="b2ap3_thumbnail_PhaseLockedLoopImg_20150602-211553_1.png" src="https://images-blogger-opensocial.googleusercontent.com/gadgets/proxy?url=http%3A%2F%2Fconvergencepromotions.com%2FTheBigIdea%2Fimages%2Feasyblog_images%2F876%2Fb2ap3_thumbnail_PhaseLockedLoopImg_20150602-211553_1.png&amp;container=blogger&amp;gadget=a&amp;rewriteMime=image%2F*"></p><p>Figure 2b: The schematic we are wiring to.</p><p>The next step to wire these boards as they are represented in the schematic. This was a multi-day process. I went through one board at a time and wired them per the schematic. Some of this progress is shown in Figure 3 below.</p><p><img alt="b2ap3_thumbnail_Step4.png" src="https://images-blogger-opensocial.googleusercontent.com/gadgets/proxy?url=http%3A%2F%2Fconvergencepromotions.com%2FTheBigIdea%2Fimages%2Feasyblog_images%2F876%2Fb2ap3_thumbnail_Step4.png&amp;container=blogger&amp;gadget=a&amp;rewriteMime=image%2F*"></p><p>Figure 3: Some initial boards wired completed. Wiring and soldering and wiring and soldering...</p><p>So after spending time wiring and soldering and then soldering and wiring even more the entire phase frequency detector is assembled and ready to detect some frequency and phase differences! The entire device is shown below in figure 4. </p><p><img alt="b2ap3_thumbnail_step5.png" src="https://images-blogger-opensocial.googleusercontent.com/gadgets/proxy?url=http%3A%2F%2Fconvergencepromotions.com%2FTheBigIdea%2Fimages%2Feasyblog_images%2F876%2Fb2ap3_thumbnail_step5.png&amp;container=blogger&amp;gadget=a&amp;rewriteMime=image%2F*"></p><p>Figure 4: the entire phase frequency detector</p><p>This concludes my post on assembling the phase frequency detector. In the next post we'll plug it in and turn it on, look at some code and watch some flashing LEDs.</p><p>I will update this blog post and <a href="http://convergencepromotions.com/TheBigIdea/index.php?option=com_easyblog&amp;view=entry&amp;id=7&amp;Itemid=381#.VOux1IEUkL0">my blog </a>at the big idea as I make progress.</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/6034/log/19184-arduino-uno-code-for-the-phase-frequency-detector">Arduino Uno code for the phase frequency detector</a></h2>
                            <small class="authorship">2 months ago  &bull;
                                <a class="gray-link" href="/project/6034/log/19184#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-19184"><pre class="hljs cpp"><span class="hljs-keyword">int</span> ledPin = <span class="hljs-number">9</span>;      <span class="hljs-comment">// LED connected to digital pin 9</span>
<span class="hljs-keyword">int</span> digitalPin7 =<span class="hljs-number">7</span>;
<span class="hljs-keyword">int</span> digitalPin6 =<span class="hljs-number">6</span>;
 
<span class="hljs-keyword">int</span> analogPin3 = <span class="hljs-number">3</span>;   <span class="hljs-comment">// potentiometer connected to analog pin 3</span>
<span class="hljs-keyword">int</span> analogPin0 = <span class="hljs-number">0</span>;   <span class="hljs-comment">// potentiometer connected to analog pin 0</span>
<span class="hljs-keyword">int</span> val3 = <span class="hljs-number">0</span>;         <span class="hljs-comment">// variable to store the read value</span>
<span class="hljs-keyword">int</span> val0 = <span class="hljs-number">0</span>;         <span class="hljs-comment">// variable to store the read value</span>
 
<span class="hljs-keyword">float</span> duration0 = <span class="hljs-number">0.1</span>;  <span class="hljs-comment">// in millis  -- 100, 200, 1000, 2000, 4000 == 10Hz, 5Hz, 1Hz, .5Hz, and .125Hz </span>
<span class="hljs-keyword">float</span> duration1 = <span class="hljs-number">0.01</span>;  <span class="hljs-comment">// in millis  -- 100, 200, 1000, 2000, 4000 == 10Hz, 5Hz, 1Hz, .5Hz, and .125Hz </span>
 
<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> lastFlip0=<span class="hljs-number">0</span>;
<span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> lastFlip1=<span class="hljs-number">0</span>;
 
<span class="hljs-keyword">int</span> state0 = LOW;
<span class="hljs-keyword">int</span> state1 = LOW;
<span class="hljs-keyword">int</span> led = <span class="hljs-number">13</span>;
 
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">setup</span><span class="hljs-params">()</span>
 
</span>{
  pinMode(digitalPin7, OUTPUT);
  pinMode(digitalPin6, OUTPUT);
  pinMode(led,OUTPUT);
  
  digitalWrite(digitalPin7, state0);
  digitalWrite(digitalPin6, state1);
  Serial.begin(<span class="hljs-number">9600</span>);          <span class="hljs-comment">//  setup serial</span>
  
}
 
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">loop</span><span class="hljs-params">()</span>
</span>{
 
  val3 = analogRead(analogPin3);    <span class="hljs-comment">// read the input pin</span>
  val0 = analogRead(analogPin0);    <span class="hljs-comment">// read the input pin</span>
  
  <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> now = millis();
  
  <span class="hljs-comment">//This is XO 0</span>
  <span class="hljs-keyword">if</span> (now - lastFlip0 &gt;= duration0)
  {
    lastFlip0 = now;
    state0 = !state0;
    digitalWrite(digitalPin7, state0);
  }
  
  <span class="hljs-comment">//This is XO 1</span>
  <span class="hljs-keyword">if</span> (now - lastFlip1 &gt;= duration1)
  {
    lastFlip1 = now;
    state1 = !state1;
    digitalWrite(digitalPin6, state1);
  }
  
  <span class="hljs-keyword">if</span>(val0 &gt; val3)
  {
    digitalWrite(led, HIGH);
    duration0 = duration0 - random(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>);
    duration1 = duration1 + random(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>);
  }
  <span class="hljs-keyword">else</span>
  {
    digitalWrite(led, LOW);
    duration1 = duration1 - random(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>);
    duration0 = duration0 + random(<span class="hljs-number">1</span>, <span class="hljs-number">10</span>);
  }
  
  
    Serial.write(<span class="hljs-string">"Val3: "</span>);
    Serial.println(val3);     
    Serial.write(<span class="hljs-string">"Val0: "</span>);
    Serial.println(val0);  
    Serial.write(<span class="hljs-string">"Time: "</span>);
    Serial.println(now);
 
}</pre></div>
                            </div>
                        </li>
                    
                </ul>

                

                

                </p>

            
        </div>
    </div>

    










<div class="footer" id="footer">
  <a href="#header" class="back-to-top" onClick="CT(this, 'Footer', 'GoingUp');">^ Going up? ^</a>
    <div class="container">
        <p><a href="http://hackaday.com/about/">About Us</a> <a href="mailto:projects-contact@hackaday.com">Contact Us</a> <a href="/project/37">Give Feedback</a>&copy; 2015 Hackaday <a href="/tos">Terms of Use</a> <a href="/privacy-policy">Privacy Policy</a></p>
        <a href="/" class="had-skull"  onClick="CT(this, 'Footer', 'Home' ); return false;">Hackaday.io</a>
    </div>
</div>

<script>

    var csrftoken = 'dDFhIsUT-qcl8sFVyoXEpJctLbwF0byS94pY';

</script>

    <script type="text/javascript">

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47229708-1', 'auto');

    var dimensionValue = 'nonregistered';
    ga('set', 'dimension1', dimensionValue);
    ga('require', 'displayfeatures');

    ga('send', 'pageview');

    </script>

<img src="//analytics.supplyframe.com/trackingservlet/impression?action=pageImpression&amp;zone=HIO_logs&amp;extra=logged%3Dfalse%7ChaveAccountCookie%3D0%7C&amp;ab=undefined" class="sf-impression" />

    
    
    <script src="//cdn.hackaday.io/build/h%2FydgsYIeDTf7pqgYQEKK8Ngblw0IkZCDqfJ9S2tk7zsBoxIHt5iOd49Qp%2BF4vdxEuRj%2BGpGDLbX4aGOQGmbjaOxUZvklg4ReFk68R95OQshFrGKebvogKGQOiB5Hi1xym9KC54c9Ps0WpzuNydLk4B%2FbKi91KhV40Uxhl38XXb1IVAxAI8iW%2BoQUPCFkHVWZxD0B%2BMZ%2BuEXJTlWuBmopNMxTHRK5yleITPZODT6evbVRQc6AXs9w2Pfk7FS2nKy-0.48.6.js"></script>

</body>
</html>