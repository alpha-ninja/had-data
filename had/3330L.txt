<!doctype html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if IE 9]>    <html class="no-js ie9" lang="en"> <![endif]-->
<!--[if gt IE 9]><!--> <html class="no-js" lang="en" ng-app="buildlogApp"> <!--<![endif]-->
<head>
    
    <title>Project logs &bull; uBBB 32u4 &bull; Hackaday.io</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" href="//cdn.hackaday.io/css/style.css?version=0.48.6" />
    <script type="text/javascript" src="//use.typekit.net/ymb0lgk.js"></script>
    <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
</head>
<body class="logs">

    <!--
############################################################################################
############################################################################################
############################################################################################
#####################Kt;tL#######################################Kti,E######################
#######################;   .###################################G    E#######################
#######################K    f##################################    ;########################
########################Wj   E###############################K:  .W#########################
##########################.  :E##############################:  .L##########################
#########################D    f##############################.   .##########################
########################,     ;##############################     :E#######K################
################f######K      ,##############################      ,######Lt################
################  W###W       i##############################       t####j t################
################:  E#L.        f###########################L.        f#Ki .E################
################j  ;E.          j##########################.         .G;  i#################
#################L               i#######################K                ##################
#################W                E#####################K;               ;##################
###################:               .###################D               :f###################
#####################DLfGD           G####WEEEEKW####W           ;GffGK#####################
##########################i         iD##Kfi    :jKW##D          iE##########################
###########################W      ,G##f            jE#E;       j############################
############################L     D##D              ,##K       W############################
#############################D:  G#W                  K#E,   G##############################
###############################;i#L                    j## ,E###############################
###############################KK#.                     ##iE################################
#################################j                      ;K##################################
################################W                        ,##################################
################################E                         ##################################
###############################Ki                         D#################################
###############################E.                         L#################################
###############################f    iD##W;       D###D    :#################################
###############################i   i######K     K#####K;   #################################
###############################;  .E#######     #######D   #################################
###############################;  L########     ########   #################################
###############################i  G#######K     K#######   #################################
###############################j  L#####E,       fE#####   #################################
###############################D  .E##j            .t##E  ;#################################
###############################E:  ;##.              #Wt  j#################################
################################G   ;t      tWi      t    E#################################
#############################KL##           K#K;          #K:K##############################
#############################i ##:          ###t         j#f ;K#############################
############################:  G#K          #E#L        L##    D############################
###########################D   ;W#:         #;#L        W#K    .############################
#####################KKEKK      :##L        ; ..      :D##.      fKEEK######################
###################t.            ;##G:               ,##E,             tD###################
##################G               E##E               i##;               :###################
#################D                W##W    iL    E.    ###D                ##################
################W,               G###W    tG    K.    ####:               K#################
################;  LW;         ,E#####:  ;W#    #G   f#####;         ;KG  :K################
################  D###E       ;########WW####WW####WW#######W       :####: j################
################ ,#####:      ;##############################       G####E i################
################K#######.     ;##############################      L######WG################
########################f     i##############################     j#########################
#########################W   .D##############################.   i##########################
#########################E   G###############################D   ,##########################
########################G:   #################################j   G#########################
#######################f    K##################################j    W#######################
#####################Kt :iE#####################################KL:  K######################
############################################################################################
############################################################################################
############################################################################################
-->

<div class="header" id="header">
    <div class="container">
        <h1 class="logo">
            <a href="/" title="Hackaday.io Home" class="home" onclick="CT(this, 'Menu', 'Home'); return false;"></a>
            <a href="/" title="Hackaday.io Home" class="brand" onclick="CT(this, 'Menu', 'Home'); return false;">Hack a Day</a>
        </h1>

        <a href="javascript:void(0);" class="responsive-menu">Menu</a>

        <ul class="nav" role="navigation">
            <li><a href="/projects" class="">Projects</a></li>
            <li><a href="/lists" class="">Lists</a></li>
            <li><a href="/stack" class="">Stack</a></li>
            <li class="dropdown more-nav j-more-open">
                <a href="javascript:void(0)" class="dropdown-link icon-dropdown">More</a>
                <ul role="menu" class="dropdown-menu more-menu" id="j-more">
                    <li><a href="http://hackaday.com/blog/" target="_blank">Blog</a></li>
                    <li><a href="/events">Events</a></li>
                    <li><a href="/hackerspaces">Hackerspaces</a></li>
                    <li><a href="/hackers">Profiles</a></li>
                    <li><a href="/contests">Contests</a></li>
                    <li><a href="/prize" target="_blank">The Hackaday Prize</a></li>
                    <li><a href="/submissions/prize2015/list">2015 Prize Entries</a></li>
                </ul>
            </li>
            <li class="menu-last-child">
                <div class="search-holder show">
                    <form id="search-form" action="/search" onsubmit="return submitSearch();" method="GET">
                        <input type="text" placeholder="Search" name="term" class="input-search j-add-search" id="j-add-search" value="" autocomplete="off" pattern=".{3,}" required title="3 characters minimum" />
                        <input type="submit" class="search-button" />
                    </form>
                </div>
            </li>
        </ul>

        

            <ul class="nav pull-right" role="navigation">
                <li><a href="/signup" class="grey-white-button become-member">Sign up</a></li>
                <li><a href="/signin?returnUrl=%2Fproject%2F3330%2Flogs">Sign in</a></li>
            </ul>

        
    </div>
</div>

<div id="topMessage" class="alert"><span class="j-top-content"></span><a href="javascript:void(0);" class="alert-close j-top-message-close">Close</a></div>




    <div class="headline">
        <div class="container">
            <h2><a href="/project/3330-ubbb-32u4">uBBB 32u4</a></h2>
            <p class="description-title"> Project logs</p>
            <p class="description-summary">A dev board for the ATMega32u4</p>
            <div class="description-metainfo">
                
                    <span>created by <a href="/hacker/4501-the-big-one" title="Visit Profile">The Big One</a><span>&bull;</span>
                
                9 months ago<span>&bull;</span><a href="/project/3330#discussion-list" title="See Comments">16 Comments</a></span>
            </div>
        </div>
    </div>

    <div class="container post-content">
        <div class="section-buildsort">
            <span class="pull-left">
                <a href="/project/3330-ubbb-32u4">&#171; Back to project details</a>
            </span>
            <span class="sort-holder pull-right">
                <label for="sort-by">Sort by:</label>
                <select class="sort" id="sort-by">
                    <option value="/project/3330/logs/sort/newest">Newest</option>
                    <option value="/project/3330/logs/sort/oldest" selected="selected">Oldest</option>
                </select>
            </span>
        </div>
        <div class="section section-buildlogs last">
            

                <ul class="buillogs-list">
                    
                        <li>
                            <h2><a href="/project/3330/log/11389-ordered-pcbs">Ordered PCBs</a></h2>
                            <small class="authorship">9 months ago  &bull;
                                <a class="gray-link" href="/project/3330/log/11389#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-11389"><p>We just ordered the PCBs today.  Included on the same board are a number of other breakouts.  See the <a href="http://dirtypcbs.com/view.php?share=3102&amp;accesskey=7c187041eb2ae872bd383059b963b26a" target="_blank">DirtyPCB Store link</a> for ordering info and breakout details.</p><p>The dirty rendering of the board is below:</p><p><img src="https://cdn.hackaday.io/images/6710981417123668817.png"></p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/3330/log/12657-bugs-in-rev-10">Bugs in Rev 1.0</a></h2>
                            <small class="authorship">7 months ago  &bull;
                                <a class="gray-link" href="/project/3330/log/12657#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-12657"><p>We have still not received our boards yet, but someone else has ordered their own copy, and has reported that there are some bugs in the rev 1.0 version.  The most glaring issue is the lack of GND flood fill on the back of the board (the zone is there, but had been reset at some point before ordering).  This means that we will have to dead-bug 6 wires between vias on the back to get things working properly.  Boo!</p><p>A rev 1.1 board is well underway with the following changes (see git for details):</p><ol><li>Actually fill the GND plane this time (gah!)</li><li>Use a crystal + caps instead of a resonator.  While I believe that we have selected a resonator that will work with USB, apparently crystals make for more stable USB communications.</li><li>Add more decoupling caps (we now have one 0.1uF for each VCC / AVCC pin, with a 1uF on UVCC).</li><li>Fixed the LED footprint to use some dirt-cheap RGB LEDs from eBay rather than the more expensive Cree LED (same footprint, but different pinout).  See <a href="http://www.ebay.ca/itm/330833693803?ssPageName=STRK">http://www.ebay.ca/itm/330833693803?ssPageName=STRK</a>:MEWNX:IT&amp;_trksid=p3984.m1439.l2649 for the LEDs which we are now using.</li></ol><div>I'm not going to order this new board until I get my original PCB order (hopefully this week), and have verified that everything else is working as it is supposed to.</div><p>Cheers</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/3330/log/12676-boards-arrived">Boards Arrived</a></h2>
                            <small class="authorship">7 months ago  &bull;
                                <a class="gray-link" href="/project/3330/log/12676#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-12676"><p>The Rev 1.0 boards arrived today.  There are a couple of other bugs which I can now see, which I have resolved in the Rev 1.1 model:</p><ol><li>Solder mask covering the rear of the ISP headers</li><li>Enlarged the mounting holes a bit (two-fold purpose: to let them accept a \#4 screw, and to get rid of the scraggly edge that was left behind when the fab house didn't cut quite as deep into the edge as I had thought they would)</li></ol><p>I am still planning on soldering up one of the AVR boards (with appropriate jumpers to fix the broken ground plane), but I need to wait for some more components to come before I can do that (specifically, a high accuracy SMD resonator and some 1k resistors)</p><p>The LED breakout board is working well, at least once I put a small jumper between VCC LED pad and VCC pin (lesson learned: do not modify a board after it has been added to a panelized project, since you can no longer run DRC against it).  You can see the jumper right beside the red light in the picture below.</p><img src="https://cdn.hackaday.io/images/9773461420598789696.JPG"><p>(Showing three of the lights on.  Sorry for the horrible quality iPhone picture!)</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/3330/log/12755-first-ubbb-32u4-is-alive">First UBBB 32u4 is Alive</a></h2>
                            <small class="authorship">7 months ago  &bull;
                                <a class="gray-link" href="/project/3330/log/12755#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-12755"><p>Yesterday my 16MHz resonator finally arrived, so last night I soldered up the first UBBB 32u4 board.  The SMD stuff was easy enough (took about 30 minutes).  Trying to fix that stupid ground plane bug was much harder (took over an hour) - I ended up using a very thin wire from a through hole resistor that would fit inside the vias.  I would then tin the lead, push onto the via (from the back of the board), and let the wire get soldered in the middle.  I would then bend the wire over to the next closest GND via, and repeat.  There are at a minimum 5 vias that must be done like this (diagram viewed from the front, with required GND vias circled in blue):<br></p><p><img src="https://cdn.hackaday.io/images/9809821420820319615.png"></p><p>After getting everything soldered up and verified with my multimeter, I plugged it into the computer... and nothing.  AVR Dude was showing invalid device signatures:</p><pre>avrdude: initialization failed, rc=-1 
avrdude: AVR device initialized and ready to accept instructions
avrdude: Device signature = 0x000000 (retrying)
avrdude: Device signature = 0x000000 (retrying)
avrdude: Device signature = 0x000000
avrdude: Yikes! Invalid device signature.
avrdude: Expected signature for ATmega32U4 is 1E 95 87
</pre><p>By this time it was after midnight, so I went to bed.</p><p>The next morning I woke up early and checked continuity on everything again; this time checking from the actual chip to the destination (in my case, the ISP headers).  Sure enough, the SCLK pin on the ISP was not touching the pad properly.  I added a bit more solder onto that pad, and I got 'make readfuse' to work!</p><p>I ran into another problem when trying to write the fuses, but it turns out that the u4 chips come with the fuses locked, and you need to do a full chip erase (-e flag) before writing fuses. See <a href="http://electronics.stackexchange.com/questions/37476/failing-to-write-atmega16u4-fuses-with-avrdude" target="_blank">this post</a> which got me pointed in the right direction here.<span></span><br></p><p>I then uploaded my blinkylights program, and sure enough, the blue light (B4) started flashing at 0.5Hz as specified.  The chip looks to be working!</p><p>Next I downloaded LUFA, <a href="https://raw.githubusercontent.com/thebiguno/microcontroller-projects/development/samples/avr/atmega32u4/bootloader_ubbb32u4/README.txt" target="_blank">modified the DFU bootloader to use the lights on this board</a>, and <a href="https://raw.githubusercontent.com/thebiguno/microcontroller-projects/development/samples/avr/atmega32u4/bootloader_ubbb32u4/program.sh" target="_blank">flashed the custom DFU bootloader</a>.</p><p>Finally, I uploaded the blinkylights program again, but this time using dfu-programmer. Sure enough, it still works.</p><p>For those who have ordered their own PCBs for this board, you can download the sample program + custom bootloader <a href="https://github.com/thebiguno/microcontroller-projects/tree/development/samples/avr/atmega32u4" target="_blank">from GitHub</a>.</p><p>Pictures of the front (reasonably pretty, with the exception of the slightly tilted LED and some flux) and back (hideously ugly hack) are below:</p><p><img src="https://cdn.hackaday.io/images/2113491420832124108.JPG"></p><p><img src="https://cdn.hackaday.io/images/6114331420832136608.JPG"></p><p>At this time I am going to declare the UBBB 32u4 a success.  Yes, there are some bugs on the rev 1.0 board, but they are well underway to being fixed in rev 1.1, and even with the bugs, you can still work around them and have a working 32u4 dev board.  (And from now on, I am going to be even more OCD when checking the final panelized boards in KiCad... if anyone knows of a way that you can panelize a board in KiCad and still use DRC and such to verify the boards (even though there may be multiple boards with the same net names), please let me know.</p><p>Cheers</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/3330/log/14731-revision-11">Revision 1.1</a></h2>
                            <small class="authorship">6 months ago  &bull;
                                <a class="gray-link" href="/project/3330/log/14731#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-14731"><p>We have pretty much finalized the changes to Rev 1.1.  In addition to the gerber bugs mentioned in previous logs, we have made the following changes:</p><ul><li>Enlarged text for easier readability</li><li>Improved the mounting holes</li><li>Added an optional TVS diode on the I2C lines (I have managed to kill the I2C lines on AVRs in the past, and I suspect ESD damage... apparently these lines are more susceptible to ESD than other pins)</li><li>Minor routing improvements</li></ul><p>The updated board can be seen below:</p><p><img src="https://cdn.hackaday.io/images/4404801425509580324.png"></p><p>I am planning on batching this on my next PCB order (which will likely be for my <a href="http://hackaday.io/project/4154-bench-power-supply">power supply</a> boards)</p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/3330/log/16516-rev-11-ordered">Rev 1.1 Ordered</a></h2>
                            <small class="authorship">4 months ago  &bull;
                                <a class="gray-link" href="/project/3330/log/16516#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-16516"><p>I panelized UBBB32u4 Rev 1.1 on my bench power supply PCB order last week.  I hope for them to arrive early in May.</p><p>The UBBB (plus power supply) boards can be ordered from <a href="http://dirtypcbs.com/status.php?order=2004726&amp;accesskey=a5e234b1a4e5559f00aec808c6620801" target="_blank">Dirty PCBs</a>.</p><p>The board image is below:</p><p><img src="http://dirtypcbs.com/order_images/a5e234b1a4e5559f00aec808c6620801-6038_top.png"></p></div>
                            </div>
                        </li>
                    
                        <li>
                            <h2><a href="/project/3330/log/18499-rev-11-soldered-and-working">Rev 1.1 Soldered and Working!</a></h2>
                            <small class="authorship">3 months ago  &bull;
                                <a class="gray-link" href="/project/3330/log/18499#discussion-list">
                                    0 comments
                                </a>
                                </small>
                            <div style="position:relative">
                                <div id="post-body-18499"><p>The Rev 1.1 boards arrived a few weeks ago, but I have been too busy with other projects to update this log.  Well, here we are now.</p><p>The new boards are pretty much perfect: the only error remaining is that the crystal's silkscreen is rotated 90 degrees from what it should be (you can see this in the image; the crystal is positioned with the long side vertical, whereas on the silk screen the long side is horizontal).</p><p>At this point I can solder one of these guys up in just about 30 minutes... not bad at all for a toothpick + heat gun job.  :-)</p><p>The soldered board is shown below.  Enjoy!</p><p><img src="https://cdn.hackaday.io/images/4951161432667876865.JPG"></p></div>
                            </div>
                        </li>
                    
                </ul>

                

                

                </p>

            
        </div>
    </div>

    










<div class="footer" id="footer">
  <a href="#header" class="back-to-top" onClick="CT(this, 'Footer', 'GoingUp');">^ Going up? ^</a>
    <div class="container">
        <p><a href="http://hackaday.com/about/">About Us</a> <a href="mailto:projects-contact@hackaday.com">Contact Us</a> <a href="/project/37">Give Feedback</a>&copy; 2015 Hackaday <a href="/tos">Terms of Use</a> <a href="/privacy-policy">Privacy Policy</a></p>
        <a href="/" class="had-skull"  onClick="CT(this, 'Footer', 'Home' ); return false;">Hackaday.io</a>
    </div>
</div>

<script>

    var csrftoken = 'dm2WVkL8-6AFNVOaKwOZRwwpAff6CjTWRtl0';

</script>

    <script type="text/javascript">

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-47229708-1', 'auto');

    var dimensionValue = 'nonregistered';
    ga('set', 'dimension1', dimensionValue);
    ga('require', 'displayfeatures');

    ga('send', 'pageview');

    </script>

<img src="//analytics.supplyframe.com/trackingservlet/impression?action=pageImpression&amp;zone=HIO_logs&amp;extra=logged%3Dfalse%7ChaveAccountCookie%3D0%7C&amp;ab=undefined" class="sf-impression" />

    
    
    <script src="//cdn.hackaday.io/build/h%2FydgsYIeDTf7pqgYQEKK8Ngblw0IkZCDqfJ9S2tk7zsBoxIHt5iOd49Qp%2BF4vdxEuRj%2BGpGDLbX4aGOQGmbjaOxUZvklg4ReFk68R95OQshFrGKebvogKGQOiB5Hi1xym9KC54c9Ps0WpzuNydLk4B%2FbKi91KhV40Uxhl38XXb1IVAxAI8iW%2BoQUPCFkHVWZxD0B%2BMZ%2BuEXJTlWuBmopNMxTHRK5yleITPZODT6evbVRQc6AXs9w2Pfk7FS2nKy-0.48.6.js"></script>

</body>
</html>